[
  {
    "objectID": "labs/lab-02.html#lab-schedule",
    "href": "labs/lab-02.html#lab-schedule",
    "title": "MAR 536: Lab 2",
    "section": "Lab schedule",
    "text": "Lab schedule\n1/18: Introduction to R and R Studio, working with data\n1/25: Intro to Visualization\n2/01: Probability, linear modeling\n2/08: Data wrangling, model summaries\n2/15: Iteration\n2/22: Creating functions, debugging\n3/01: Simulation, Resampling\n3/15: Flex: more modeling (brms, glmmTMB)\n3/29: Spatial data or tidymodeling\nAcknowledgements: Mine Çetinkaya-Rundel, Amanda Hart"
  },
  {
    "objectID": "labs/lab-02.html#today",
    "href": "labs/lab-02.html#today",
    "title": "MAR 536: Lab 2",
    "section": "Today",
    "text": "Today\nDatasets\n\nhills (Review from last week)\nlake Laengelmavesi dataset\ngapminder\nloans\npalmer penguins\n\nTopics\n\nReview, more data structures\nPlotting in R"
  },
  {
    "objectID": "labs/lab-02.html#review-data-types",
    "href": "labs/lab-02.html#review-data-types",
    "title": "MAR 536: Lab 2",
    "section": "Review, data types",
    "text": "Review, data types\n\nhills$climb ##print a vector\n [1]  650 2500  900  800 3070 2866 7500  800  800  650 2100 2000 2200  500 1500\n[16] 3000 2200  350 1000  600  300 1500 2200  900  600 2000  800  950 1750  500\n[31] 4400  600 5200  850 5000\nselect(hills, climb)\n                 climb\nGreenmantle        650\nCarnethy          2500\nCraig Dunain       900\nBen Rha            800\nBen Lomond        3070\nGoatfell          2866\nBens of Jura      7500\nCairnpapple        800\nScolty             800\nTraprain           650\nLairig Ghru       2100\nDollar            2000\nLomonds           2200\nCairn Table        500\nEildon Two        1500\nCairngorm         3000\nSeven Hills       2200\nKnock Hill         350\nBlack Hill        1000\nCreag Beag         600\nKildcon Hill       300\nMeall Ant-Suidhe  1500\nHalf Ben Nevis    2200\nCow Hill           900\nN Berwick Law      600\nCreag Dubh        2000\nBurnswark          800\nLargo Law          950\nCriffel           1750\nAcmony             500\nBen Nevis         4400\nKnockfarrel        600\nTwo Breweries     5200\nCockleroi          850\nMoffat Chase      5000"
  },
  {
    "objectID": "labs/lab-02.html#review-data-exploration",
    "href": "labs/lab-02.html#review-data-exploration",
    "title": "MAR 536: Lab 2",
    "section": "Review, data exploration",
    "text": "Review, data exploration\n\n# Short data summaries\nmean(hills$time)\n[1] 57.87571\n# Look at format\ntail(hills) # last 6 rows\n              dist climb    time\nAcmony         5.0   500  20.950\nBen Nevis     10.0  4400  85.583\nKnockfarrel    6.0   600  32.383\nTwo Breweries 18.0  5200 170.250\nCockleroi      4.5   850  28.100\nMoffat Chase  20.0  5000 159.833\n# General summary good for a quick look at large data sets\nsummary(hills)\n      dist            climb           time       \n Min.   : 2.000   Min.   : 300   Min.   : 15.95  \n 1st Qu.: 4.500   1st Qu.: 725   1st Qu.: 28.00  \n Median : 6.000   Median :1000   Median : 39.75  \n Mean   : 7.529   Mean   :1815   Mean   : 57.88  \n 3rd Qu.: 8.000   3rd Qu.:2200   3rd Qu.: 68.62  \n Max.   :28.000   Max.   :7500   Max.   :204.62"
  },
  {
    "objectID": "labs/lab-02.html#missing-values-na.",
    "href": "labs/lab-02.html#missing-values-na.",
    "title": "MAR 536: Lab 2",
    "section": "Missing values (NA).",
    "text": "Missing values (NA).\n\nweights <- c(25,34,75,NA,21,32,NA)\n\nMany functions do not handle missing values by default.\n\nmean(weights)\n[1] NA\nmean(weights,na.rm=TRUE)\n[1] 37.4\n\nOmit missing values.\n\nna.omit(weights)\n[1] 25 34 75 21 32\nattr(,\"na.action\")\n[1] 4 7\nattr(,\"class\")\n[1] \"omit\"\ndrop_na(penguins)\n# A tibble: 333 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           36.7          19.3               193        3450\n 5 Adelie  Torgersen           39.3          20.6               190        3650\n 6 Adelie  Torgersen           38.9          17.8               181        3625\n 7 Adelie  Torgersen           39.2          19.6               195        4675\n 8 Adelie  Torgersen           41.1          17.6               182        3200\n 9 Adelie  Torgersen           38.6          21.2               191        3800\n10 Adelie  Torgersen           34.6          21.1               198        4400\n# … with 323 more rows, and 2 more variables: sex <fct>, year <int>\n\ndrop_na() removes rows with any missing values. This is not (often) what we want to do. The naniar package contains functions for treatment of missing values."
  },
  {
    "objectID": "labs/lab-02.html#categorical-variables",
    "href": "labs/lab-02.html#categorical-variables",
    "title": "MAR 536: Lab 2",
    "section": "Categorical variables",
    "text": "Categorical variables\nFactors are vectors with discrete values assigned to each element.\nCan specify a categorical variable as a factor using factor().\n\n substrate <- c(\"cobble\",\"mud\",\"sand\")\n is.factor(substrate)\n[1] FALSE\n substrate.fac <- factor(substrate)\n substrate.fac\n[1] cobble mud    sand  \nLevels: cobble mud sand\n is.factor(substrate.fac)\n[1] TRUE"
  },
  {
    "objectID": "labs/lab-02.html#numbers-to-factors",
    "href": "labs/lab-02.html#numbers-to-factors",
    "title": "MAR 536: Lab 2",
    "section": "Numbers to factors",
    "text": "Numbers to factors\nCategorical variables are often coded numerically.\n\n substrate <- c(1,1,2,2,3,2,1,3)\n substrate.fac <- factor(substrate,\n                  labels=c(\"cobble\",\"mud\",\"sand\"))\n substrate.fac\n[1] cobble cobble mud    mud    sand   mud    cobble sand  \nLevels: cobble mud sand\n\nTo find the levels of a factor:\n\nlevels(substrate.fac)\n[1] \"cobble\" \"mud\"    \"sand\"  \n\ndroplevels(myfactor) will remove unused levels.\nThe forcats package is a great way of dealing with categorical variables. We’ll cover examples of its usage during the course."
  },
  {
    "objectID": "labs/lab-02.html#reading-in-data",
    "href": "labs/lab-02.html#reading-in-data",
    "title": "MAR 536: Lab 2",
    "section": "Reading in data",
    "text": "Reading in data\nSo far we have either typed in data values, or used built-in datasets.\nLots of functions to read data from files, including:\n\nscan()\n\n\nflexible, reads data into a vector.\nvery fast, good for large or messy data.\n\n\nread.table, read.csv\n\n\neasy to use, reads data into a data frame.\n\n\nread_excel, read_csv (in tidyverse)\n\n\nlibrary(readxl) has many functions for reading from MS Excel spreadsheets"
  },
  {
    "objectID": "labs/lab-02.html#using-read_excel",
    "href": "labs/lab-02.html#using-read_excel",
    "title": "MAR 536: Lab 2",
    "section": "Using read_excel()",
    "text": "Using read_excel()\nRead data from Finnish lake Laengelmavesi\nSave Laengelmavesi2.xlsx to your computer.\nEither to your project directory or create a directory called ‘data’.\n\nlibrary(readxl)\nfish_data <- read_excel(\n             path = \"../data/Laengelmavesi2.xlsx\",\n                   sheet = \"data\", na = \"NA\")\n# fish_data <- read_csv(file=\"../data/Laengelmavesi2.csv\",\n#                   header=TRUE,sep=\",\")\n# R will look for the file in the working directory.\n# Provide the directory path to the file if it is elsewhere"
  },
  {
    "objectID": "labs/lab-02.html#lab-exercise-13-laengelmavesi-penguins",
    "href": "labs/lab-02.html#lab-exercise-13-laengelmavesi-penguins",
    "title": "MAR 536: Lab 2",
    "section": "Lab exercise 1/3 (Laengelmavesi + penguins)",
    "text": "Lab exercise 1/3 (Laengelmavesi + penguins)\nRead in the data in the ‘data’ sheet of Laengelmavesi2.xlsx and:\n\nDisplay the number of observations for each species of fish. (hint: the function count() will tell you how many rows)\n\nFind the overall mean lengths, weights, and heights of fish in the data.\n\nFind the range of the lengths of Perch.\n\nCalculate the mean length for each species.\n\nbonus With the Pike data, create a new factor for small and large based on the weights.\n\nUse the ggpairs() function in library(GGally) to create a pairs plot for the palmer penguins data. What are five things you learn about the data and the penguins from this view of the data?"
  },
  {
    "objectID": "labs/lab-02.html#base-graphics-plot",
    "href": "labs/lab-02.html#base-graphics-plot",
    "title": "MAR 536: Lab 2",
    "section": "Base graphics: plot()",
    "text": "Base graphics: plot()\nplot() is the generic function for plotting R objects.\n\nplot() is an overloaded function.\n\nwhat it returns depends on the type of objects that are given to it.\n\nthere are versions of plot that provide useful outputs for many R functions.\n\ne.g. plot.lm() is a version that plots typical diagnostics from a linear model object. (but you still just type plot(myobject))."
  },
  {
    "objectID": "labs/lab-02.html#plots-are-like-onionsthey-have-layers",
    "href": "labs/lab-02.html#plots-are-like-onionsthey-have-layers",
    "title": "MAR 536: Lab 2",
    "section": "Plots are like onions…they have layers",
    "text": "Plots are like onions…they have layers\n\n\nBoth base R and ggplot use a layers approach to plotting.\n\nPlot type\nPoints\nLines\nColors\nLabels\nStyles\netc."
  },
  {
    "objectID": "labs/lab-02.html#ggplot2-in-tidyverse",
    "href": "labs/lab-02.html#ggplot2-in-tidyverse",
    "title": "MAR 536: Lab 2",
    "section": "ggplot2 \\(\\in\\) tidyverse",
    "text": "ggplot2 \\(\\in\\) tidyverse\n\n\n\n\n\n\n\n\n\nggplot2 is tidyverse’s data visualization package\ngg in “ggplot2” stands for Grammar of Graphics\nInspired by the book Grammar of Graphics by Leland Wilkinson"
  },
  {
    "objectID": "labs/lab-02.html#grammar-of-graphics",
    "href": "labs/lab-02.html#grammar-of-graphics",
    "title": "MAR 536: Lab 2",
    "section": "Grammar of Graphics",
    "text": "Grammar of Graphics\nA grammar of graphics is a tool that enables us to concisely describe the components of a graphic"
  },
  {
    "objectID": "labs/lab-02.html#hello-ggplot2",
    "href": "labs/lab-02.html#hello-ggplot2",
    "title": "MAR 536: Lab 2",
    "section": "Hello ggplot2!",
    "text": "Hello ggplot2!\n\nggplot() is the main function in ggplot2\nPlots are constructed in layers\nStructure of the code for plots can be summarized as\n\n\nggplot(data = [dataset],\n       mapping = aes(x = [x-variable], y = [y-variable])) +\n   geom_xxx() +\n   other options\n\n\nThe ggplot2 package comes with the tidyverse\nFor help with ggplot2, see ggplot2.tidyverse.org"
  },
  {
    "objectID": "labs/lab-02.html#palmer-penguins",
    "href": "labs/lab-02.html#palmer-penguins",
    "title": "MAR 536: Lab 2",
    "section": "Palmer Penguins",
    "text": "Palmer Penguins\n\nPlotCode\n\n\n\n\n\n\n\n\n\n\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm, y = bill_length_mm,\n                     colour = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\",\n       subtitle = \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\",\n       x = \"Bill depth (mm)\", y = \"Bill length (mm)\",\n       colour = \"Species\") +\n  scale_color_viridis_d()\n\nBy default R uses variable names as axis labels. Use labs() to add text & captions, etc."
  },
  {
    "objectID": "labs/lab-02.html#ggplot-layers",
    "href": "labs/lab-02.html#ggplot-layers",
    "title": "MAR 536: Lab 2",
    "section": "ggplot layers",
    "text": "ggplot layers\nTo begin\n– All ggplots begin with a call to ggplot()\nData\n– data frame containing variables for plot\nAesthetics\n– specify how data variables relate to graph properties – e.g. what goes on x & y axis, etc. – mapping argument passed to ggplot() via aes()\nGeometry\n– a call to a geometry (geom_) determines plot type – may require additional geometry-specific aesthetics\nOther options\n– summary statistics – adjust overall appearance (color, size, shape…) – add labels, captions, theme, etc. – faceting & coordinate system"
  },
  {
    "objectID": "labs/lab-02.html#axis-limits",
    "href": "labs/lab-02.html#axis-limits",
    "title": "MAR 536: Lab 2",
    "section": "Axis limits",
    "text": "Axis limits\nR chooses x and y limits just larger than the range of the data.\nTo change the default x and y values use xlim and ylim.\n\nggplot(data = fish_data, mapping = aes(x= length, \n                                       y = weight)) + \n  geom_point() +\n  xlim(0, 50) +\n  ylim(0, 800) +\n  labs(title = \"Laengelmavesi fish\",\n         subtitle = \"MAR 536 Biological Statistics II, Lab 2\",\n         x = \"Length (cm)\",\n         y = \"Weight (g)\",\n         caption = \"\\nplot created by \\n@gavin_fay\")"
  },
  {
    "objectID": "labs/lab-02.html#colors",
    "href": "labs/lab-02.html#colors",
    "title": "MAR 536: Lab 2",
    "section": "Colors",
    "text": "Colors\nColors of points, lines, text etc. can all be specified.\nIf you want to map color to a variable then this should be done in the aes().\nColors can be specified as numbers, text string, or hex codes col=1 or col=\"red\"\n\nggplot(data = fish_data, mapping = aes(x= length,\n                                       y = weight)) + \n  geom_point(col = \"blue\") + # Change point color to blue\n  xlim(0, 50) +\n  ylim(0, 800) +\n  labs(title = \"Laengelmavesi fish\",\n         subtitle = \"MAR 536 Biological Statistics II, Lab 2\",\n         x = \"Length (cm)\",\n         y = \"Weight (g)\",\n         caption = \"\\nplot created by \\n@gavin_fay\")"
  },
  {
    "objectID": "labs/lab-02.html#map-color-to-a-variable",
    "href": "labs/lab-02.html#map-color-to-a-variable",
    "title": "MAR 536: Lab 2",
    "section": "Map color to a variable",
    "text": "Map color to a variable\n\nggplot(data = fish_data, \n       mapping = aes(x= length,\n                     y = weight, \n                     col = species)) + # Color by species\n  geom_point() +\n  xlim(0, 50) +\n  ylim(0, 800) +\n  labs(title = \"Laengelmavesi fish\",\n         subtitle = \"MAR 536 Biological Statistics II, Lab 2\",\n         x = \"Length (cm)\",\n         y = \"Weight (g)\",\n         caption = \"\\nplot created by \\n@gavin_fay\")"
  },
  {
    "objectID": "labs/lab-02.html#points",
    "href": "labs/lab-02.html#points",
    "title": "MAR 536: Lab 2",
    "section": "Points",
    "text": "Points\nUse the shape and size aesthetics to adjust point type and size ::: {.cell}\nggplot(data = fish_data, \n       mapping = aes(x= length, \n                     y = weight, \n                     col = species, \n                     size = height)) + # Set point size proportional to body height\n  geom_point(shape = 8) + # Change point type\n  xlim(0, 50) +\n  ylim(0, 800) +\n  labs(title = \"Laengelmavesi fish\",\n         subtitle = \"MAR 536 Biological Statistics II, Lab 2\",\n         x = \"Length (cm)\",\n         y = \"Weight (g)\",\n         caption = \"\\nplot created by \\n@gavin_fay\")\n:::"
  },
  {
    "objectID": "labs/lab-02.html#faceting-small-multiples",
    "href": "labs/lab-02.html#faceting-small-multiples",
    "title": "MAR 536: Lab 2",
    "section": "Faceting (small multiples)",
    "text": "Faceting (small multiples)\n\nSmaller plots that display different subsets of the data\nUseful for exploring conditional relationships and large data\n\nfacet_grid([rows],[cols])\nfacet_wrap(~[var])"
  },
  {
    "objectID": "labs/lab-02.html#lab-exercise-23",
    "href": "labs/lab-02.html#lab-exercise-23",
    "title": "MAR 536: Lab 2",
    "section": "Lab exercise 2/3",
    "text": "Lab exercise 2/3\n\n\nUse the gapminder data to replicate as close as possible this graph. (Try out different ‘themes’ with + theme_XXXX())\n\nbonus plot time series of life expectancy by continent and country. (You can use geom_line() to link points)"
  },
  {
    "objectID": "labs/lab-02.html#data-lending-club",
    "href": "labs/lab-02.html#data-lending-club",
    "title": "MAR 536: Lab 2",
    "section": "Data: Lending Club",
    "text": "Data: Lending Club\n\n\n\nThousands of loans made through the Lending Club, which is a platform that allows individuals to lend to other individuals\nNot all loans are created equal – ease of getting a loan depends on (apparent) ability to pay back the loan\nData includes loans made, these are not loan applications"
  },
  {
    "objectID": "labs/lab-02.html#selected-variables",
    "href": "labs/lab-02.html#selected-variables",
    "title": "MAR 536: Lab 2",
    "section": "Selected variables",
    "text": "Selected variables\n\nloans <- loans_full_schema %>%\n  select(loan_amount, interest_rate, term, grade,\n         state, annual_income, homeownership, debt_to_income)\nglimpse(loans)\n\nRows: 10,000\nColumns: 8\n$ loan_amount    <int> 28000, 5000, 2000, 21600, 23000, 5000, 24000, 20000, 20…\n$ interest_rate  <dbl> 14.07, 12.61, 17.09, 6.72, 14.07, 6.72, 13.59, 11.99, 1…\n$ term           <dbl> 60, 36, 36, 36, 36, 36, 60, 60, 36, 36, 60, 60, 36, 60,…\n$ grade          <ord> C, C, D, A, C, A, C, B, C, A, C, B, C, B, D, D, D, F, E…\n$ state          <fct> NJ, HI, WI, PA, CA, KY, MI, AZ, NV, IL, IL, FL, SC, CO,…\n$ annual_income  <dbl> 90000, 40000, 40000, 30000, 35000, 34000, 35000, 110000…\n$ homeownership  <fct> MORTGAGE, RENT, RENT, RENT, RENT, OWN, MORTGAGE, MORTGA…\n$ debt_to_income <dbl> 18.01, 5.04, 21.15, 10.16, 57.96, 6.46, 23.66, 16.19, 3…"
  },
  {
    "objectID": "labs/lab-02.html#variable-types",
    "href": "labs/lab-02.html#variable-types",
    "title": "MAR 536: Lab 2",
    "section": "Variable types",
    "text": "Variable types\n\n\n\nvariable\ntype\n\n\n\n\nloan_amount\nnumerical, continuous\n\n\ninterest_rate\nnumerical, continuous\n\n\nterm\nnumerical, discrete\n\n\ngrade\ncategorical, ordinal\n\n\nstate\ncategorical, not ordinal\n\n\nannual_income\nnumerical, continuous\n\n\nhomeownership\ncategorical, not ordinal\n\n\ndebt_to_income\nnumerical, continuous"
  },
  {
    "objectID": "labs/lab-02.html#histograms",
    "href": "labs/lab-02.html#histograms",
    "title": "MAR 536: Lab 2",
    "section": "Histograms",
    "text": "Histograms\ngeom_histogram()\n\nggplot(loans, aes(x = loan_amount)) +\n  geom_histogram()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`."
  },
  {
    "objectID": "labs/lab-02.html#histograms-and-binwidth",
    "href": "labs/lab-02.html#histograms-and-binwidth",
    "title": "MAR 536: Lab 2",
    "section": "Histograms and binwidth",
    "text": "Histograms and binwidth\nbinwidth = 2000\n\nggplot(loans, aes(x = loan_amount)) +\n  geom_histogram(binwidth = 2000)"
  },
  {
    "objectID": "labs/lab-02.html#customizing-histograms",
    "href": "labs/lab-02.html#customizing-histograms",
    "title": "MAR 536: Lab 2",
    "section": "Customizing histograms",
    "text": "Customizing histograms\nFill with a categorical variable\n\nPlotCode\n\n\n\n\n\n\n\n\n\n\nggplot(loans, aes(x = loan_amount,\n                  fill = homeownership)) +\n  geom_histogram(binwidth = 5000,\n                 alpha = 0.5) +\n  labs(\n    x = \"Loan amount ($)\",\n    y = \"Frequency\",\n    title = \"Amounts of Lending Club loans\"\n  )"
  },
  {
    "objectID": "labs/lab-02.html#box-plots",
    "href": "labs/lab-02.html#box-plots",
    "title": "MAR 536: Lab 2",
    "section": "Box plots",
    "text": "Box plots\nUse geom_boxplot().\n\nggplot(loans, aes(x = interest_rate)) +\n  geom_boxplot()"
  },
  {
    "objectID": "labs/lab-02.html#adding-a-categorical-variable",
    "href": "labs/lab-02.html#adding-a-categorical-variable",
    "title": "MAR 536: Lab 2",
    "section": "Adding a categorical variable",
    "text": "Adding a categorical variable\n\nPlotCode\n\n\n\n\n\n\n\n\n\n\nggplot(loans, aes(x = interest_rate,\n                  y = grade)) +\n  geom_boxplot() +\n  labs(\n    x = \"Interest rate (%)\",\n    y = \"Grade\",\n    title = \"Interest rates of Lending Club loans\",\n    subtitle = \"by grade of loan\"\n  )"
  },
  {
    "objectID": "labs/lab-02.html#bar-plot",
    "href": "labs/lab-02.html#bar-plot",
    "title": "MAR 536: Lab 2",
    "section": "Bar plot",
    "text": "Bar plot\n\n# Read data from csv file using tidyverse\nfish <- read_csv(file=\"../data/Laengelmavesi.csv\")\n\n\nggplot(fish, aes(x = fct_reorder(species,weight), \n                 y = weight)) +\n  geom_col(fill=\"steelblue\") +\n  labs(x = \"species\")\n\nThe call to fct_reorder() will reorder the species according to a different vector, here the weight."
  },
  {
    "objectID": "labs/lab-02.html#segmented-bar-plot",
    "href": "labs/lab-02.html#segmented-bar-plot",
    "title": "MAR 536: Lab 2",
    "section": "Segmented bar plot",
    "text": "Segmented bar plot\n\nggplot(loans, aes(x = homeownership,\n                  fill = grade)) + \n  geom_bar()"
  },
  {
    "objectID": "labs/lab-02.html#segmented-bar-plot-1",
    "href": "labs/lab-02.html#segmented-bar-plot-1",
    "title": "MAR 536: Lab 2",
    "section": "Segmented bar plot",
    "text": "Segmented bar plot\n\nggplot(loans, aes(x = homeownership, fill = grade)) +\n  geom_bar(position = \"fill\")"
  },
  {
    "objectID": "labs/lab-02.html#customizing-bar-plots",
    "href": "labs/lab-02.html#customizing-bar-plots",
    "title": "MAR 536: Lab 2",
    "section": "Customizing bar plots",
    "text": "Customizing bar plots"
  },
  {
    "objectID": "labs/lab-02.html#lab-exercise-33-laengelmavesi-revisited",
    "href": "labs/lab-02.html#lab-exercise-33-laengelmavesi-revisited",
    "title": "MAR 536: Lab 2",
    "section": "Lab exercise 3/3 (Laengelmavesi revisited)",
    "text": "Lab exercise 3/3 (Laengelmavesi revisited)\nUse the data in Laengelmavesi2.xlsx to create the following graphs. Make sure to add axis labels and plot titles.\n\nCreate boxplots and histograms of the length distributions for each species.\n\nPlot all the weights vs the lengths. Include enough information that the data for each species can be identified.\n\nPlot the mean weight of each species as a function of the mean length, with the species names and mean heights also indicated on the plot.\n\nCreate one plot of the heights as a function of the lengths. Add a line separating fish with height greater than 20cm.\n\nbonus Add to your plot from step (2) the mean weight and length for each species.\n\n\n\n\ngavinfay.github.io/mar536-biolstats2-s23"
  },
  {
    "objectID": "labs/lab-01.html#lab-schedule",
    "href": "labs/lab-01.html#lab-schedule",
    "title": "Biological Stats 2: Lab 1",
    "section": "Lab schedule",
    "text": "Lab schedule\n1/18: Introduction to R and R Studio, working with data\n1/25: Intro to Visualization\n2/01: Probability, linear modeling\n2/08: Data wrangling, model summaries\n2/15: Iteration\n2/22: Creating functions, debugging\n3/01: Simulation, Resampling\n3/15: Flex: more modeling (brms, glmmTMB)\n3/29: Spatial data or tidymodeling"
  },
  {
    "objectID": "labs/lab-01.html#format-for-lab-component",
    "href": "labs/lab-01.html#format-for-lab-component",
    "title": "Biological Stats 2: Lab 1",
    "section": "Format for lab component",
    "text": "Format for lab component\n\nDescription/overview of concepts by instructor\nLive coding. Interactive, follow along yourselves\nLab exercises to practice material\nAssignment each week is to finish the exercises\nExtra credit: #TidyTuesday\nCommunity support\n“Try stuff and see what happens”"
  },
  {
    "objectID": "labs/lab-01.html#why-r",
    "href": "labs/lab-01.html#why-r",
    "title": "Biological Stats 2: Lab 1",
    "section": "Why R?",
    "text": "Why R?\nReproducible\n- command line interface encourages organization\n- scripts allow others (and you!) to reproduce analyses from end-to-end\n- integration of analysis with document creation\nExtensible\n- new methods delivered as developed\n- continual expansion through new packages\nOpen-source\n- all code can be examined by the user\nFree\n- available to large set of users (and therefore developers)\nR is not the only solution out there.\nThe real goal is not to teach R, but concepts that all programming depends on."
  },
  {
    "objectID": "labs/lab-01.html#recommended-reading",
    "href": "labs/lab-01.html#recommended-reading",
    "title": "Biological Stats 2: Lab 1",
    "section": "Recommended reading",
    "text": "Recommended reading\nR for Data Science, 2017 (Wickham and Grolemund)\nhttps://r4ds.had.co.nz/"
  },
  {
    "objectID": "labs/lab-01.html#recommended-reading-1",
    "href": "labs/lab-01.html#recommended-reading-1",
    "title": "Biological Stats 2: Lab 1",
    "section": "Recommended reading",
    "text": "Recommended reading\nAn introduction to R (Venables et al.)\n– http://cran.r-project.org/doc/manuals/R-intro.pdf\nR reference card 2.0 (Baggott)\n– http://cran.r-project.org/doc/contrib/Baggott-refcard-v2.pdf\n– Extremely useful handout: put on wall in view of your desk\nCheatsheets\n- https://posit.co/resources/cheatsheets/\nThere are many (many) R books out there. Good for reference. e.g.\n- The R Book, 2007 (Crawley)\n- Modern Applied Statistics with S, 20002 (Venables and Ripley)\n- Introductory Statistics with R, 2002 (Dalgaard)"
  },
  {
    "objectID": "labs/lab-01.html#reproducibility-checklist",
    "href": "labs/lab-01.html#reproducibility-checklist",
    "title": "Biological Stats 2: Lab 1",
    "section": "Reproducibility checklist",
    "text": "Reproducibility checklist\nWhat does it mean for a data analysis to be “reproducible”?\n\nNear-term goals:\n\nAre the tables and figures reproducible from the code and data?\nDoes the code actually do what you think it does?\nIn addition to what was done, is it clear why it was done?\n\nLong-term goals:\n\nCan the code be used for other data?\nCan you extend the code to do other things?"
  },
  {
    "objectID": "labs/lab-01.html#toolkit-for-reproducibility",
    "href": "labs/lab-01.html#toolkit-for-reproducibility",
    "title": "Biological Stats 2: Lab 1",
    "section": "Toolkit for reproducibility",
    "text": "Toolkit for reproducibility\n\nScriptability \\(\\rightarrow\\) R\nLiterate programming (code, narrative, output in one place) \\(\\rightarrow\\) R Markdown\nVersion control \\(\\rightarrow\\) Git / GitHub"
  },
  {
    "objectID": "labs/lab-01.html#r-and-rstudio",
    "href": "labs/lab-01.html#r-and-rstudio",
    "title": "Biological Stats 2: Lab 1",
    "section": "R and RStudio",
    "text": "R and RStudio\n\n\n\n\n\n\n\n\nR is an open-source statistical programming language\nR is also an environment for statistical computing and graphics\nIt’s easily extensible with packages\n\n\n\n\n\n\n\n\nRStudio is a convenient interface for R called an IDE (integrated development environment), e.g. “I write R code in the RStudio IDE”\nRStudio is not a requirement for programming with R, but it’s very commonly used by R programmers and data scientists"
  },
  {
    "objectID": "labs/lab-01.html#using-r-today-rstudio-cloud",
    "href": "labs/lab-01.html#using-r-today-rstudio-cloud",
    "title": "Biological Stats 2: Lab 1",
    "section": "Using R today: RStudio Cloud",
    "text": "Using R today: RStudio Cloud\nAn alternative:\n\nweb browser interface https://posit.cloud/content/5243518"
  },
  {
    "objectID": "labs/lab-01.html#r-packages",
    "href": "labs/lab-01.html#r-packages",
    "title": "Biological Stats 2: Lab 1",
    "section": "R packages",
    "text": "R packages\n\nPackages are the fundamental units of reproducible R code. They include reusable R functions, the documentation that describes how to use them, and sample data 1\nAs of September 2020, there are over 16,000 R packages available on CRAN (the Comprehensive R Archive Network)2\nWe’re going to work with a small (but important) subset of these!\n\nWickham and Bryan, R PackagesCRAN contributed packages"
  },
  {
    "objectID": "labs/lab-01.html#tour-r-and-rstudio",
    "href": "labs/lab-01.html#tour-r-and-rstudio",
    "title": "Biological Stats 2: Lab 1",
    "section": "Tour: R and RStudio",
    "text": "Tour: R and RStudio"
  },
  {
    "objectID": "labs/lab-01.html#a-short-list-for-now-of-r-essentials",
    "href": "labs/lab-01.html#a-short-list-for-now-of-r-essentials",
    "title": "Biological Stats 2: Lab 1",
    "section": "A short list (for now) of R essentials",
    "text": "A short list (for now) of R essentials\n\nFunctions are (most often) verbs, followed by what they will be applied to in parentheses:\n\n\ndo_this(to_this)\ndo_that(to_this, to_that, with_those)\n\n\n\nPackages are installed with the install.packages function and loaded with the library function, once per session:\n\n\ninstall.packages(\"package_name\")\nlibrary(package_name)"
  },
  {
    "objectID": "labs/lab-01.html#tidyverse",
    "href": "labs/lab-01.html#tidyverse",
    "title": "Biological Stats 2: Lab 1",
    "section": "tidyverse",
    "text": "tidyverse\n\n\n\n\n\n\n\n\ntidyverse.org\n\nThe tidyverse is an opinionated collection of R packages designed for data science\nAll packages share an underlying philosophy and a common grammar"
  },
  {
    "objectID": "labs/lab-01.html#getting-started",
    "href": "labs/lab-01.html#getting-started",
    "title": "Biological Stats 2: Lab 1",
    "section": "Getting started",
    "text": "Getting started\nEnter instructions at R console command line prompt (>): e.g. type\n\n2 + 2\n\nR acts as a calculator and returns (prints) the result.\n\n2 + 2\n[1] 4"
  },
  {
    "objectID": "labs/lab-01.html#simple-commands",
    "href": "labs/lab-01.html#simple-commands",
    "title": "Biological Stats 2: Lab 1",
    "section": "Simple commands",
    "text": "Simple commands\n\n3^2\n[1] 9\n2*(2+2)\n[1] 8\n2*2+2\n[1] 6\nlog(10)\n[1] 2.302585\nexp(1)\n[1] 2.718282\nx <- 3\n2*x\n[1] 6\n\nThe <- means ‘assign’. i.e. ‘assign a value of 3 to the variable x’. <- is preferable to using ="
  },
  {
    "objectID": "labs/lab-01.html#scripts-and-rstudio",
    "href": "labs/lab-01.html#scripts-and-rstudio",
    "title": "Biological Stats 2: Lab 1",
    "section": "Scripts and RStudio",
    "text": "Scripts and RStudio\n\nTyping commands into the console can get tedious.\nScripts are text files containing lines of code.\nScripts provide a complete record of analyses.\nCode can be run (executed) from these files repeatedly.\nScripts can be created in a text editor and copied into the R console.\n\n\nOr…\n\nRStudio integrates scripts, R console, and output in a user-friendly development environment.\nTo run code in RStudio, select code and type\nCtrl+Enter (Windows)\nCommand+Enter (Mac)\nThe code will run in the R console."
  },
  {
    "objectID": "labs/lab-01.html#rmarkdown",
    "href": "labs/lab-01.html#rmarkdown",
    "title": "Biological Stats 2: Lab 1",
    "section": "rmarkdown",
    "text": "rmarkdown\n\n\nrmarkdown.rstudio.com\n\nrmarkdown and the various packages that support it enable R users to write their code and prose in reproducible computational documents\nWe will generally refer to R Markdown documents (with .Rmd extension), e.g. “Do this in your R Markdown document” and rarely discuss loading the rmarkdown package"
  },
  {
    "objectID": "labs/lab-01.html#r-markdown",
    "href": "labs/lab-01.html#r-markdown",
    "title": "Biological Stats 2: Lab 1",
    "section": "R Markdown",
    "text": "R Markdown\n\nFully reproducible reports – each time you knit the analysis is ran from the beginning\nSimple markdown syntax for text\nCode goes in chunks, defined by three backticks, narrative goes outside of chunks"
  },
  {
    "objectID": "labs/lab-01.html#tour-r-markdown",
    "href": "labs/lab-01.html#tour-r-markdown",
    "title": "Biological Stats 2: Lab 1",
    "section": "Tour: R Markdown",
    "text": "Tour: R Markdown"
  },
  {
    "objectID": "labs/lab-01.html#getting-help-in-r",
    "href": "labs/lab-01.html#getting-help-in-r",
    "title": "Biological Stats 2: Lab 1",
    "section": "Getting Help in R",
    "text": "Getting Help in R\nR is a programming language, there is a learning curve.\nFortunately, there are lots of resources:\n\nDon’t summon a wish-granting computer demon."
  },
  {
    "objectID": "labs/lab-01.html#getting-help-in-r-1",
    "href": "labs/lab-01.html#getting-help-in-r-1",
    "title": "Biological Stats 2: Lab 1",
    "section": "Getting Help in R",
    "text": "Getting Help in R\nR is a programming language, there is a learning curve.\nFortunately, there are lots of resources:\n- help files\n- online search results\n- books\n- colleagues\n- RStudio Community\n\n?(mean)\nhelp(\"mean\")\n\nThe above both get help for the function mean.\nUse help.search(\"function.name\") to search across packages.\nstr(object.name) shows the structure of an object."
  },
  {
    "objectID": "labs/lab-01.html#r-help-files-mean",
    "href": "labs/lab-01.html#r-help-files-mean",
    "title": "Biological Stats 2: Lab 1",
    "section": "R Help files (?mean)",
    "text": "R Help files (?mean)\nCommon format:\n\nDescription (what the function does)\n\nUsage (how to use it)\n\nArguments (what the function needs, options)\n\nValue (what does the function return)\n\nSee Also (related functions)\n\nExamples (sample code showing how the function works)\n\nRead function documentation and explore behavior by running examples!"
  },
  {
    "objectID": "labs/lab-01.html#r-markdown-help",
    "href": "labs/lab-01.html#r-markdown-help",
    "title": "Biological Stats 2: Lab 1",
    "section": "R Markdown help",
    "text": "R Markdown help\n\n\nR Markdown Cheat Sheet\nHelp -> Cheatsheets\n\n\n\n\n\n\n\nMarkdown Quick Reference\nHelp -> Markdown Quick Reference"
  },
  {
    "objectID": "labs/lab-01.html#projects-in-rstudio",
    "href": "labs/lab-01.html#projects-in-rstudio",
    "title": "Biological Stats 2: Lab 1",
    "section": "Projects in RStudio",
    "text": "Projects in RStudio\nGood to keep all the files associated with a particular project organized together – input data, R scripts, analytical results, figures.\nRStudio has built-in support for this via its projects.\nProjects provide an easy organization of your files and analyses.\nR runs from a working directory, the location (folder) on your computer that R will use as a default when looking for data files, producing output, etc.\nProject files (.Rproj)\nWhen you open a project, RStudio sets the working directory to the folder in which the .Rproj file exists.\nUsing projects can be VERY helpful."
  },
  {
    "objectID": "labs/lab-01.html#lab-exercise-14",
    "href": "labs/lab-01.html#lab-exercise-14",
    "title": "Biological Stats 2: Lab 1",
    "section": "Lab exercise 1/4",
    "text": "Lab exercise 1/4\n(Instructions also in lab-exercise-01.pdf)\nStart a new project. (call it biostats2 or something similar)\nOpen a new R markdown file. Save it. (name it lastname_lab1.Rmd or something similar)\nAt the top of the script, add comments with your name and lab 1.\nWork in pairs or individually.\nSubmit your .Rmd file via myCourses before lab next week.\nWrite code that evaluates the following when run. \\[7 + 5(4+3)\\] \\[e^{-5(0.2+0.15)}\\] \\[\\frac{\\sqrt{1+2(3+2)}}{\\ln(3^2+2)}\\]"
  },
  {
    "objectID": "labs/lab-01.html#objects",
    "href": "labs/lab-01.html#objects",
    "title": "Biological Stats 2: Lab 1",
    "section": "Objects",
    "text": "Objects\nCommon types of objects\n- Numbers\n- Characters (i.e. text or strings)\n- Tables\n- Vectors and matrices\n- Plots\n- Statistical output\n- Functions\nObjects in R are global\nViewing objects: In RStudio see top-right Workspace tab\nMore generally:\n\n\n  print(myobject)\n  myobject\n\nls() lists all objects in the workspace.\nUse rm() to remove an object."
  },
  {
    "objectID": "labs/lab-01.html#data-types-modes",
    "href": "labs/lab-01.html#data-types-modes",
    "title": "Biological Stats 2: Lab 1",
    "section": "Data types (modes)",
    "text": "Data types (modes)\nDescribe how objects are stored in computer memory.\nIn R you do not need to specify the data type.\nCommon data types:\n\nNumeric (integer, floating point numbers or doubles)\nLogical (Boolean, true or false)\nCharacters (text or string data)\n\nTypes are not always obvious in R, but can be important to know."
  },
  {
    "objectID": "labs/lab-01.html#data-types-ii",
    "href": "labs/lab-01.html#data-types-ii",
    "title": "Biological Stats 2: Lab 1",
    "section": "Data types II",
    "text": "Data types II\n\nmyobject <- log(10)\nmode(myobject)\n[1] \"numeric\"\nis.numeric(myobject)\n[1] TRUE\ntypeof(myobject)\n[1] \"double\"\nnewobject <- as.integer(myobject)\ntypeof(newobject)\n[1] \"integer\"\nis.character(myobject)\n[1] FALSE\ntypeof(\"hello world\")\n[1] \"character\""
  },
  {
    "objectID": "labs/lab-01.html#vectors",
    "href": "labs/lab-01.html#vectors",
    "title": "Biological Stats 2: Lab 1",
    "section": "Vectors",
    "text": "Vectors\n\nweights <- c(2.3,5.4,7.5,9)\nprint(weights)\n[1] 2.3 5.4 7.5 9.0\nyears <- 2007:2016\nprint(years)\n [1] 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016\nyears <- seq(from=2000,to=2016,by=2)\nprint(years)\n[1] 2000 2002 2004 2006 2008 2010 2012 2014 2016\nx <- rep(3,times=10)\nprint(x)\n [1] 3 3 3 3 3 3 3 3 3 3\nrep(1:3,times=3)\n[1] 1 2 3 1 2 3 1 2 3\nrep(1:3,length=10)\n [1] 1 2 3 1 2 3 1 2 3 1"
  },
  {
    "objectID": "labs/lab-01.html#more-on-vectors",
    "href": "labs/lab-01.html#more-on-vectors",
    "title": "Biological Stats 2: Lab 1",
    "section": "More on Vectors",
    "text": "More on Vectors\nVectors are ordered and can be referred to by element(s) using [ ]\n\n(years <- 2007:2016)\n [1] 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016\nyears[3]\n[1] 2009\nyears[5:6]\n[1] 2011 2012\nwhich(years==2010)\n[1] 4\nyears[-c(2,4)] # A negative index excludes elements\n[1] 2007 2009 2011 2012 2013 2014 2015 2016\n\nVector operations are element-wise\n\n(x <- 1:5)\n[1] 1 2 3 4 5\n2*x\n[1]  2  4  6  8 10"
  },
  {
    "objectID": "labs/lab-01.html#lab-exercise-24",
    "href": "labs/lab-01.html#lab-exercise-24",
    "title": "Biological Stats 2: Lab 1",
    "section": "Lab exercise 2/4",
    "text": "Lab exercise 2/4\n(Instructions also in lab-exercise-01.pdf)\nCreate vectors using seq(), rep(), and mathematical operators. Only use c() when absolutely necessary.\nhint Remember you can get help on a function by typing ?functionname\n\nPositive integers from 1 to 99\n\nOdd integers between 1 and 99\n\nThe numbers 1,1,1, 2,2,2, 3,3,3\n\nThe numbers -5,-4,-3,-5,-4,-3,-5,-4,-3\n\nThe fractions 1, 1/2, 1/3, 1/4, …, 1/10\n\nThe cubes 1, 8, 27, 64, 125, 216"
  },
  {
    "objectID": "labs/lab-01.html#useful-functions",
    "href": "labs/lab-01.html#useful-functions",
    "title": "Biological Stats 2: Lab 1",
    "section": "Useful functions",
    "text": "Useful functions\n\nx <- c(5,3,2,6,3,9,1,18)\nlength(x)  # length of vector x\n[1] 8\nsort(unique(x))  # sorted vector of unique values in x\n[1]  1  2  3  5  6  9 18\nmin(x)     # minimum value in x\n[1] 1\nmax(x)     # maximum value in x\n[1] 18\nmean(x)    # mean of x\n[1] 5.875\nmedian(x)  # median of x\n[1] 4\nsd(x)      # standard deviation of x\n[1] 5.514591\nrange(x)   # range of values in x\n[1]  1 18\nrange(x)[2]  # 2nd element of values returned by range()\n[1] 18\nquantile(x) # optional argument 'probs' can be handy\n   0%   25%   50%   75%  100% \n 1.00  2.75  4.00  6.75 18.00"
  },
  {
    "objectID": "labs/lab-01.html#boolean-logic-operators",
    "href": "labs/lab-01.html#boolean-logic-operators",
    "title": "Biological Stats 2: Lab 1",
    "section": "Boolean logic operators",
    "text": "Boolean logic operators\n\n\n\nOperator\nR Code\n\n\n\n\nAND\n& (&&)\n\n\nOR\n| (||)\n\n\nNOT\n!\n\n\nless than\n<\n\n\ngreater than\n>\n\n\nless than or equal\n<=\n\n\ngreater than or equal\n>=\n\n\nequals\n==\n\n\nNOT equal\n!=\n\n\n\n&& and || are used when asking IF statements.\nThese only use a single value, not a vector."
  },
  {
    "objectID": "labs/lab-01.html#boolean-examples",
    "href": "labs/lab-01.html#boolean-examples",
    "title": "Biological Stats 2: Lab 1",
    "section": "Boolean examples",
    "text": "Boolean examples\n\nx <- 7 \nx == 7 \n[1] TRUE\nx < 10 \n[1] TRUE\nx < -3 \n[1] FALSE\nx > 0 & x <= 12\n[1] TRUE\nx >= 10 | x < 0 \n[1] FALSE\n\n\ny <- c(4,8)\ny > 5   #returns a logical vector\n[1] FALSE  TRUE\ny[y>5]  #returns elements of y that meet condition\n[1] 8\nwhich(y>5) #index of y that meets condition\n[1] 2\nany(y>5)\n[1] TRUE\nall(y>5)\n[1] FALSE"
  },
  {
    "objectID": "labs/lab-01.html#lab-exercise-34",
    "href": "labs/lab-01.html#lab-exercise-34",
    "title": "Biological Stats 2: Lab 1",
    "section": "Lab exercise 3/4",
    "text": "Lab exercise 3/4\nComplete the following using the vector y:\ny <- c(3,2,15,-1,22,1,9,17,5)\n\nDisplay the first and last values.\n\nFind the last value for a vector of any length.\n\nDisplay the values that are greater than the mean of y.\n\nDisplay the positions (indices) of the values greater than the mean.\n\nAre all the values positive?\n\nAre any of the values equal to the mean?\n\nAre any of the values equal to the median?"
  },
  {
    "objectID": "labs/lab-01.html#other-types-of-objects",
    "href": "labs/lab-01.html#other-types-of-objects",
    "title": "Biological Stats 2: Lab 1",
    "section": "Other types of objects",
    "text": "Other types of objects\nmatrices (more generally, arrays)\n- multi-dimensional generalizations of vectors.\n- are vectors that can be indexed by two or more indices.\nfactors\n- compact ways to handle categorical data.\nlists\n- general form of vector, elements need not be the same type.\n- elements often themselves vectors or lists.\n- convenient way to return results of statistical computations.\ndataframes\n- matrix-like structures, columns can be of different types.\n- often ‘data matrices’ with one row per observational unit but with (possibly) both numerical and categorical variables.\n\nfunctions\n- are themselves objects in R which can be stored in the project’s workspace.\n- provide a simple and convenient way to extend R."
  },
  {
    "objectID": "labs/lab-01.html#dataframes",
    "href": "labs/lab-01.html#dataframes",
    "title": "Biological Stats 2: Lab 1",
    "section": "Dataframes",
    "text": "Dataframes\nThere are lots of data set examples in R.\ne.g. record times for 35 Scottish hill races\n\n\nlibrary(MASS)\nhead(hills,n=3) # shows first few lines. Also tail()\n             dist climb   time\nGreenmantle   2.5   650 16.083\nCarnethy      6.0  2500 48.350\nCraig Dunain  6.0   900 33.650\nnames(hills)  # get the names of the data frame\n[1] \"dist\"  \"climb\" \"time\" \n\n\nCreating dataframes\n\nfish <- c(\"cod\",\"haddock\",\"dogfish\",\"pollock\")\nlength <- c(34,23,75,18)\nage <- c(6,3,17,2)\nfish.data <- data.frame(fish=fish,length=length,age=age)\nhead(fish.data)\n     fish length age\n1     cod     34   6\n2 haddock     23   3\n3 dogfish     75  17\n4 pollock     18   2"
  },
  {
    "objectID": "labs/lab-01.html#extracting-information-from-data-frames",
    "href": "labs/lab-01.html#extracting-information-from-data-frames",
    "title": "Biological Stats 2: Lab 1",
    "section": "Extracting information from data frames",
    "text": "Extracting information from data frames\nUse the $ to extract vectors from a data frame\n\nhills$dist\n [1]  2.5  6.0  6.0  7.5  8.0  8.0 16.0  6.0  5.0  6.0 28.0  5.0  9.5  6.0  4.5\n[16] 10.0 14.0  3.0  4.5  5.5  3.0  3.5  6.0  2.0  3.0  4.0  6.0  5.0  6.5  5.0\n[31] 10.0  6.0 18.0  4.5 20.0\n\nYou can also specify the row index, column index, or both object[row,column]\n\n# extract the element in row 1, column 2\nhills[1,2]\n[1] 650\nhills$climb[1]\n[1] 650\n# extract the first row\nhills[1,]\n            dist climb   time\nGreenmantle  2.5   650 16.083"
  },
  {
    "objectID": "labs/lab-01.html#extracting-information-from-data-frames-2",
    "href": "labs/lab-01.html#extracting-information-from-data-frames-2",
    "title": "Biological Stats 2: Lab 1",
    "section": "Extracting information from data frames (2)",
    "text": "Extracting information from data frames (2)\nData frames are commonly used in a structure called a ‘tibble’, from the tidyverse.\n\n#install.packages('tidyverse')\nlibrary(tidyverse)\n\n\nhills_tbl <- as_tibble(hills)\nhills_tbl\n# A tibble: 35 × 3\n    dist climb  time\n   <dbl> <int> <dbl>\n 1   2.5   650  16.1\n 2   6    2500  48.4\n 3   6     900  33.6\n 4   7.5   800  45.6\n 5   8    3070  62.3\n 6   8    2866  73.2\n 7  16    7500 205. \n 8   6     800  36.4\n 9   5     800  29.8\n10   6     650  39.8\n# … with 25 more rows"
  },
  {
    "objectID": "labs/lab-01.html#quickly-visualize-the-dataset",
    "href": "labs/lab-01.html#quickly-visualize-the-dataset",
    "title": "Biological Stats 2: Lab 1",
    "section": "Quickly visualize the dataset",
    "text": "Quickly visualize the dataset\n\n\n\n\n\n\n\n\n\n\n\n\n\nlibrary(ggplot2)\nggplot(data = hills_tbl, mapping = aes(x=dist,y=time)) +\n  geom_point(aes(size = climb), alpha = 1/3) +\n  xlab(\"Distance (miles)\") +\n  ylab(\"Record Time (mins)\") +\n  xlim(0,30) + ylim(0,225)"
  },
  {
    "objectID": "labs/lab-01.html#extracting-elements-logically",
    "href": "labs/lab-01.html#extracting-elements-logically",
    "title": "Biological Stats 2: Lab 1",
    "section": "Extracting elements logically",
    "text": "Extracting elements logically\n\nfish <- c(\"cod\",\"haddock\",\"dogfish\",\"pollock\")\nlength <- c(34,23,75,18)\nage <- c(6,3,17,2)\nfish_data <- tibble(fish=fish,length=length,age=age)\nfish_data$age   # a vector\n[1]  6  3 17  2\nfish_data$age > 5  # a logical vector\n[1]  TRUE FALSE  TRUE FALSE\nfilter(fish_data, age>5) #avoids having to create a logical vector\n# A tibble: 2 × 3\n  fish    length   age\n  <chr>    <dbl> <dbl>\n1 cod         34     6\n2 dogfish     75    17\n# combining conditions\nfilter(fish_data, age > 5, fish == \"dogfish\")\n# A tibble: 1 × 3\n  fish    length   age\n  <chr>    <dbl> <dbl>\n1 dogfish     75    17\nfilter(fish_data, length < 25 | length >= 50)\n# A tibble: 3 × 3\n  fish    length   age\n  <chr>    <dbl> <dbl>\n1 haddock     23     3\n2 dogfish     75    17\n3 pollock     18     2"
  },
  {
    "objectID": "labs/lab-01.html#using-the-pipe",
    "href": "labs/lab-01.html#using-the-pipe",
    "title": "Biological Stats 2: Lab 1",
    "section": "Using the Pipe",
    "text": "Using the Pipe\nCombine verb operations with the pipe operator (|>) e.g.\n\nfish_data |>\n  mutate(weight = (length/100)^3) |>\n  filter(age > 5)\n# A tibble: 2 × 4\n  fish    length   age weight\n  <chr>    <dbl> <dbl>  <dbl>\n1 cod         34     6 0.0393\n2 dogfish     75    17 0.422 \n\nThe pipe passes the result from one function call to the next.\nCan be read as “and then”.\n(also the older tidyverse pipe: %>% )"
  },
  {
    "objectID": "labs/lab-01.html#summarizing-data",
    "href": "labs/lab-01.html#summarizing-data",
    "title": "Biological Stats 2: Lab 1",
    "section": "Summarizing Data",
    "text": "Summarizing Data\nAfter selecting data we might like to perform analyses on it.\nWe can use group_by() to recognize structure in the data.\nThen apply functions to variables using summarize()\nRecall gapminder data, find the average life expectancy in 2007 for each continent\n\n#install.packages('gapminder')\nlibrary(gapminder)\ngapminder |> \n  filter(year == 2007) |> \n  group_by(continent) |>\n  summarize(avg_lifeExp = mean(lifeExp))\n# A tibble: 5 × 2\n  continent avg_lifeExp\n  <fct>           <dbl>\n1 Africa           54.8\n2 Americas         73.6\n3 Asia             70.7\n4 Europe           77.6\n5 Oceania          80.7"
  },
  {
    "objectID": "labs/lab-01.html#tips-and-tricks",
    "href": "labs/lab-01.html#tips-and-tricks",
    "title": "Biological Stats 2: Lab 1",
    "section": "Tips and Tricks",
    "text": "Tips and Tricks\nComments\nUse comments within R code to document the purpose of your code. Anything on a line after a # is ignored by R. RStudio uses a different color to help readability.\nSAVE your scripts(!), not workspaces. Use meaningful variable names. Adopt a coding style and use consistently.\n(e.g. https://google.github.io/styleguide/Rguide.xml)\nThe str() function can be incredibly helpful when querying objects.\nMake use of help() documentation.\nThere are almost always multiple ways of getting the same result.\nWe’ll mostly use low level functions to help you understand how R works.\nSome advanced functions are cleaner and do things more quickly."
  },
  {
    "objectID": "labs/lab-01.html#lab-exercise-44-data-frames-using-hills",
    "href": "labs/lab-01.html#lab-exercise-44-data-frames-using-hills",
    "title": "Biological Stats 2: Lab 1",
    "section": "Lab exercise 4/4 (data frames using hills)",
    "text": "Lab exercise 4/4 (data frames using hills)\n\nDisplay the first 5 rows of the hills dataframe.\n\nFind the fastest time.\n\nDisplay the hill races (and distance, climbs, and times) with the 3 fastest times.\n\nExtract and display the record time for Cairngorm.\n\nFind how many hill races have a climb greater than the mean.\n\nDisplay the names of the hill races that have a climb greater than the mean.\n\nDisplay the names and times of the races that are at least 10 miles long and have a climb greater than 4000 feet.\n\nFind the standard deviation of the record times for all races except for the highest climb, the Bens of Jura.\n\nDisplay the range (minimum and maximum) of the average speed for the races.\n\nFind the race that had the fastest average speed.\n\nBONUS Find the mean of the record times for races whose names start with letters A through K."
  },
  {
    "objectID": "labs/lab-01.html#next-time",
    "href": "labs/lab-01.html#next-time",
    "title": "Biological Stats 2: Lab 1",
    "section": "Next time…",
    "text": "Next time…\n1/18: Introduction to R and R Studio, working with data\n1/25: Intro to Vizualization\n2/01: Probability, linear modeling\n2/08: Data wrangling, model summaries\n2/15: Iteration\n2/22: Creating functions, debugging\n3/01: Simulation, Resampling\n3/15: Flex: more modeling (brms, glmmTMB)\n3/29: Spatial data or tidymodeling\n\n\n\ngavinfay.github.io/mar536-biolstats2-s23"
  },
  {
    "objectID": "labs/lab-04.html#lab-schedule",
    "href": "labs/lab-04.html#lab-schedule",
    "title": "MAR 536: Lab 4",
    "section": "Lab schedule",
    "text": "Lab schedule\n1/18: Introduction to R and R Studio, working with data\n1/25: Intro to Visualization\n2/01: Probability, linear modeling\n2/08: Data wrangling, model summaries\n2/15: Simulation, Resampling\n2/22: Iteration\n3/01: Creating functions, debugging\n3/15: Flex: more modeling (brms, glmmTMB)\n3/29: Spatial data or tidymodeling\nAcknowledgements: Mine Çetinkaya-Rundel, Allison Horst"
  },
  {
    "objectID": "labs/lab-04.html#today",
    "href": "labs/lab-04.html#today",
    "title": "MAR 536: Lab 4",
    "section": "Today",
    "text": "Today\nTopics\n\nPoisson GLM\nProgramming Practices\nData wrangling"
  },
  {
    "objectID": "labs/lab-04.html#setup",
    "href": "labs/lab-04.html#setup",
    "title": "MAR 536: Lab 4",
    "section": "setup",
    "text": "setup\n\nlibrary(tidyverse)\nlibrary(broom)\n\n\n#first read in the data (richness already created)\nRIKZ <- readRDS(\"../data/RIKZ.rds\")"
  },
  {
    "objectID": "labs/lab-04.html#generalized-linear-modeling",
    "href": "labs/lab-04.html#generalized-linear-modeling",
    "title": "MAR 536: Lab 4",
    "section": "Generalized linear modeling",
    "text": "Generalized linear modeling\nAll GLMs have the following three characteristics:\n\nA probability distribution describing a generative model for the outcome variable.\n\n\n\nA linear model:\n\n\\[\\eta = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_k X_k\\]\n\n\n\nA link function that relates the linear model to the parameter of the outcome distribution."
  },
  {
    "objectID": "labs/lab-04.html#generalized-linear-modeling-1",
    "href": "labs/lab-04.html#generalized-linear-modeling-1",
    "title": "MAR 536: Lab 4",
    "section": "Generalized linear modeling",
    "text": "Generalized linear modeling\nRecall from lecture: \\[\\eta = \\beta_1 x_1 + \\beta_2 x_2 + \\dots + \\beta_p x_p\\] \\[f_Y(y;\\mu,\\varphi) = \\exp\\left[\\frac{A}{\\varphi}{y\\lambda(\\mu)-\\gamma(\\lambda(\\mu))}+\\tau(y,\\varphi)\\right]\\] \\[\\mu = m(\\eta) \\text{,    } \\eta = m^{-1}(\\mu)=l(\\mu)\\]\nThe combination of a response distribution, a link function and other information needed to carry out the modeling exercise is called the family of the generalized linear model."
  },
  {
    "objectID": "labs/lab-04.html#the-glm-function",
    "href": "labs/lab-04.html#the-glm-function",
    "title": "MAR 536: Lab 4",
    "section": "The glm() function",
    "text": "The glm() function\nThe R function to fit a generalized linear model is glm() which uses the form:\nfitted.model <- glm(formula, family=family.generator, data=data.frame)\nOnly new piece is the call to ‘family.generator’\nAlthough complex, its use is fairly simple.\nWhere there is a choice of link, link can be supplied with the family name as a parameter.\nSimple (inefficient) use: The following are equivalent.\n\nRIKZ_lm1 <- lm(Richness ~ NAP, data = RIKZ)\nRIKZ_glm1 <- glm(Richness ~ NAP, family = gaussian, \n                 data = RIKZ)\n\nMost of the extraction functions that can be applied to lm() can also be used with glm()."
  },
  {
    "objectID": "labs/lab-04.html#the-glm-function-1",
    "href": "labs/lab-04.html#the-glm-function-1",
    "title": "MAR 536: Lab 4",
    "section": "The glm() function",
    "text": "The glm() function\n\ntidy(RIKZ_lm1)\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)     6.69     0.658     10.2  5.25e-13\n2 NAP            -2.87     0.631     -4.55 4.42e- 5\ntidy(RIKZ_glm1)\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)     6.69     0.658     10.2  5.25e-13\n2 NAP            -2.87     0.631     -4.55 4.42e- 5"
  },
  {
    "objectID": "labs/lab-04.html#poisson-regression",
    "href": "labs/lab-04.html#poisson-regression",
    "title": "MAR 536: Lab 4",
    "section": "Poisson regression",
    "text": "Poisson regression\n\\[P(X=x) = \\frac{e^{-\\mu} \\mu^x}{x!} \\text{,   } \\mu_i = e^{\\alpha+\\beta_1 x_{1,i} + \\dots + \\beta_j x_{j,i}}\\]"
  },
  {
    "objectID": "labs/lab-04.html#rikz-example",
    "href": "labs/lab-04.html#rikz-example",
    "title": "MAR 536: Lab 4",
    "section": "RIKZ example",
    "text": "RIKZ example\n\n#fit the poisson regression model\nRIKZ_poisson <- glm(Richness ~ NAP, data = RIKZ, \n                    family = poisson)\n\nNote that the default link for the poisson is log so we don’t have to specify here (see ?family)."
  },
  {
    "objectID": "labs/lab-04.html#summaryrikz_poisson",
    "href": "labs/lab-04.html#summaryrikz_poisson",
    "title": "MAR 536: Lab 4",
    "section": "summary(RIKZ_poisson)",
    "text": "summary(RIKZ_poisson)\n\n\nCall:\nglm(formula = Richness ~ NAP, family = poisson, data = RIKZ)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.2029  -1.2432  -0.9199   0.3943   4.3256  \n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  1.79100    0.06329  28.297  < 2e-16 ***\nNAP         -0.55597    0.07163  -7.762 8.39e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 179.75  on 44  degrees of freedom\nResidual deviance: 113.18  on 43  degrees of freedom\nAIC: 259.18\n\nNumber of Fisher Scoring iterations: 5"
  },
  {
    "objectID": "labs/lab-04.html#broomaugment",
    "href": "labs/lab-04.html#broomaugment",
    "title": "MAR 536: Lab 4",
    "section": "broom::augment()",
    "text": "broom::augment()\nAs with lm(), the augment() function can be used to obtain the predictions from a fitted model object, and for a new data frame.\n\nnewobject <- augment(oldobject, newdata, \n                     type.predict = c(\"link\",\"response\",\"terms\"),\n                     se_fit = TRUE)\n\nNote: default for type.predict is on the scale of the linear predictors. Set to \"response\" to obtain predictions on the scale of the response variable.\n\naugment(RIKZ_poisson, se_fit = TRUE)\n\n# A tibble: 45 × 9\n   Richness    NAP .fitted .se.fit .resid .std.resid   .hat .sigma .cooksd\n      <dbl>  <dbl>   <dbl>   <dbl>  <dbl>      <dbl>  <dbl>  <dbl>   <dbl>\n 1       11  0.045    1.77  0.0639  1.90       1.92  0.0239   1.61 0.0569 \n 2       10 -1.04     2.37  0.0896 -0.206     -0.215 0.0856   1.64 0.00213\n 3       13 -1.34     2.53  0.106   0.112      0.121 0.142    1.64 0.00122\n 4       11  0.616    1.45  0.0827  2.72       2.76  0.0291   1.59 0.165  \n 5       10 -0.684    2.17  0.0737  0.406      0.416 0.0476   1.64 0.00453\n 6        8  1.19     1.13  0.114   2.32       2.37  0.0401   1.60 0.170  \n 7        9  0.82     1.34  0.0929  2.26       2.30  0.0328   1.60 0.125  \n 8        8  0.635    1.44  0.0836  1.64       1.66  0.0294   1.62 0.0532 \n 9       19  0.061    1.76  0.0641  4.33       4.38  0.0238   1.50 0.376  \n10       17 -1.33     2.53  0.106   1.18       1.27  0.141    1.63 0.148  \n# … with 35 more rows"
  },
  {
    "objectID": "labs/lab-04.html#observed-and-fitted-values-for-poisson-rikz",
    "href": "labs/lab-04.html#observed-and-fitted-values-for-poisson-rikz",
    "title": "MAR 536: Lab 4",
    "section": "Observed and fitted values for Poisson RIKZ",
    "text": "Observed and fitted values for Poisson RIKZ\n\n#create new values for beach height\nnew_data <- tibble(NAP = seq(-1.5,2.5,length.out=100))\n#predict values for response based on new salinity\nRIKZ_pois_pred <- augment(RIKZ_poisson,\n                    newdata = new_data, \n                    type.predict = \"response\",\n                    se_fit = \"TRUE\")\nRIKZ_pois_pred\n# A tibble: 100 × 3\n     NAP .fitted .se.fit\n   <dbl>   <dbl>   <dbl>\n 1 -1.5     13.8    1.60\n 2 -1.46    13.5    1.53\n 3 -1.42    13.2    1.46\n 4 -1.38    12.9    1.40\n 5 -1.34    12.6    1.34\n 6 -1.30    12.3    1.28\n 7 -1.26    12.1    1.23\n 8 -1.22    11.8    1.17\n 9 -1.18    11.5    1.12\n10 -1.14    11.3    1.07\n# … with 90 more rows"
  },
  {
    "objectID": "labs/lab-04.html#fitting-the-glm-in-the-ggplot-call",
    "href": "labs/lab-04.html#fitting-the-glm-in-the-ggplot-call",
    "title": "MAR 536: Lab 4",
    "section": "fitting the GLM in the ggplot call",
    "text": "fitting the GLM in the ggplot call\n\nggplot(RIKZ,aes(NAP,Richness)) +\n  geom_point() +\n  geom_smooth(method = \"glm\", \n    method.args = list(family = poisson), se = TRUE)"
  },
  {
    "objectID": "labs/lab-04.html#lab-exercise-14-rikz-poisson-glms",
    "href": "labs/lab-04.html#lab-exercise-14-rikz-poisson-glms",
    "title": "MAR 536: Lab 4",
    "section": "Lab Exercise 1/4: RIKZ Poisson GLMs",
    "text": "Lab Exercise 1/4: RIKZ Poisson GLMs\n\nFit a poisson model to RIKZ species richness that includes NAP, and exposure and week as categorical variables (factor).\nExtract the model coefficients and their 95% confidence intervals.\n\nPlot the deviance residuals versus the linear predictor.\n\nCompare the results of this model with a model for RIKZ species richness that only included NAP as a covariate using deviance and AIC.\nBONUS Show how AIC changes when each linear predictor term is dropped from the model, and show the results of chi-square tests that compare these reduced models to the original model. (hint see the help for ?add1).\nBONUS BONUS Fit a model for species richness that also includes salinity, temperature, and grain size, and perform backwards selection using AIC to obtain a ‘best’ model. How do the results compare to the other models? What is the appropriate set of variables to use?"
  },
  {
    "objectID": "labs/lab-04.html#dplyrcase_when",
    "href": "labs/lab-04.html#dplyrcase_when",
    "title": "MAR 536: Lab 4",
    "section": "dplyr::case_when()",
    "text": "dplyr::case_when()\nThe case_when() function is like a really friendly if-else statement. When used within mutate(), it allows you to add a new column containing values dependent on your condition(s)."
  },
  {
    "objectID": "labs/lab-04.html#dplyrcase_when-1",
    "href": "labs/lab-04.html#dplyrcase_when-1",
    "title": "MAR 536: Lab 4",
    "section": "dplyr::case_when()",
    "text": "dplyr::case_when()\nTo penguins, add a new column size_bin that contains:\n\n“large” if body mass is greater than 4500 g\n“medium” if body mass is greater than 3000 g, and less than or equal to 4500 g\n“small” if body mass is less than or equal to 3000 g\n\n\npenguins |>\n  mutate(size_bin = case_when(\n      body_mass_g > 4500 ~ \"large\",\n      body_mass_g > 3000 & body_mass_g <= 4500 ~ \"medium\",\n      body_mass_g <= 3000 ~ \"small\"\n    )\n  ) |>\n  select(species, island, size_bin, everything())\n\n# A tibble: 344 × 9\n   species island    size_bin bill_length_mm bill_depth_mm flipper_length_mm\n   <fct>   <fct>     <chr>             <dbl>         <dbl>             <int>\n 1 Adelie  Torgersen medium             39.1          18.7               181\n 2 Adelie  Torgersen medium             39.5          17.4               186\n 3 Adelie  Torgersen medium             40.3          18                 195\n 4 Adelie  Torgersen <NA>               NA            NA                  NA\n 5 Adelie  Torgersen medium             36.7          19.3               193\n 6 Adelie  Torgersen medium             39.3          20.6               190\n 7 Adelie  Torgersen medium             38.9          17.8               181\n 8 Adelie  Torgersen large              39.2          19.6               195\n 9 Adelie  Torgersen medium             34.1          18.1               193\n10 Adelie  Torgersen medium             42            20.2               190\n# … with 334 more rows, and 3 more variables: body_mass_g <int>, sex <fct>,\n#   year <int>"
  },
  {
    "objectID": "labs/lab-04.html#dplyrcase_when-2",
    "href": "labs/lab-04.html#dplyrcase_when-2",
    "title": "MAR 536: Lab 4",
    "section": "dplyr::case_when()",
    "text": "dplyr::case_when()\nStarting with penguins:\n\nLimit the columns to species, year, and flipper_length_mm\nRename the year column to study_year\nOnly keep observations for Adelie penguins\nAdd a new column called flipper_rank that contains:\n\n1 if flipper_length_mm is < 200 mm\n2 if flipper_length_mm is >= 200 mm\n0 if flipper_length_mm is anything else (e.g. NA)\n\n\n\npenguins |>\n  select(species, year, flipper_length_mm) |>\n  rename(study_year = year) |>\n  filter(species == \"Adelie\") |>\n  mutate(flipper_rank = case_when(\n    flipper_length_mm < 200 ~ 1,\n    flipper_length_mm >= 200 ~ 2,\n    TRUE ~ 0 # 0 for anything else\n  ))\n\n# A tibble: 152 × 4\n   species study_year flipper_length_mm flipper_rank\n   <fct>        <int>             <int>        <dbl>\n 1 Adelie        2007               181            1\n 2 Adelie        2007               186            1\n 3 Adelie        2007               195            1\n 4 Adelie        2007                NA            0\n 5 Adelie        2007               193            1\n 6 Adelie        2007               190            1\n 7 Adelie        2007               181            1\n 8 Adelie        2007               195            1\n 9 Adelie        2007               193            1\n10 Adelie        2007               190            1\n# … with 142 more rows"
  },
  {
    "objectID": "labs/lab-04.html#exercise-24",
    "href": "labs/lab-04.html#exercise-24",
    "title": "MAR 536: Lab 4",
    "section": "Exercise 2/4",
    "text": "Exercise 2/4\nAdd a new column to penguins called study_year that contains:\n\n“Year 1” if the year is 2007\n“Year 2” if the year is 2008\n“Year 3” if the year is 2009\n\nStarting with penguins, only keep observations for chinstrap penguins, then only keep the flipper_length_mm and body_mass_g variables. Add a new column called fm_ratio that contains the ratio of flipper length to body mass for each penguin. Next, add another column named ratio_bin which contains the word “high” if fm_ratio is greater than or equal to 0.05, “low” if the ratio is less than 0.05, and “no record” if anything else (e.g. NA)."
  },
  {
    "objectID": "labs/lab-04.html#not-this",
    "href": "labs/lab-04.html#not-this",
    "title": "MAR 536: Lab 4",
    "section": "Not this…",
    "text": "Not this…"
  },
  {
    "objectID": "labs/lab-04.html#but-this",
    "href": "labs/lab-04.html#but-this",
    "title": "MAR 536: Lab 4",
    "section": "but this!",
    "text": "but this!"
  },
  {
    "objectID": "labs/lab-04.html#wider-vs.-longer",
    "href": "labs/lab-04.html#wider-vs.-longer",
    "title": "MAR 536: Lab 4",
    "section": "Wider vs. longer",
    "text": "Wider vs. longer\n\n\nwider more columns ::: {.cell} ::: {.cell-output .cell-output-stdout}\n# A tibble: 2 × 4\n  customer_id item_1 item_2       item_3\n        <dbl> <chr>  <chr>        <chr> \n1           1 bread  milk         banana\n2           2 milk   toilet paper <NA>  \n\n\n:::\n\nlonger more rows ::: {.cell} ::: {.cell-output .cell-output-stdout}\n# A tibble: 6 × 3\n  customer_id item_no item        \n        <dbl> <chr>   <chr>       \n1           1 item_1  bread       \n2           1 item_2  milk        \n3           1 item_3  banana      \n4           2 item_1  milk        \n5           2 item_2  toilet paper\n6           2 item_3  <NA>        \n\n::: ::: :::"
  },
  {
    "objectID": "labs/lab-04.html#pivot_longer",
    "href": "labs/lab-04.html#pivot_longer",
    "title": "MAR 536: Lab 4",
    "section": "pivot_longer()",
    "text": "pivot_longer()\n\n\n\ndata (as usual)\ncols: columns to pivot into longer format\nnames_to: name of the column where column names of pivoted variables go (character string)\nvalues_to: name of the column where data in pivoted variables go (character string)\n\n\n\npivot_longer(\n  data, \n  cols, \n  names_to = \"name\", #<<\n  values_to = \"value\"\n  )"
  },
  {
    "objectID": "labs/lab-04.html#customers-rightarrow-purchases",
    "href": "labs/lab-04.html#customers-rightarrow-purchases",
    "title": "MAR 536: Lab 4",
    "section": "Customers \\(\\rightarrow\\) purchases",
    "text": "Customers \\(\\rightarrow\\) purchases\n\npurchases <- customers |>\n  pivot_longer( #<<\n    cols = item_1:item_3,  # variables item_1 to item_3 #<<\n    names_to = \"item_no\",  # column names -> new column called item_no #<<\n    values_to = \"item\"     # values in columns -> new column called item #<<\n    ) #<<\n\npurchases\n\n# A tibble: 6 × 3\n  customer_id item_no item        \n        <dbl> <chr>   <chr>       \n1           1 item_1  bread       \n2           1 item_2  milk        \n3           1 item_3  banana      \n4           2 item_1  milk        \n5           2 item_2  toilet paper\n6           2 item_3  <NA>"
  },
  {
    "objectID": "labs/lab-04.html#purchases-rightarrow-customers",
    "href": "labs/lab-04.html#purchases-rightarrow-customers",
    "title": "MAR 536: Lab 4",
    "section": "Purchases \\(\\rightarrow\\) customers",
    "text": "Purchases \\(\\rightarrow\\) customers\n\n\n\ndata (as usual)\nnames_from: which column in the long format contains the what should be column names in the wide format\nvalues_from: which column in the long format contains the what should be values in the new columns in the wide format\n\n\n\npurchases |>\n  pivot_wider( #<<\n    names_from = item_no, #<<\n    values_from = item #<<\n  ) #<<\n\n# A tibble: 2 × 4\n  customer_id item_1 item_2       item_3\n        <dbl> <chr>  <chr>        <chr> \n1           1 bread  milk         banana\n2           2 milk   toilet paper <NA>"
  },
  {
    "objectID": "labs/lab-04.html#steller-sea-lions",
    "href": "labs/lab-04.html#steller-sea-lions",
    "title": "MAR 536: Lab 4",
    "section": "Steller sea lions",
    "text": "Steller sea lions\nWe have data on Steller sea lion pup counts over time at a bunch of rookeries in Alaska.\n\nThe number of data points for each rookery is not the same.\nWe want to investigate the annual trend in counts for each rookery."
  },
  {
    "objectID": "labs/lab-04.html#lab-exercise-34---sea-lion-pups",
    "href": "labs/lab-04.html#lab-exercise-34---sea-lion-pups",
    "title": "MAR 536: Lab 4",
    "section": "Lab exercise 3/4 - Sea lion Pups",
    "text": "Lab exercise 3/4 - Sea lion Pups\n\nRead in the data from SSLpupcounts.csv.\nConvert the data from wide format to long format.\n\nPrint the top 10 rows of the new long format data.\n\nBONUS Convert back to wide format from long format.\n\n\n\n\n−+\n05:00"
  },
  {
    "objectID": "labs/lab-04.html#we",
    "href": "labs/lab-04.html#we",
    "title": "MAR 536: Lab 4",
    "section": "We…",
    "text": "We…\nhave multiple data frames\nwant to bring them together"
  },
  {
    "objectID": "labs/lab-04.html#data-women-in-science",
    "href": "labs/lab-04.html#data-women-in-science",
    "title": "MAR 536: Lab 4",
    "section": "Data: Women in science",
    "text": "Data: Women in science\nInformation on 10 women in science who changed the world\n\n\n\n\n \n  \n    name \n  \n \n\n  \n    Ada Lovelace \n  \n  \n    Marie Curie \n  \n  \n    Janaki Ammal \n  \n  \n    Chien-Shiung Wu \n  \n  \n    Katherine Johnson \n  \n  \n    Rosalind Franklin \n  \n  \n    Vera Rubin \n  \n  \n    Gladys West \n  \n  \n    Flossie Wong-Staal \n  \n  \n    Jennifer Doudna \n  \n\n\n\n\n\n.footnote[ Source: Discover Magazine]"
  },
  {
    "objectID": "labs/lab-04.html#inputs",
    "href": "labs/lab-04.html#inputs",
    "title": "MAR 536: Lab 4",
    "section": "Inputs",
    "text": "Inputs\n\nprofessionsdatesworks\n\n\n\nprofessions\n\n# A tibble: 10 × 2\n   name               profession                        \n   <chr>              <chr>                             \n 1 Ada Lovelace       Mathematician                     \n 2 Marie Curie        Physicist and Chemist             \n 3 Janaki Ammal       Botanist                          \n 4 Chien-Shiung Wu    Physicist                         \n 5 Katherine Johnson  Mathematician                     \n 6 Rosalind Franklin  Chemist                           \n 7 Vera Rubin         Astronomer                        \n 8 Gladys West        Mathematician                     \n 9 Flossie Wong-Staal Virologist and Molecular Biologist\n10 Jennifer Doudna    Biochemist                        \n\n\n\n\n\ndates\n\n# A tibble: 8 × 3\n  name               birth_year death_year\n  <chr>                   <dbl>      <dbl>\n1 Janaki Ammal             1897       1984\n2 Chien-Shiung Wu          1912       1997\n3 Katherine Johnson        1918       2020\n4 Rosalind Franklin        1920       1958\n5 Vera Rubin               1928       2016\n6 Gladys West              1930         NA\n7 Flossie Wong-Staal       1947         NA\n8 Jennifer Doudna          1964         NA\n\n\n\n\n\nworks\n\n# A tibble: 9 × 2\n  name               known_for                                                  \n  <chr>              <chr>                                                      \n1 Ada Lovelace       first computer algorithm                                   \n2 Marie Curie        theory of radioactivity,  discovery of elements polonium a…\n3 Janaki Ammal       hybrid species, biodiversity protection                    \n4 Chien-Shiung Wu    confim and refine theory of radioactive beta decy, Wu expe…\n5 Katherine Johnson  calculations of orbital mechanics critical to sending the …\n6 Vera Rubin         existence of dark matter                                   \n7 Gladys West        mathematical modeling of the shape of the Earth which serv…\n8 Flossie Wong-Staal first scientist to clone HIV and create a map of its genes…\n9 Jennifer Doudna    one of the primary developers of CRISPR, a ground-breaking…"
  },
  {
    "objectID": "labs/lab-04.html#desired-output",
    "href": "labs/lab-04.html#desired-output",
    "title": "MAR 536: Lab 4",
    "section": "Desired output",
    "text": "Desired output\n\n\n# A tibble: 10 × 5\n   name               profession                 birth_year death_year known_for\n   <chr>              <chr>                           <dbl>      <dbl> <chr>    \n 1 Ada Lovelace       Mathematician                      NA         NA first co…\n 2 Marie Curie        Physicist and Chemist              NA         NA theory o…\n 3 Janaki Ammal       Botanist                         1897       1984 hybrid s…\n 4 Chien-Shiung Wu    Physicist                        1912       1997 confim a…\n 5 Katherine Johnson  Mathematician                    1918       2020 calculat…\n 6 Rosalind Franklin  Chemist                          1920       1958 <NA>     \n 7 Vera Rubin         Astronomer                       1928       2016 existenc…\n 8 Gladys West        Mathematician                    1930         NA mathemat…\n 9 Flossie Wong-Staal Virologist and Molecular …       1947         NA first sc…\n10 Jennifer Doudna    Biochemist                       1964         NA one of t…"
  },
  {
    "objectID": "labs/lab-04.html#inputs-reminder",
    "href": "labs/lab-04.html#inputs-reminder",
    "title": "MAR 536: Lab 4",
    "section": "Inputs, reminder",
    "text": "Inputs, reminder\n\n\n\nnames(professions)\n\n[1] \"name\"       \"profession\"\n\nnames(dates)\n\n[1] \"name\"       \"birth_year\" \"death_year\"\n\nnames(works)\n\n[1] \"name\"      \"known_for\"\n\n\n\n\nnrow(professions)\n\n[1] 10\n\nnrow(dates)\n\n[1] 8\n\nnrow(works)\n\n[1] 9"
  },
  {
    "objectID": "labs/lab-04.html#joining-data-frames-1",
    "href": "labs/lab-04.html#joining-data-frames-1",
    "title": "MAR 536: Lab 4",
    "section": "Joining data frames",
    "text": "Joining data frames\n\nsomething_join(x, y)\n\n\nleft_join(): all rows from x\nright_join(): all rows from y\nfull_join(): all rows from both x and y\nsemi_join(): all rows from x where there are matching values in y, keeping just columns from x\ninner_join(): all rows from x where there are matching values in y, return all combination of multiple matches in the case of multiple matches\nanti_join(): return all rows from x where there are not matching values in y, never duplicate rows of x\n…"
  },
  {
    "objectID": "labs/lab-04.html#setup-1",
    "href": "labs/lab-04.html#setup-1",
    "title": "MAR 536: Lab 4",
    "section": "Setup",
    "text": "Setup\nFor the next few slides…\n\n\n\n\n\n\nx\n\n# A tibble: 3 × 2\n     id value_x\n  <dbl> <chr>  \n1     1 x1     \n2     2 x2     \n3     3 x3     \n\n\n\n\n\n\n\ny\n\n# A tibble: 3 × 2\n     id value_y\n  <dbl> <chr>  \n1     1 y1     \n2     2 y2     \n3     4 y4"
  },
  {
    "objectID": "labs/lab-04.html#left_join",
    "href": "labs/lab-04.html#left_join",
    "title": "MAR 536: Lab 4",
    "section": "left_join()",
    "text": "left_join()\n\n\n\n\n\n\n\n\n\nleft_join(x, y)\n\n# A tibble: 3 × 3\n     id value_x value_y\n  <dbl> <chr>   <chr>  \n1     1 x1      y1     \n2     2 x2      y2     \n3     3 x3      <NA>"
  },
  {
    "objectID": "labs/lab-04.html#left_join-1",
    "href": "labs/lab-04.html#left_join-1",
    "title": "MAR 536: Lab 4",
    "section": "left_join()",
    "text": "left_join()\n\nprofessions |>\n  left_join(dates) #<<\n\n# A tibble: 10 × 4\n   name               profession                         birth_year death_year\n   <chr>              <chr>                                   <dbl>      <dbl>\n 1 Ada Lovelace       Mathematician                              NA         NA\n 2 Marie Curie        Physicist and Chemist                      NA         NA\n 3 Janaki Ammal       Botanist                                 1897       1984\n 4 Chien-Shiung Wu    Physicist                                1912       1997\n 5 Katherine Johnson  Mathematician                            1918       2020\n 6 Rosalind Franklin  Chemist                                  1920       1958\n 7 Vera Rubin         Astronomer                               1928       2016\n 8 Gladys West        Mathematician                            1930         NA\n 9 Flossie Wong-Staal Virologist and Molecular Biologist       1947         NA\n10 Jennifer Doudna    Biochemist                               1964         NA"
  },
  {
    "objectID": "labs/lab-04.html#right_join",
    "href": "labs/lab-04.html#right_join",
    "title": "MAR 536: Lab 4",
    "section": "right_join()",
    "text": "right_join()\n\n\n\n\n\n\n\n\n\nright_join(x, y)\n\n# A tibble: 3 × 3\n     id value_x value_y\n  <dbl> <chr>   <chr>  \n1     1 x1      y1     \n2     2 x2      y2     \n3     4 <NA>    y4"
  },
  {
    "objectID": "labs/lab-04.html#right_join-1",
    "href": "labs/lab-04.html#right_join-1",
    "title": "MAR 536: Lab 4",
    "section": "right_join()",
    "text": "right_join()\n\nprofessions |>\n  right_join(dates) #<<\n\n# A tibble: 8 × 4\n  name               profession                         birth_year death_year\n  <chr>              <chr>                                   <dbl>      <dbl>\n1 Janaki Ammal       Botanist                                 1897       1984\n2 Chien-Shiung Wu    Physicist                                1912       1997\n3 Katherine Johnson  Mathematician                            1918       2020\n4 Rosalind Franklin  Chemist                                  1920       1958\n5 Vera Rubin         Astronomer                               1928       2016\n6 Gladys West        Mathematician                            1930         NA\n7 Flossie Wong-Staal Virologist and Molecular Biologist       1947         NA\n8 Jennifer Doudna    Biochemist                               1964         NA"
  },
  {
    "objectID": "labs/lab-04.html#full_join",
    "href": "labs/lab-04.html#full_join",
    "title": "MAR 536: Lab 4",
    "section": "full_join()",
    "text": "full_join()\n\n\n\n\n\n\n\n\n\nfull_join(x, y)\n\n# A tibble: 4 × 3\n     id value_x value_y\n  <dbl> <chr>   <chr>  \n1     1 x1      y1     \n2     2 x2      y2     \n3     3 x3      <NA>   \n4     4 <NA>    y4"
  },
  {
    "objectID": "labs/lab-04.html#full_join-1",
    "href": "labs/lab-04.html#full_join-1",
    "title": "MAR 536: Lab 4",
    "section": "full_join()",
    "text": "full_join()\n\ndates |>\n  full_join(works) #<<\n\n# A tibble: 10 × 4\n   name               birth_year death_year known_for                           \n   <chr>                   <dbl>      <dbl> <chr>                               \n 1 Janaki Ammal             1897       1984 hybrid species, biodiversity protec…\n 2 Chien-Shiung Wu          1912       1997 confim and refine theory of radioac…\n 3 Katherine Johnson        1918       2020 calculations of orbital mechanics c…\n 4 Rosalind Franklin        1920       1958 <NA>                                \n 5 Vera Rubin               1928       2016 existence of dark matter            \n 6 Gladys West              1930         NA mathematical modeling of the shape …\n 7 Flossie Wong-Staal       1947         NA first scientist to clone HIV and cr…\n 8 Jennifer Doudna          1964         NA one of the primary developers of CR…\n 9 Ada Lovelace               NA         NA first computer algorithm            \n10 Marie Curie                NA         NA theory of radioactivity,  discovery…"
  },
  {
    "objectID": "labs/lab-04.html#inner_join",
    "href": "labs/lab-04.html#inner_join",
    "title": "MAR 536: Lab 4",
    "section": "inner_join()",
    "text": "inner_join()\n\n\n\n\n\n\n\n\n\ninner_join(x, y)\n\n# A tibble: 2 × 3\n     id value_x value_y\n  <dbl> <chr>   <chr>  \n1     1 x1      y1     \n2     2 x2      y2"
  },
  {
    "objectID": "labs/lab-04.html#inner_join-1",
    "href": "labs/lab-04.html#inner_join-1",
    "title": "MAR 536: Lab 4",
    "section": "inner_join()",
    "text": "inner_join()\n\ndates |>\n  inner_join(works) #<<\n\n# A tibble: 7 × 4\n  name               birth_year death_year known_for                            \n  <chr>                   <dbl>      <dbl> <chr>                                \n1 Janaki Ammal             1897       1984 hybrid species, biodiversity protect…\n2 Chien-Shiung Wu          1912       1997 confim and refine theory of radioact…\n3 Katherine Johnson        1918       2020 calculations of orbital mechanics cr…\n4 Vera Rubin               1928       2016 existence of dark matter             \n5 Gladys West              1930         NA mathematical modeling of the shape o…\n6 Flossie Wong-Staal       1947         NA first scientist to clone HIV and cre…\n7 Jennifer Doudna          1964         NA one of the primary developers of CRI…"
  },
  {
    "objectID": "labs/lab-04.html#putting-it-altogether",
    "href": "labs/lab-04.html#putting-it-altogether",
    "title": "MAR 536: Lab 4",
    "section": "Putting it altogether",
    "text": "Putting it altogether\n\nprofessions |>\n  left_join(dates) |>\n  left_join(works)\n\n# A tibble: 10 × 5\n   name               profession                 birth_year death_year known_for\n   <chr>              <chr>                           <dbl>      <dbl> <chr>    \n 1 Ada Lovelace       Mathematician                      NA         NA first co…\n 2 Marie Curie        Physicist and Chemist              NA         NA theory o…\n 3 Janaki Ammal       Botanist                         1897       1984 hybrid s…\n 4 Chien-Shiung Wu    Physicist                        1912       1997 confim a…\n 5 Katherine Johnson  Mathematician                    1918       2020 calculat…\n 6 Rosalind Franklin  Chemist                          1920       1958 <NA>     \n 7 Vera Rubin         Astronomer                       1928       2016 existenc…\n 8 Gladys West        Mathematician                    1930         NA mathemat…\n 9 Flossie Wong-Staal Virologist and Molecular …       1947         NA first sc…\n10 Jennifer Doudna    Biochemist                       1964         NA one of t…\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n–>\n\n\n\n–>  –>  –>  –>  –>  –>"
  },
  {
    "objectID": "labs/lab-04.html#exercise-44-sea-lion-rookery-counts",
    "href": "labs/lab-04.html#exercise-44-sea-lion-rookery-counts",
    "title": "MAR 536: Lab 4",
    "section": "Exercise 4/4 Sea lion Rookery Counts",
    "text": "Exercise 4/4 Sea lion Rookery Counts\n\nSSL_Sites.csv contains the latitude and longitude of sea lion rookeries.\n\nUse a suitable join function to add the lat/lon information and geographic region to the counts dataset.\n\nSummarize the average annual pups that were counted between 2000-2015 in the Aleutian Islands (west of longitude 160W), the Gulf of Alaska (east of longitude 160W, west of 140W), and Southeast Alaska (South of latiutude 60 degrees N, but not in the Pacific Northwest).\n\nBONUS Look up how to make a map using ggplot() to map the rookery counts in 2015.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n–>\n\n–>\n\n–>  –>  –>  –>  –>  –>  –>  –>  –>\n\n–>\n\n–>  –>  –>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n–>\n\n–>  –>  –>  –>  –>  –>  –>  –>  –>  –>  –>  –>  –>  –>  –>  –>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n–>\n\n–>\n\n–>  –>  –>  –>  –>  –>  –>  –>  –>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngavinfay.github.io/mar536-biolstats2-s23"
  },
  {
    "objectID": "labs/lab-03.html",
    "href": "labs/lab-03.html",
    "title": "Bio Stats II : Lab 3",
    "section": "",
    "text": "1/18: Introduction to R and R Studio, working with data\n1/25: Intro to Visualization\n1/31: Probability, linear modeling\n2/08: Data wrangling, model summaries\n2/15: Iteration\n2/22: Creating functions, debugging\n3/01: Simulation, Resampling\n3/15: Flex: more modeling (brms, glmmTMB)\n3/29: Spatial data or tidymodeling"
  },
  {
    "objectID": "labs/lab-03.html#recommended-reading",
    "href": "labs/lab-03.html#recommended-reading",
    "title": "Bio Stats II : Lab 3",
    "section": "Recommended reading",
    "text": "Recommended reading\nAn introduction to R (Venables et al.)\n– http://cran.r-project.org/doc/manuals/R-intro.pdf - Today’s material: Chapters 8, 11."
  },
  {
    "objectID": "labs/lab-03.html#probability-distributions-in-r",
    "href": "labs/lab-03.html#probability-distributions-in-r",
    "title": "Bio Stats II : Lab 3",
    "section": "Probability distributions in R",
    "text": "Probability distributions in R\nR includes a set of probability distributions that can be used to simulate and model data.\nIf the function for the probability model is named xxx\n\npxxx: the cumulative distribution \\(P(X \\leq x)\\)\n\ndxxx: the probability distribution/density function \\(f(x)\\)\n\nqxxx: the quantile \\(q\\), the smallest \\(x\\) such that \\(P(X \\leq x) > q\\)\n\nrxxx: generate a random variable from the model xxx"
  },
  {
    "objectID": "labs/lab-03.html#probability-distributions-in-r-1",
    "href": "labs/lab-03.html#probability-distributions-in-r-1",
    "title": "Bio Stats II : Lab 3",
    "section": "Probability distributions in R",
    "text": "Probability distributions in R"
  },
  {
    "objectID": "labs/lab-03.html#standard-normal-distribution",
    "href": "labs/lab-03.html#standard-normal-distribution",
    "title": "Bio Stats II : Lab 3",
    "section": "Standard normal distribution",
    "text": "Standard normal distribution\n(\\(\\mu=0\\), \\(\\sigma^2=1\\))"
  },
  {
    "objectID": "labs/lab-03.html#functions-for-normal-distribution",
    "href": "labs/lab-03.html#functions-for-normal-distribution",
    "title": "Bio Stats II : Lab 3",
    "section": "Functions for normal distribution",
    "text": "Functions for normal distribution\nValues of \\(x\\) for different quantiles\nqnorm(p, mean=0, sd=1, lower.tail=TRUE, log.p=FALSE)\n\nquants <- qnorm(c(0.01,0.025,0.05,0.95,0.975,0.99)) \nround(quants,2) \n[1] -2.33 -1.96 -1.64  1.64  1.96  2.33\n\n\\(P(X \\leq x)\\)\npnorm(q, mean=0, sd=1, lower.tail=TRUE, log.p=FALSE)\n\npnorm(quants) \n[1] 0.010 0.025 0.050 0.950 0.975 0.990"
  },
  {
    "objectID": "labs/lab-03.html#functions-for-normal-distribution-1",
    "href": "labs/lab-03.html#functions-for-normal-distribution-1",
    "title": "Bio Stats II : Lab 3",
    "section": "Functions for normal distribution",
    "text": "Functions for normal distribution\nDensity (probability ‘mass’ per unit value of \\(x\\))\n\ndnorm(quants, mean = 0, sd = 1)\n[1] 0.02665214 0.05844507 0.10313564 0.10313564 0.05844507 0.02665214\n\nGenerating standard normal random variables\n\nrnorm(n=10, mean = 0, sd = 1)\n [1] -0.6117713  0.1564874 -1.2640406 -0.7059636 -0.3142670 -0.1862943\n [7]  0.1838467  2.1651635  0.9719611 -0.3910794"
  },
  {
    "objectID": "labs/lab-03.html#generating-random-numbers",
    "href": "labs/lab-03.html#generating-random-numbers",
    "title": "Bio Stats II : Lab 3",
    "section": "Generating random numbers",
    "text": "Generating random numbers\nOften a good idea to use set.seed() and save the script detailing which number was used.\nThis ensures you can exactly repeat your results.\n\nset.seed(42) \nrnorm(3) \n[1]  1.3709584 -0.5646982  0.3631284\nrnorm(3) \n[1]  0.6328626  0.4042683 -0.1061245\nset.seed(42) \nrnorm(3) \n[1]  1.3709584 -0.5646982  0.3631284\nrnorm(3) \n[1]  0.6328626  0.4042683 -0.1061245"
  },
  {
    "objectID": "labs/lab-03.html#the-sample-function",
    "href": "labs/lab-03.html#the-sample-function",
    "title": "Bio Stats II : Lab 3",
    "section": "The sample() function",
    "text": "The sample() function\nTo generate random numbers from discrete sets of values:\n- With or without replacement\n- Equal or weighted probability\nExtremely useful function that underlies many modern statistical techniques:\n- Resampling\n- Bootstrapping\n- Markov-chain Monte-Carlo (MCMC)\ne.g. Roll 10 dice\n\nsample(1:6, size = 10, replace = TRUE)\n [1] 4 1 5 6 4 2 2 3 1 1\n\nPick 3 species of bear\n\nbears <- c(\"American Black\", \"Asian Black\", \"Brown\", \n           \"Panda\", \"Polar\", \"Sloth\", \"Spectacled\", \"Sun\")\nsample(bears, size = 3, replace = FALSE)\n[1] \"Brown\" \"Panda\" \"Polar\""
  },
  {
    "objectID": "labs/lab-03.html#lab-exercise-13",
    "href": "labs/lab-03.html#lab-exercise-13",
    "title": "Bio Stats II : Lab 3",
    "section": "Lab Exercise 1/3",
    "text": "Lab Exercise 1/3\n\nGenerate 1,000 random normal numbers with mean 24 and standard deviation 10. Find the proportion of those random numbers that are \\(\\geq2\\) standard deviations from the sample mean.\n\nFlip a (fair) coin six times.\n\nFind the probability of getting six heads on those six flips (i.e. \\(P(X=6)\\) given \\(n=6\\)).\n\nHow much more likely is it to get three heads than six?\n\nFor a standard normal random variable, find the number \\(x\\) such that \\(P(-x \\leq X \\leq x) = 0.24\\).\n\nThe mean rate of arrival of alewives at a weir is 3.5 per hour. Plot the probability distribution function for the number of alewife arrivals in an hour.\n\nFind the 95% confidence interval for the number of alewives arriving per day."
  },
  {
    "objectID": "labs/lab-03.html#linear-models-in-r",
    "href": "labs/lab-03.html#linear-models-in-r",
    "title": "Bio Stats II : Lab 3",
    "section": "Linear models in R",
    "text": "Linear models in R\nRecall linear regression model:\n\\[y_i = \\displaystyle\\sum_{j=0}^{p}\\beta_j x_{ij} + \\varepsilon_i \\text{ ,    } \\varepsilon_i \\sim N(0,\\sigma^2) \\text{ ,    } i=1,\\dots,n\\]\nIn matrix form: \\(y = X\\beta + \\varepsilon\\)\nModel formulae in R, \\(y \\sim x\\), try ?formula"
  },
  {
    "objectID": "labs/lab-03.html#linear-models-lm",
    "href": "labs/lab-03.html#linear-models-lm",
    "title": "Bio Stats II : Lab 3",
    "section": "Linear models, lm()",
    "text": "Linear models, lm()\nThe basic function for fitting ordinary multiple models is lm()\nfitted.model <- lm(formula, data = data.frame)\ne.g. species richness on beaches (Zuur Chapters 5 & 27)\n\nRIKZ <- read_table(file = \"../data/RIKZ.txt\")\nRIKZ <- RIKZ |>\n  mutate(Richness = rowSums(RIKZ[,2:76]>0)) |>\n  select(Richness, 77:89)\nRIKZ_lm1 <- lm(Richness ~ NAP, data = RIKZ)"
  },
  {
    "objectID": "labs/lab-03.html#extracting-model-information",
    "href": "labs/lab-03.html#extracting-model-information",
    "title": "Bio Stats II : Lab 3",
    "section": "Extracting model information",
    "text": "Extracting model information\nThe value of lm() is a fitted model object.\n- a list of results of class lm.\nInformation about the fitted model can be extracted, displayed, plotted, using some generic functions, inlcuding:\n\nanova(object1,object2) Compares a submodel with an outer model and produces an analysis of variance table\ncoef(object) Extract the regression coefficient\n\ndeviance(object) Residual sum of squares\n\nformula(object) Extract the model formula\n\nplot(object) Produce four plots, showing residuals, fitted values and some diagnostics\n\npredict(object, newdata=data.frame) Model predictions on new data\n\nresiduals(object) or resid(object) Extract the matrix of residuals\n\nstep(object) forward or backward model selection using AIC\n\nsummary(object) Print a comprehensive summary of the results\n\nvcov(object) Return variance-covariance matrix of main parameters"
  },
  {
    "objectID": "labs/lab-03.html#summary-objects",
    "href": "labs/lab-03.html#summary-objects",
    "title": "Bio Stats II : Lab 3",
    "section": "Summary objects",
    "text": "Summary objects\nsummary(lm1)\n\n\nCall:\nlm(formula = Richness ~ NAP, data = RIKZ)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-5.0675 -2.7607 -0.8029  1.3534 13.8723 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   6.6857     0.6578  10.164 5.25e-13 ***\nNAP          -2.8669     0.6307  -4.545 4.42e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.16 on 43 degrees of freedom\nMultiple R-squared:  0.3245,    Adjusted R-squared:  0.3088 \nF-statistic: 20.66 on 1 and 43 DF,  p-value: 4.418e-05"
  },
  {
    "objectID": "labs/lab-03.html#broom-helper-functions",
    "href": "labs/lab-03.html#broom-helper-functions",
    "title": "Bio Stats II : Lab 3",
    "section": "broom helper functions",
    "text": "broom helper functions\nbroom::tidy()\n\nlibrary(broom)\ntidy(RIKZ_lm1, conf.int = TRUE)\n# A tibble: 2 × 7\n  term        estimate std.error statistic  p.value conf.low conf.high\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n1 (Intercept)     6.69     0.658     10.2  5.25e-13     5.36      8.01\n2 NAP            -2.87     0.631     -4.55 4.42e- 5    -4.14     -1.59\n\nbroom::glance()\n\nglance(RIKZ_lm1)\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>     <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.325         0.309  4.16      20.7 0.0000442     1  -127.  260.  265.\n# … with 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>"
  },
  {
    "objectID": "labs/lab-03.html#modelsummary",
    "href": "labs/lab-03.html#modelsummary",
    "title": "Bio Stats II : Lab 3",
    "section": "{modelsummary}",
    "text": "{modelsummary}\nThe {modelsummary} package provides a wealth of options for creating publication-quality summary tables from fitted model objects, with bindings for most of the types of models we are using in this class.\nThere are lots of options….\n\nlibrary(modelsummary)\nmodelsummary(list(lm1 = RIKZ_lm1), \n             statistic = \"conf.int\",\n             stars = TRUE)"
  },
  {
    "objectID": "labs/lab-03.html#are-model-assumptions-met",
    "href": "labs/lab-03.html#are-model-assumptions-met",
    "title": "Bio Stats II : Lab 3",
    "section": "Are model assumptions met?",
    "text": "Are model assumptions met?\nIn the MASS library there are many functions.\nAre samples independent? (Sample design.)\nResiduals normally distributed?\n- Histograms, qq-plots: qqplot() and qqline()\n- Kolmogorov-Smirnov normality test: ks.test()\n- Shapiro-Wilk normality test: shapiro.test()\nSimilar variance among samples?\n- Boxplots\n- Bartlett’s test for equal variance: bartlett.test()\n- Fligner-Killeen test for equal variance: fligner.test()"
  },
  {
    "objectID": "labs/lab-03.html#checking-assumptions",
    "href": "labs/lab-03.html#checking-assumptions",
    "title": "Bio Stats II : Lab 3",
    "section": "Checking assumptions",
    "text": "Checking assumptions\nModel assumptions can be evaluated by plotting the model object.\n\nplot(RIKZ_lm1)\n# OR\nlibrary(gglm)\ngglm(RIKZ_lm1)\n\n\n\ngglm(RIKZ_lm1)"
  },
  {
    "objectID": "labs/lab-03.html#extracting-model-fit-residuals",
    "href": "labs/lab-03.html#extracting-model-fit-residuals",
    "title": "Bio Stats II : Lab 3",
    "section": "Extracting model fit & residuals",
    "text": "Extracting model fit & residuals\nbroom::augment()\n\nRIKZ_lm1_aug <- augment(RIKZ_lm1, se_fit = )\nglimpse(RIKZ_lm1_aug)\nRows: 45\nColumns: 8\n$ Richness   <dbl> 11, 10, 13, 11, 10, 8, 9, 8, 19, 17, 6, 1, 4, 3, 3, 1, 3, 3…\n$ NAP        <dbl> 0.045, -1.036, -1.336, 0.616, -0.684, 1.190, 0.820, 0.635, …\n$ .fitted    <dbl> 6.556653, 9.655722, 10.515778, 4.919680, 8.646589, 3.274107…\n$ .resid     <dbl> 4.4433465, 0.3442783, 2.4842223, 6.0803197, 1.3534106, 4.72…\n$ .hat       <dbl> 0.02432839, 0.06623475, 0.08738853, 0.02387714, 0.04669014,…\n$ .sigma     <dbl> 4.151533, 4.208801, 4.189991, 4.100641, 4.203722, 4.142941,…\n$ .cooksd    <dbl> 0.0145788938, 0.0002601525, 0.0187094818, 0.0267685231, 0.0…\n$ .std.resid <dbl> 1.08136537, 0.08564557, 0.62511744, 1.47940908, 0.33321661,…"
  },
  {
    "objectID": "labs/lab-03.html#extracting-model-fit-residuals-1",
    "href": "labs/lab-03.html#extracting-model-fit-residuals-1",
    "title": "Bio Stats II : Lab 3",
    "section": "Extracting model fit & residuals",
    "text": "Extracting model fit & residuals\n\nRIKZ_lm1_aug <- augment(RIKZ_lm1, \n                        se_fit = TRUE)\nglimpse(RIKZ_lm1_aug)\nRows: 45\nColumns: 9\n$ Richness   <dbl> 11, 10, 13, 11, 10, 8, 9, 8, 19, 17, 6, 1, 4, 3, 3, 1, 3, 3…\n$ NAP        <dbl> 0.045, -1.036, -1.336, 0.616, -0.684, 1.190, 0.820, 0.635, …\n$ .fitted    <dbl> 6.556653, 9.655722, 10.515778, 4.919680, 8.646589, 3.274107…\n$ .se.fit    <dbl> 0.6488474, 1.0706040, 1.2297395, 0.6428018, 0.8988733, 0.81…\n$ .resid     <dbl> 4.4433465, 0.3442783, 2.4842223, 6.0803197, 1.3534106, 4.72…\n$ .hat       <dbl> 0.02432839, 0.06623475, 0.08738853, 0.02387714, 0.04669014,…\n$ .sigma     <dbl> 4.151533, 4.208801, 4.189991, 4.100641, 4.203722, 4.142941,…\n$ .cooksd    <dbl> 0.0145788938, 0.0002601525, 0.0187094818, 0.0267685231, 0.0…\n$ .std.resid <dbl> 1.08136537, 0.08564557, 0.62511744, 1.47940908, 0.33321661,…"
  },
  {
    "objectID": "labs/lab-03.html#extracting-model-fit-residuals-2",
    "href": "labs/lab-03.html#extracting-model-fit-residuals-2",
    "title": "Bio Stats II : Lab 3",
    "section": "Extracting model fit & residuals",
    "text": "Extracting model fit & residuals\n\nRIKZ_lm1_aug <- augment(RIKZ_lm1, \n                        interval = \"confidence\")\nglimpse(RIKZ_lm1_aug)\nRows: 45\nColumns: 10\n$ Richness   <dbl> 11, 10, 13, 11, 10, 8, 9, 8, 19, 17, 6, 1, 4, 3, 3, 1, 3, 3…\n$ NAP        <dbl> 0.045, -1.036, -1.336, 0.616, -0.684, 1.190, 0.820, 0.635, …\n$ .fitted    <dbl> 6.556653, 9.655722, 10.515778, 4.919680, 8.646589, 3.274107…\n$ .lower     <dbl> 5.24812804, 7.49664302, 8.03577164, 3.62334705, 6.83383871,…\n$ .upper     <dbl> 7.865179, 11.814800, 12.995784, 6.216014, 10.459340, 4.9208…\n$ .resid     <dbl> 4.4433465, 0.3442783, 2.4842223, 6.0803197, 1.3534106, 4.72…\n$ .hat       <dbl> 0.02432839, 0.06623475, 0.08738853, 0.02387714, 0.04669014,…\n$ .sigma     <dbl> 4.151533, 4.208801, 4.189991, 4.100641, 4.203722, 4.142941,…\n$ .cooksd    <dbl> 0.0145788938, 0.0002601525, 0.0187094818, 0.0267685231, 0.0…\n$ .std.resid <dbl> 1.08136537, 0.08564557, 0.62511744, 1.47940908, 0.33321661,…"
  },
  {
    "objectID": "labs/lab-03.html#extracting-model-fit-residuals-3",
    "href": "labs/lab-03.html#extracting-model-fit-residuals-3",
    "title": "Bio Stats II : Lab 3",
    "section": "Extracting model fit & residuals",
    "text": "Extracting model fit & residuals\n\nRIKZ_lm1_aug |>\n  janitor::clean_names() |>\n  ggplot() +\n  aes(x = nap, y = fitted) +\n  geom_line() + \n  geom_point(aes(x = nap, y= richness))"
  },
  {
    "objectID": "labs/lab-03.html#fitting-models-directly-on-plots",
    "href": "labs/lab-03.html#fitting-models-directly-on-plots",
    "title": "Bio Stats II : Lab 3",
    "section": "Fitting models directly on plots",
    "text": "Fitting models directly on plots\n\nggplot(RIKZ, aes(x = NAP, y = Richness)) +\n  geom_point() + \n  geom_smooth(method = \"lm\")\n`geom_smooth()` using formula 'y ~ x'"
  },
  {
    "objectID": "labs/lab-03.html#building-and-comparing-models",
    "href": "labs/lab-03.html#building-and-comparing-models",
    "title": "Bio Stats II : Lab 3",
    "section": "Building and Comparing models",
    "text": "Building and Comparing models\n\nlibrary(moderndive)\nggplot(RIKZ) +\n  aes(x = NAP, y = Richness, color = factor(week)) +\n  geom_point() + \n  labs(x = \"NAP\", y = \"Species Richness\", \n       color = \"Week\") +\n  geom_parallel_slopes(se = TRUE)"
  },
  {
    "objectID": "labs/lab-03.html#building-and-comparing-models-1",
    "href": "labs/lab-03.html#building-and-comparing-models-1",
    "title": "Bio Stats II : Lab 3",
    "section": "Building and Comparing models",
    "text": "Building and Comparing models\nAn alternative model for the RIKZ species richness is:\n\nRIKZ_lm2 <- lm(Richness ~ NAP + factor(week), data = RIKZ)\n#Can also create this model using the `update()` function:  \nRIKZ_lm2 <- update(RIKZ_lm1, .~. + factor(week))\n\nCompare models with AIC() and via anova()\n\nanova(RIKZ_lm1, RIKZ_lm2)\nAnalysis of Variance Table\n\nModel 1: Richness ~ NAP\nModel 2: Richness ~ NAP + factor(week)\n  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    \n1     43 744.12                                  \n2     40 357.00  3    387.11 14.458 1.581e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "labs/lab-03.html#lab-exercise-23",
    "href": "labs/lab-03.html#lab-exercise-23",
    "title": "Bio Stats II : Lab 3",
    "section": "Lab exercise 2/3",
    "text": "Lab exercise 2/3\n\nExtract the residuals from the RIKZ_lm2 model\n\nAre the linear regression assumptions met? Explain your reasoning\n\nSummarize the results of the model. What are the parameter estimates telling you about species richness on these beaches?"
  },
  {
    "objectID": "labs/lab-03.html#model-predictions-for-new-data",
    "href": "labs/lab-03.html#model-predictions-for-new-data",
    "title": "Bio Stats II : Lab 3",
    "section": "Model predictions for new data",
    "text": "Model predictions for new data\nBoth augment() and the predict() function can be used to obtain predictions from a fitted model object to a new data frame.\nThis can be useful when:\n- a subset of the data was reserved from the fitting process (‘test data’)\n- you want to obtain model predictions at values other than the data\n(for example when plotting fitted values)\n\nnewdata <- RIKZ |>\n  slice(1:10) |>\n  mutate(NAP = NAP + 1)\nnew_predictions <- augment(RIKZ_lm1, newdata = newdata)"
  },
  {
    "objectID": "labs/lab-03.html#more-on-interrogating-model-results",
    "href": "labs/lab-03.html#more-on-interrogating-model-results",
    "title": "Bio Stats II : Lab 3",
    "section": "More on interrogating model results",
    "text": "More on interrogating model results\nYou can also interrogate model objects directly. Type names(object) to get a list of the components of object.\n\nnames(RIKZ_lm1)\n [1] \"coefficients\"  \"residuals\"     \"effects\"       \"rank\"         \n [5] \"fitted.values\" \"assign\"        \"qr\"            \"df.residual\"  \n [9] \"xlevels\"       \"call\"          \"terms\"         \"model\"        \n\nstr() can also be used."
  },
  {
    "objectID": "labs/lab-03.html#more-on-interrogating-model-results-1",
    "href": "labs/lab-03.html#more-on-interrogating-model-results-1",
    "title": "Bio Stats II : Lab 3",
    "section": "More on interrogating model results",
    "text": "More on interrogating model results\nNote that summary(object) is also a list, and components can be extracted from here too.\n\nnames(summary(RIKZ_lm1))\n [1] \"call\"          \"terms\"         \"residuals\"     \"coefficients\" \n [5] \"aliased\"       \"sigma\"         \"df\"            \"r.squared\"    \n [9] \"adj.r.squared\" \"fstatistic\"    \"cov.unscaled\" \nstr(summary(RIKZ_lm1))\nList of 11\n $ call         : language lm(formula = Richness ~ NAP, data = RIKZ)\n $ terms        :Classes 'terms', 'formula'  language Richness ~ NAP\n  .. ..- attr(*, \"variables\")= language list(Richness, NAP)\n  .. ..- attr(*, \"factors\")= int [1:2, 1] 0 1\n  .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. ..$ : chr [1:2] \"Richness\" \"NAP\"\n  .. .. .. ..$ : chr \"NAP\"\n  .. ..- attr(*, \"term.labels\")= chr \"NAP\"\n  .. ..- attr(*, \"order\")= int 1\n  .. ..- attr(*, \"intercept\")= int 1\n  .. ..- attr(*, \"response\")= int 1\n  .. ..- attr(*, \".Environment\")=<environment: R_GlobalEnv> \n  .. ..- attr(*, \"predvars\")= language list(Richness, NAP)\n  .. ..- attr(*, \"dataClasses\")= Named chr [1:2] \"numeric\" \"numeric\"\n  .. .. ..- attr(*, \"names\")= chr [1:2] \"Richness\" \"NAP\"\n $ residuals    : Named num [1:45] 4.443 0.344 2.484 6.08 1.353 ...\n  ..- attr(*, \"names\")= chr [1:45] \"1\" \"2\" \"3\" \"4\" ...\n $ coefficients : num [1:2, 1:4] 6.686 -2.867 0.658 0.631 10.164 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : chr [1:2] \"(Intercept)\" \"NAP\"\n  .. ..$ : chr [1:4] \"Estimate\" \"Std. Error\" \"t value\" \"Pr(>|t|)\"\n $ aliased      : Named logi [1:2] FALSE FALSE\n  ..- attr(*, \"names\")= chr [1:2] \"(Intercept)\" \"NAP\"\n $ sigma        : num 4.16\n $ df           : int [1:3] 2 43 2\n $ r.squared    : num 0.325\n $ adj.r.squared: num 0.309\n $ fstatistic   : Named num [1:3] 20.7 1 43\n  ..- attr(*, \"names\")= chr [1:3] \"value\" \"numdf\" \"dendf\"\n $ cov.unscaled : num [1:2, 1:2] 0.025 -0.00799 -0.00799 0.02299\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : chr [1:2] \"(Intercept)\" \"NAP\"\n  .. ..$ : chr [1:2] \"(Intercept)\" \"NAP\"\n - attr(*, \"class\")= chr \"summary.lm\""
  },
  {
    "objectID": "labs/lab-03.html#centering-covariates",
    "href": "labs/lab-03.html#centering-covariates",
    "title": "Bio Stats II : Lab 3",
    "section": "Centering covariates",
    "text": "Centering covariates\nWhen dealing with numeric covariates, it often makes sense to center these variables before performing a regression.\n- i.e. subtract the mean from each covariate.\nThis helps to make our parameters more meaningful.\n- they now correspond to the average case in the data, rather than some extrapolated value.\n- this is particularly useful for intercept parameters."
  },
  {
    "objectID": "labs/lab-03.html#fitting-multiple-models-simultaneously",
    "href": "labs/lab-03.html#fitting-multiple-models-simultaneously",
    "title": "Bio Stats II : Lab 3",
    "section": "Fitting multiple models simultaneously",
    "text": "Fitting multiple models simultaneously\nWe may be interested in fitting many (many) models.\nR has functionality to do this efficiently.\n\nlibrary(broom)\nggplot(gapminder, aes(x=year, y=lifeExp, group = country)) +\n  geom_line() + \n  facet_wrap(~continent)"
  },
  {
    "objectID": "labs/lab-03.html#fitting-multiple-models-simultaneously-1",
    "href": "labs/lab-03.html#fitting-multiple-models-simultaneously-1",
    "title": "Bio Stats II : Lab 3",
    "section": "Fitting multiple models simultaneously",
    "text": "Fitting multiple models simultaneously\n\ngapminder_models <- gapminder |>\n  group_by(country) |> \n  nest() |> \n  mutate(model = map(data, ~lm(lifeExp~year, data = .x))) |> \n  mutate(coefs = map(model, tidy, conf.int = TRUE)) |> \n  unnest(coefs)\n\n\n\nggplot(gapminder_models, aes(x = estimate, group = term)) +\n  geom_histogram(fill=\"black\",col=\"white\") +\n  facet_wrap(~term, scales= \"free\")\n\n\n\n\n\n\nslopes <- filter(gapminder_models, term == \"year\") %>% \n      arrange(desc(estimate))\ncontinents <- select(gapminder, country, continent) |>\n  distinct() \nslopes <- slopes |> left_join(continents)\nJoining, by = \"country\"\nggplot(slopes, aes(x = fct_reorder(country, estimate), y = estimate, group = term, col = continent)) +\n  #geom_histogram(fill=\"black\",col=\"white\") +\n  geom_point(alpha=0.5) +\n  geom_errorbar(aes(ymin=conf.low, ymax=conf.high), width=.05) +\n  coord_flip() +\n  labs(y = \"slope\", \n       x = \"Country\") +\n  theme_minimal()"
  },
  {
    "objectID": "labs/lab-03.html#lab-exercise-33",
    "href": "labs/lab-03.html#lab-exercise-33",
    "title": "Bio Stats II : Lab 3",
    "section": "Lab exercise 3/3",
    "text": "Lab exercise 3/3\n\n\n\nFit a linear regression using 2007 gapminder data of the form lm(gdpPercap ~ continent, where gdpPercap is the new outcome variable y. Get information about the best-fitting line from the regression table. How do the regression results match up with those of an analysis of life expectancy by continent?\n\nExtract the model coefficients and their 95 percent confidence intervals.\n\nPlot the residuals vs the fitted values and comment on their distribution and patterns.\n\nIdentify the five countries with the five most negative residuals? What do these negative residuals say about their life expectancy relative to their continents life expectancy?\n\nRepeat this process, but identify the five countries with the five most positive residuals. What do these positive residuals say about their life expectancy relative to their continents life expectancy?"
  },
  {
    "objectID": "labs/lab-exercise-03.html#r-laboratory-exercise-2",
    "href": "labs/lab-exercise-03.html#r-laboratory-exercise-2",
    "title": "MAR 536 - Spring 2023",
    "section": "R Laboratory Exercise 2",
    "text": "R Laboratory Exercise 2\nJanuary 25, 2023\nOpen a new R markdown file. Save it. (name it lastname_lab2.Rmd or something similar)\nAt the top of the script, add comments with your name and lab 2. Work in pairs or individually. Submit your Rmd and any other files via myCourses before lab next week."
  },
  {
    "objectID": "labs/lab-exercise-03.html#lab-exercise-13-laengelmavesi-penguins",
    "href": "labs/lab-exercise-03.html#lab-exercise-13-laengelmavesi-penguins",
    "title": "MAR 536 - Spring 2023",
    "section": "Lab exercise 1/3 (Laengelmavesi + penguins)",
    "text": "Lab exercise 1/3 (Laengelmavesi + penguins)\nRead in the data in the ‘data’ sheet of Laengelmavesi2.xlsx and:\n\nDisplay the number of observations for each species of fish. (hint: the function count() will tell you how many rows)\n\nFind the overall mean lengths, weights, and heights of fish in the data.\n\nFind the range of the lengths of Perch.\n\nCalculate the mean length for each species.\n\nbonus With the Pike data, create a new factor for small and large based on the weights.\n\nUse the ggpairs() function in library(GGally) to create a pairs plot for the palmer penguins data. What are five things you learn about the data and the penguins from this view of the data?"
  },
  {
    "objectID": "labs/lab-exercise-03.html#lab-exercise-23-gapminder-data",
    "href": "labs/lab-exercise-03.html#lab-exercise-23-gapminder-data",
    "title": "MAR 536 - Spring 2023",
    "section": "Lab exercise 2/3: Gapminder data",
    "text": "Lab exercise 2/3: Gapminder data\n\nUse the gapminder data to replicate as close as possible this graph. (Try out different ‘themes’ with + theme_XXXX())\n\n\n\n\n\n\n\nbonus plot time series of life expectancy by continent and country. (You can use geom_line() to link points)"
  },
  {
    "objectID": "labs/lab-exercise-03.html#lab-exercise-33-laengelmavesi-revisited",
    "href": "labs/lab-exercise-03.html#lab-exercise-33-laengelmavesi-revisited",
    "title": "MAR 536 - Spring 2023",
    "section": "Lab exercise 3/3 (Laengelmavesi revisited)",
    "text": "Lab exercise 3/3 (Laengelmavesi revisited)\nUse the data in Laengelmavesi2.xlsx to create the following graphs. Make sure to add axis labels and plot titles.\n\nCreate boxplots and histograms of the length distributions for each species.\n\nPlot all the weights vs the lengths. Include enough information that the data for each species can be identified.\n\nPlot the mean weight of each species as a function of the mean length, with the species names and mean heights also indicated on the plot.\n\nCreate one plot of the heights as a function of the lengths. Add a line separating fish with height greater than 20cm.\n\nbonus Add to your plot from step (2) the mean weight and length for each species."
  },
  {
    "objectID": "labs/lab-exercise-02.html#r-laboratory-exercise-2",
    "href": "labs/lab-exercise-02.html#r-laboratory-exercise-2",
    "title": "MAR 536 - Spring 2023",
    "section": "R Laboratory Exercise 2",
    "text": "R Laboratory Exercise 2\nJanuary 25, 2023\nOpen a new R markdown file. Save it. (name it lastname_lab2.Rmd or something similar)\nAt the top of the script, add comments with your name and lab 2. Work in pairs or individually. Submit your Rmd and any other files via myCourses before lab next week."
  },
  {
    "objectID": "labs/lab-exercise-02.html#lab-exercise-13-laengelmavesi-penguins",
    "href": "labs/lab-exercise-02.html#lab-exercise-13-laengelmavesi-penguins",
    "title": "MAR 536 - Spring 2023",
    "section": "Lab exercise 1/3 (Laengelmavesi + penguins)",
    "text": "Lab exercise 1/3 (Laengelmavesi + penguins)\nRead in the data in the ‘data’ sheet of Laengelmavesi2.xlsx and:\n\nDisplay the number of observations for each species of fish. (hint: the function count() will tell you how many rows)\n\nFind the overall mean lengths, weights, and heights of fish in the data.\n\nFind the range of the lengths of Perch.\n\nCalculate the mean length for each species.\n\nbonus With the Pike data, create a new factor for small and large based on the weights.\n\nUse the ggpairs() function in library(GGally) to create a pairs plot for the palmer penguins data. What are five things you learn about the data and the penguins from this view of the data?"
  },
  {
    "objectID": "labs/lab-exercise-02.html#lab-exercise-23-gapminder-data",
    "href": "labs/lab-exercise-02.html#lab-exercise-23-gapminder-data",
    "title": "MAR 536 - Spring 2023",
    "section": "Lab exercise 2/3: Gapminder data",
    "text": "Lab exercise 2/3: Gapminder data\n\nUse the gapminder data to replicate as close as possible this graph. (Try out different ‘themes’ with + theme_XXXX())\n\n\n\n\n\n\n\nbonus plot time series of life expectancy by continent and country. (You can use geom_line() to link points)"
  },
  {
    "objectID": "labs/lab-exercise-02.html#lab-exercise-33-laengelmavesi-revisited",
    "href": "labs/lab-exercise-02.html#lab-exercise-33-laengelmavesi-revisited",
    "title": "MAR 536 - Spring 2023",
    "section": "Lab exercise 3/3 (Laengelmavesi revisited)",
    "text": "Lab exercise 3/3 (Laengelmavesi revisited)\nUse the data in Laengelmavesi2.xlsx to create the following graphs. Make sure to add axis labels and plot titles.\n\nCreate boxplots and histograms of the length distributions for each species.\n\nPlot all the weights vs the lengths. Include enough information that the data for each species can be identified.\n\nPlot the mean weight of each species as a function of the mean length, with the species names and mean heights also indicated on the plot.\n\nCreate one plot of the heights as a function of the lengths. Add a line separating fish with height greater than 20cm.\n\nbonus Add to your plot from step (2) the mean weight and length for each species."
  },
  {
    "objectID": "labs/lec-06b.html",
    "href": "labs/lec-06b.html",
    "title": "poisson glm in R",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──\n\n\n✔ ggplot2 3.3.6      ✔ purrr   0.3.4 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.0      ✔ stringr 1.4.0 \n✔ readr   2.1.2      ✔ forcats 0.5.1 \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\nlibrary(broom)"
  },
  {
    "objectID": "labs/lec-06b.html#setup-1",
    "href": "labs/lec-06b.html#setup-1",
    "title": "poisson glm in R",
    "section": "setup",
    "text": "setup\n\n#first read in the data & create richness variable\nRIKZ <- read_table(file = \"../data/RIKZ.txt\")\n\n\n── Column specification ────────────────────────────────────────────────────────\ncols(\n  .default = col_double()\n)\nℹ Use `spec()` for the full column specifications.\n\nRIKZ <- RIKZ |> \n  mutate(Richness = rowSums(RIKZ[,2:76]>0)) |>\n  select(Richness, 77:89)"
  },
  {
    "objectID": "labs/lec-06b.html#generalized-linear-modeling",
    "href": "labs/lec-06b.html#generalized-linear-modeling",
    "title": "poisson glm in R",
    "section": "Generalized linear modeling",
    "text": "Generalized linear modeling\nRecall from lecture: \\[\\eta = \\beta_1 x_1 + \\beta_2 x_2 + \\dots + \\beta_p x_p\\] \\[f_Y(y;\\mu,\\varphi) = \\exp\\left[\\frac{A}{\\varphi}{y\\lambda(\\mu)-\\gamma(\\lambda(\\mu))}+\\tau(y,\\varphi)\\right]\\] \\[\\mu = m(\\eta) \\text{,    } \\eta = m^{-1}(\\mu)=l(\\mu)\\]\nThe combination of a response distribution, a link function and other information needed to carry out the modeling exercise is called the family of the generalized linear model."
  },
  {
    "objectID": "labs/lec-06b.html#the-glm-function",
    "href": "labs/lec-06b.html#the-glm-function",
    "title": "poisson glm in R",
    "section": "The glm() function",
    "text": "The glm() function\nThe R function to fit a generalized linear model is glm() which uses the form:\nfitted.model <- glm(formula, family=family.generator, data=data.frame)\nOnly new piece is the call to ‘family.generator’\nAlthough complex, its use is fairly simple.\nWhere there is a choice of link, link can be supplied with the family name as a parameter.\nSimple (inefficient) use: The following are equivalent.\n\nRIKZ_lm1 <- lm(Richness ~ NAP, data = RIKZ)\nRIKZ_glm1 <- glm(Richness ~ NAP, family = gaussian, \n                 data = RIKZ)\n\nMost of the extraction functions that can be applied to lm() can also be used with glm()."
  },
  {
    "objectID": "labs/lec-06b.html#the-glm-function-1",
    "href": "labs/lec-06b.html#the-glm-function-1",
    "title": "poisson glm in R",
    "section": "The glm() function",
    "text": "The glm() function\n\ntidy(RIKZ_lm1)\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)     6.69     0.658     10.2  5.25e-13\n2 NAP            -2.87     0.631     -4.55 4.42e- 5\ntidy(RIKZ_glm1)\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)     6.69     0.658     10.2  5.25e-13\n2 NAP            -2.87     0.631     -4.55 4.42e- 5"
  },
  {
    "objectID": "labs/lec-06b.html#poisson-regression",
    "href": "labs/lec-06b.html#poisson-regression",
    "title": "poisson glm in R",
    "section": "Poisson regression",
    "text": "Poisson regression\n\\[P(X=x) = \\frac{e^{-\\mu} \\mu^x}{x!} \\text{,   } \\mu_i = e^{\\alpha+\\beta_1 x_{1,i} + \\dots + \\beta_j x_{j,i}}\\]"
  },
  {
    "objectID": "labs/lec-06b.html#rikz-example",
    "href": "labs/lec-06b.html#rikz-example",
    "title": "poisson glm in R",
    "section": "RIKZ example",
    "text": "RIKZ example\n\n#fit the poisson regression model\nRIKZ_poisson <- glm(Richness ~ NAP, data = RIKZ, \n                    family = poisson)\n\nNote that the default link for the poisson is log so we don’t have to specify here (see ?family)."
  },
  {
    "objectID": "labs/lec-06b.html#summaryrikz_poisson",
    "href": "labs/lec-06b.html#summaryrikz_poisson",
    "title": "poisson glm in R",
    "section": "summary(RIKZ_poisson)",
    "text": "summary(RIKZ_poisson)\n\n\nCall:\nglm(formula = Richness ~ NAP, family = poisson, data = RIKZ)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.2029  -1.2432  -0.9199   0.3943   4.3256  \n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  1.79100    0.06329  28.297  < 2e-16 ***\nNAP         -0.55597    0.07163  -7.762 8.39e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 179.75  on 44  degrees of freedom\nResidual deviance: 113.18  on 43  degrees of freedom\nAIC: 259.18\n\nNumber of Fisher Scoring iterations: 5"
  },
  {
    "objectID": "labs/lec-06b.html#broomaugment",
    "href": "labs/lec-06b.html#broomaugment",
    "title": "poisson glm in R",
    "section": "broom::augment()",
    "text": "broom::augment()\nAs with lm(), the augment() function can be used to obtain the predictions from a fitted model object, and for a new data frame.\n\nnewobject <- augment(oldobject, newdata, \n                     type.predict = c(\"link\",\"response\",\"terms\"),\n                     se_fit = TRUE)\n\nNote: default for type.predict is on the scale of the linear predictors. Set to \"response\" to obtain predictions on the scale of the response variable."
  },
  {
    "objectID": "labs/lec-06b.html#observed-and-fitted-values-for-poisson-rikz",
    "href": "labs/lec-06b.html#observed-and-fitted-values-for-poisson-rikz",
    "title": "poisson glm in R",
    "section": "Observed and fitted values for Poisson RIKZ",
    "text": "Observed and fitted values for Poisson RIKZ\n\n#create new values for beach height\nnew_data <- tibble(NAP = seq(-1.5,2.5,length.out=100))\n#predict values for response based on new salinity\nRIKZ_pois_pred <- augment(RIKZ_poisson,\n                    newdata = new_data, \n                    type.predict = \"response\",\n                    se_fit = \"TRUE\")\n#plot\nggplot(RIKZ, aes(x=NAP, y= Richness)) +\n         geom_point() +\n         geom_line(data = RIKZ_pois_pred,\n                   aes(x=NAP, y = .fitted),\n                   col = \"blue\") +\n         labs(y = \"Richness\", x = \"NAP\") +\n         ylim(0,25) + xlim(-1.5,2.5)"
  },
  {
    "objectID": "labs/lec-06b.html#fitting-the-glm-in-the-ggplot-call",
    "href": "labs/lec-06b.html#fitting-the-glm-in-the-ggplot-call",
    "title": "poisson glm in R",
    "section": "fitting the GLM in the ggplot call",
    "text": "fitting the GLM in the ggplot call\n\nggplot(RIKZ,aes(NAP,Richness)) +\n  geom_point() +\n  geom_smooth(method = \"glm\", \n    method.args = list(family = poisson), se = TRUE)            \n`geom_smooth()` using formula 'y ~ x'"
  },
  {
    "objectID": "labs/lec-06b.html#quasi-poisson",
    "href": "labs/lec-06b.html#quasi-poisson",
    "title": "poisson glm in R",
    "section": "Quasi-Poisson",
    "text": "Quasi-Poisson\n\nRIKZ_quasip_1 <- glm(Richness ~ NAP, \n                     family = quasipoisson,\n                     data = RIKZ)\nsummary(RIKZ_quasip_1)\n\nCall:\nglm(formula = Richness ~ NAP, family = quasipoisson, data = RIKZ)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.2029  -1.2432  -0.9199   0.3943   4.3256  \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   1.7910     0.1104  16.218  < 2e-16 ***\nNAP          -0.5560     0.1250  -4.448 6.02e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for quasipoisson family taken to be 3.044178)\n\n    Null deviance: 179.75  on 44  degrees of freedom\nResidual deviance: 113.18  on 43  degrees of freedom\nAIC: NA\n\nNumber of Fisher Scoring iterations: 5"
  },
  {
    "objectID": "labs/lec-06b.html#full-poisson-model",
    "href": "labs/lec-06b.html#full-poisson-model",
    "title": "poisson glm in R",
    "section": "Full Poisson Model",
    "text": "Full Poisson Model\n\nRIKZ_pois_full <- glm(Richness ~ NAP + factor(week) +\n                      factor(exposure),\n                      data = RIKZ,\n                      family = poisson)\nsummary(RIKZ_pois_full)\n\nCall:\nglm(formula = Richness ~ NAP + factor(week) + factor(exposure), \n    family = poisson, data = RIKZ)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.8946  -0.4821  -0.2555   0.3425   2.6203  \n\nCoefficients:\n                   Estimate Std. Error z value Pr(>|z|)    \n(Intercept)         2.53136    0.12866  19.675   <2e-16 ***\nNAP                -0.48950    0.07449  -6.571    5e-11 ***\nfactor(week)2      -0.75723    0.35132  -2.155   0.0311 *  \nfactor(week)3      -0.50717    0.21148  -2.398   0.0165 *  \nfactor(week)4       0.12361    0.22617   0.547   0.5847    \nfactor(exposure)10 -0.42602    0.19022  -2.240   0.0251 *  \nfactor(exposure)11 -0.65481    0.33446  -1.958   0.0503 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 179.75  on 44  degrees of freedom\nResidual deviance:  47.80  on 38  degrees of freedom\nAIC: 203.8\n\nNumber of Fisher Scoring iterations: 5"
  },
  {
    "objectID": "labs/lec-06b.html#drop-exposure",
    "href": "labs/lec-06b.html#drop-exposure",
    "title": "poisson glm in R",
    "section": "Drop Exposure?",
    "text": "Drop Exposure?\n\ndrop1(RIKZ_pois_full, test = \"Chisq\")\nSingle term deletions\n\nModel:\nRichness ~ NAP + factor(week) + factor(exposure)\n                 Df Deviance    AIC    LRT  Pr(>Chi)    \n<none>                47.800 203.80                     \nNAP               1   93.460 247.46 45.660 1.407e-11 ***\nfactor(week)      3   58.372 208.37 10.572   0.01428 *  \nfactor(exposure)  2   53.466 205.46  5.666   0.05885 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "LICENSE.html#creative-commons-attribution-sharealike-4.0-international-public-license",
    "href": "LICENSE.html#creative-commons-attribution-sharealike-4.0-international-public-license",
    "title": "MAR 536 - Spring 2023",
    "section": "Creative Commons Attribution-ShareAlike 4.0 International Public License",
    "text": "Creative Commons Attribution-ShareAlike 4.0 International Public License\nBy exercising the Licensed Rights (defined below), You accept and agree to be bound by the terms and conditions of this Creative Commons Attribution-ShareAlike 4.0 International Public License (“Public License”). To the extent this Public License may be interpreted as a contract, You are granted the Licensed Rights in consideration of Your acceptance of these terms and conditions, and the Licensor grants You such rights in consideration of benefits the Licensor receives from making the Licensed Material available under these terms and conditions.\n\nSection 1 – Definitions.\n\nAdapted Material means material subject to Copyright and Similar Rights that is derived from or based upon the Licensed Material and in which the Licensed Material is translated, altered, arranged, transformed, or otherwise modified in a manner requiring permission under the Copyright and Similar Rights held by the Licensor. For purposes of this Public License, where the Licensed Material is a musical work, performance, or sound recording, Adapted Material is always produced where the Licensed Material is synched in timed relation with a moving image.\nAdapter’s License means the license You apply to Your Copyright and Similar Rights in Your contributions to Adapted Material in accordance with the terms and conditions of this Public License.\nBY-SA Compatible License means a license listed at creativecommons.org/compatiblelicenses, approved by Creative Commons as essentially the equivalent of this Public License.\nCopyright and Similar Rights means copyright and/or similar rights closely related to copyright including, without limitation, performance, broadcast, sound recording, and Sui Generis Database Rights, without regard to how the rights are labeled or categorized. For purposes of this Public License, the rights specified in Section 2(b)(1)-(2) are not Copyright and Similar Rights.\nEffective Technological Measures means those measures that, in the absence of proper authority, may not be circumvented under laws fulfilling obligations under Article 11 of the WIPO Copyright Treaty adopted on December 20, 1996, and/or similar international agreements.\nExceptions and Limitations means fair use, fair dealing, and/or any other exception or limitation to Copyright and Similar Rights that applies to Your use of the Licensed Material.\nLicense Elements means the license attributes listed in the name of a Creative Commons Public License. The License Elements of this Public License are Attribution and ShareAlike.\nLicensed Material means the artistic or literary work, database, or other material to which the Licensor applied this Public License.\nLicensed Rights means the rights granted to You subject to the terms and conditions of this Public License, which are limited to all Copyright and Similar Rights that apply to Your use of the Licensed Material and that the Licensor has authority to license.\nLicensor means the individual(s) or entity(ies) granting rights under this Public License.\nShare means to provide material to the public by any means or process that requires permission under the Licensed Rights, such as reproduction, public display, public performance, distribution, dissemination, communication, or importation, and to make material available to the public including in ways that members of the public may access the material from a place and at a time individually chosen by them.\nSui Generis Database Rights means rights other than copyright resulting from Directive 96/9/EC of the European Parliament and of the Council of 11 March 1996 on the legal protection of databases, as amended and/or succeeded, as well as other essentially equivalent rights anywhere in the world.\nYou means the individual or entity exercising the Licensed Rights under this Public License. Your has a corresponding meaning.\n\n\n\nSection 2 – Scope.\n\nLicense grant.\n\nSubject to the terms and conditions of this Public License, the Licensor hereby grants You a worldwide, royalty-free, non-sublicensable, non-exclusive, irrevocable license to exercise the Licensed Rights in the Licensed Material to:\nA. reproduce and Share the Licensed Material, in whole or in part; and\nB. produce, reproduce, and Share Adapted Material.\nExceptions and Limitations. For the avoidance of doubt, where Exceptions and Limitations apply to Your use, this Public License does not apply, and You do not need to comply with its terms and conditions.\nTerm. The term of this Public License is specified in Section 6(a).\nMedia and formats; technical modifications allowed. The Licensor authorizes You to exercise the Licensed Rights in all media and formats whether now known or hereafter created, and to make technical modifications necessary to do so. The Licensor waives and/or agrees not to assert any right or authority to forbid You from making technical modifications necessary to exercise the Licensed Rights, including technical modifications necessary to circumvent Effective Technological Measures. For purposes of this Public License, simply making modifications authorized by this Section 2(a)(4) never produces Adapted Material.\nDownstream recipients.\nA. Offer from the Licensor – Licensed Material. Every recipient of the Licensed Material automatically receives an offer from the Licensor to exercise the Licensed Rights under the terms and conditions of this Public License.\nB. Additional offer from the Licensor – Adapted Material. Every recipient of Adapted Material from You automatically receives an offer from the Licensor to exercise the Licensed Rights in the Adapted Material under the conditions of the Adapter’s License You apply.\nC. No downstream restrictions. You may not offer or impose any additional or different terms or conditions on, or apply any Effective Technological Measures to, the Licensed Material if doing so restricts exercise of the Licensed Rights by any recipient of the Licensed Material.\nNo endorsement. Nothing in this Public License constitutes or may be construed as permission to assert or imply that You are, or that Your use of the Licensed Material is, connected with, or sponsored, endorsed, or granted official status by, the Licensor or others designated to receive attribution as provided in Section 3(a)(1)(A)(i).\n\nOther rights.\n\nMoral rights, such as the right of integrity, are not licensed under this Public License, nor are publicity, privacy, and/or other similar personality rights; however, to the extent possible, the Licensor waives and/or agrees not to assert any such rights held by the Licensor to the limited extent necessary to allow You to exercise the Licensed Rights, but not otherwise.\nPatent and trademark rights are not licensed under this Public License.\nTo the extent possible, the Licensor waives any right to collect royalties from You for the exercise of the Licensed Rights, whether directly or through a collecting society under any voluntary or waivable statutory or compulsory licensing scheme. In all other cases the Licensor expressly reserves any right to collect such royalties.\n\n\n\n\nSection 3 – License Conditions.\nYour exercise of the Licensed Rights is expressly made subject to the following conditions.\n\nAttribution.\n\nIf You Share the Licensed Material (including in modified form), You must:\nA. retain the following if it is supplied by the Licensor with the Licensed Material:\n\nidentification of the creator(s) of the Licensed Material and any others designated to receive attribution, in any reasonable manner requested by the Licensor (including by pseudonym if designated);\na copyright notice;\na notice that refers to this Public License;\na notice that refers to the disclaimer of warranties;\na URI or hyperlink to the Licensed Material to the extent reasonably practicable;\n\nB. indicate if You modified the Licensed Material and retain an indication of any previous modifications; and\nC. indicate the Licensed Material is licensed under this Public License, and include the text of, or the URI or hyperlink to, this Public License.\nYou may satisfy the conditions in Section 3(a)(1) in any reasonable manner based on the medium, means, and context in which You Share the Licensed Material. For example, it may be reasonable to satisfy the conditions by providing a URI or hyperlink to a resource that includes the required information.\nIf requested by the Licensor, You must remove any of the information required by Section 3(a)(1)(A) to the extent reasonably practicable.\n\nShareAlike.\n\nIn addition to the conditions in Section 3(a), if You Share Adapted Material You produce, the following conditions also apply.\n\nThe Adapter’s License You apply must be a Creative Commons license with the same License Elements, this version or later, or a BY-SA Compatible License.\nYou must include the text of, or the URI or hyperlink to, the Adapter’s License You apply. You may satisfy this condition in any reasonable manner based on the medium, means, and context in which You Share Adapted Material.\nYou may not offer or impose any additional or different terms or conditions on, or apply any Effective Technological Measures to, Adapted Material that restrict exercise of the rights granted under the Adapter’s License You apply.\n\n\n\nSection 4 – Sui Generis Database Rights.\nWhere the Licensed Rights include Sui Generis Database Rights that apply to Your use of the Licensed Material:\n\nfor the avoidance of doubt, Section 2(a)(1) grants You the right to extract, reuse, reproduce, and Share all or a substantial portion of the contents of the database;\nif You include all or a substantial portion of the database contents in a database in which You have Sui Generis Database Rights, then the database in which You have Sui Generis Database Rights (but not its individual contents) is Adapted Material, including for purposes of Section 3(b); and\nYou must comply with the conditions in Section 3(a) if You Share all or a substantial portion of the contents of the database.\n\nFor the avoidance of doubt, this Section 4 supplements and does not replace Your obligations under this Public License where the Licensed Rights include other Copyright and Similar Rights.\n\n\nSection 5 – Disclaimer of Warranties and Limitation of Liability.\n\nUnless otherwise separately undertaken by the Licensor, to the extent possible, the Licensor offers the Licensed Material as-is and as-available, and makes no representations or warranties of any kind concerning the Licensed Material, whether express, implied, statutory, or other. This includes, without limitation, warranties of title, merchantability, fitness for a particular purpose, non-infringement, absence of latent or other defects, accuracy, or the presence or absence of errors, whether or not known or discoverable. Where disclaimers of warranties are not allowed in full or in part, this disclaimer may not apply to You.\nTo the extent possible, in no event will the Licensor be liable to You on any legal theory (including, without limitation, negligence) or otherwise for any direct, special, indirect, incidental, consequential, punitive, exemplary, or other losses, costs, expenses, or damages arising out of this Public License or use of the Licensed Material, even if the Licensor has been advised of the possibility of such losses, costs, expenses, or damages. Where a limitation of liability is not allowed in full or in part, this limitation may not apply to You.\nThe disclaimer of warranties and limitation of liability provided above shall be interpreted in a manner that, to the extent possible, most closely approximates an absolute disclaimer and waiver of all liability.\n\n\n\nSection 6 – Term and Termination.\n\nThis Public License applies for the term of the Copyright and Similar Rights licensed here. However, if You fail to comply with this Public License, then Your rights under this Public License terminate automatically.\nWhere Your right to use the Licensed Material has terminated under Section 6(a), it reinstates:\n\nautomatically as of the date the violation is cured, provided it is cured within 30 days of Your discovery of the violation; or\nupon express reinstatement by the Licensor.\n\nFor the avoidance of doubt, this Section 6(b) does not affect any right the Licensor may have to seek remedies for Your violations of this Public License.\nFor the avoidance of doubt, the Licensor may also offer the Licensed Material under separate terms or conditions or stop distributing the Licensed Material at any time; however, doing so will not terminate this Public License.\nSections 1, 5, 6, 7, and 8 survive termination of this Public License.\n\n\n\nSection 7 – Other Terms and Conditions.\n\nThe Licensor shall not be bound by any additional or different terms or conditions communicated by You unless expressly agreed.\nAny arrangements, understandings, or agreements regarding the Licensed Material not stated herein are separate from and independent of the terms and conditions of this Public License.\n\n\n\nSection 8 – Interpretation.\n\nFor the avoidance of doubt, this Public License does not, and shall not be interpreted to, reduce, limit, restrict, or impose conditions on any use of the Licensed Material that could lawfully be made without permission under this Public License.\nTo the extent possible, if any provision of this Public License is deemed unenforceable, it shall be automatically reformed to the minimum extent necessary to make it enforceable. If the provision cannot be reformed, it shall be severed from this Public License without affecting the enforceability of the remaining terms and conditions.\nNo term or condition of this Public License will be waived and no failure to comply consented to unless expressly agreed to by the Licensor.\nNothing in this Public License constitutes or may be interpreted as a limitation upon, or waiver of, any privileges and immunities that apply to the Licensor or You, including from the legal processes of any jurisdiction or authority.\n\n\nCreative Commons is not a party to its public licenses. Notwithstanding, Creative Commons may elect to apply one of its public licenses to material it publishes and in those instances will be considered the “Licensor.” The text of the Creative Commons public licenses is dedicated to the public domain under the CC0 Public Domain Dedication. Except for the limited purpose of indicating that material is shared under a Creative Commons public license or as otherwise permitted by the Creative Commons policies published at creativecommons.org/policies, Creative Commons does not authorize the use of the trademark “Creative Commons” or any other trademark or logo of Creative Commons without its prior written consent including, without limitation, in connection with any unauthorized modifications to any of its public licenses or any other arrangements, understandings, or agreements concerning use of licensed material. For the avoidance of doubt, this paragraph does not form part of the public licenses.\nCreative Commons may be contacted at creativecommons.org."
  },
  {
    "objectID": "weeks/week-04.html",
    "href": "weeks/week-04.html",
    "title": "Week 4",
    "section": "",
    "text": "📖 Read Chapters 6.1 (Tue) & 6.2 (Thu) of Zuur et al. 2007."
  },
  {
    "objectID": "weeks/week-04.html#participate",
    "href": "weeks/week-04.html#participate",
    "title": "Week 4",
    "section": "Participate",
    "text": "Participate\n🖥️ Lecture 6 - Generalized Linear Models\n\nlecture 6b - R code\n\n⌨️ Lab 4 - Data wrangling & model summaries (just the exercise)\n\nlab4-data\n\n🖥️ Lecture 7 - GLMs II (logistic regression)"
  },
  {
    "objectID": "weeks/week-04.html#practice",
    "href": "weeks/week-04.html#practice",
    "title": "Week 4",
    "section": "Practice",
    "text": "Practice\nLab 4 exercise is due before lab on Wednesday Feb 15.\n\n\nBack to course schedule ⏎"
  },
  {
    "objectID": "weeks/week-05.html",
    "href": "weeks/week-05.html",
    "title": "Week 5",
    "section": "",
    "text": "📖 Tue: Read Chapter 5 of James et al. (Introduction to Statistical Learning with R)\n📖 Thu: Read Chapter 7 of James et al. (Introduction to Statistical Learning with R)"
  },
  {
    "objectID": "weeks/week-05.html#participate",
    "href": "weeks/week-05.html#participate",
    "title": "Week 5",
    "section": "Participate",
    "text": "Participate\n🖥️ Lecture 8 - Resampling\n⌨️ Lab 5 - Simulation (just the exercise)\n\nData sets for the lab can be found in the class-data folder.\n\n🖥️ Lecture 9 - Nonlinear models, splines"
  },
  {
    "objectID": "weeks/week-05.html#practice",
    "href": "weeks/week-05.html#practice",
    "title": "Week 5",
    "section": "Practice",
    "text": "Practice\nLab 5 exercise is due before lab on Wednesday Feb 22.\n\n\nBack to course schedule ⏎"
  },
  {
    "objectID": "weeks/week-02.html",
    "href": "weeks/week-02.html",
    "title": "Week 2",
    "section": "",
    "text": "📖 Read remaining parts of Chapters 1-4 of Zuur (Tue)\n📖 Read Chapter 5 of Zuur (Thu)"
  },
  {
    "objectID": "weeks/week-02.html#participate",
    "href": "weeks/week-02.html#participate",
    "title": "Week 2",
    "section": "Participate",
    "text": "Participate\n🖥️ Lecture 3 - Data exploration, checking\n\nPlot description practice (Acknowledgements: S. Stoudt)\n\n⌨️ Lab 2 - Data Visualization (just the exercise)\n\nlake Laengelmavesi fish data\n\n🖥️ Lecture 4 - Regression review\n\nNB: class canceled - watch the lecture recording. Link in your email."
  },
  {
    "objectID": "weeks/week-02.html#practice",
    "href": "weeks/week-02.html#practice",
    "title": "Week 2",
    "section": "Practice",
    "text": "Practice\nYour project topic ideas are due on Thursday Jan 26.\nLab 2 exercise is due before lab on Wednesday Feb 1.\n\n\nBack to course schedule ⏎"
  },
  {
    "objectID": "weeks/week-03.html",
    "href": "weeks/week-03.html",
    "title": "Week 3",
    "section": "",
    "text": "📖 Read Chapters 8 & 11 of “An introduction to R (Venables et al.)” (Tue)\n📖 Read Chapter 7 of Hilborn & Mangel 1997 (Thu)"
  },
  {
    "objectID": "weeks/week-03.html#participate",
    "href": "weeks/week-03.html#participate",
    "title": "Week 3",
    "section": "Participate",
    "text": "Participate\n⌨️ Lab 3 - Probability & Linear Modeling in R (just the exercise)\n\nspecies richness on beaches data (RIKZ.txt, Zuur Chapter 5, 27)\n\n🖥️ Tutorial - data exploration & catch rate model selection for cod (L McGinnis)\n🖥️ Lecture 5 - Likelihood"
  },
  {
    "objectID": "weeks/week-03.html#practice",
    "href": "weeks/week-03.html#practice",
    "title": "Week 3",
    "section": "Practice",
    "text": "Practice\nLab 3 exercise is due before lab on Wednesday Feb 8.\n\n\nBack to course schedule ⏎"
  },
  {
    "objectID": "weeks/week-01.html",
    "href": "weeks/week-01.html",
    "title": "Week 1",
    "section": "",
    "text": "📖 Read the syllabus\n📖 Read Chapter 1.1-1.2 of McElreath (Tue)\n📖 Read/reference Chapter 4 of Bolker 2008 (Thu)"
  },
  {
    "objectID": "weeks/week-01.html#participate",
    "href": "weeks/week-01.html#participate",
    "title": "Week 1",
    "section": "Participate",
    "text": "Participate\n🖥️ Lecture 1 -Introduction (📋 gapminder data)\n⌨️ Lab 1 -Intro to R (just the exercise)\n🖥️ Lecture 2 - Probability review\n\n\nBack to course schedule ⏎"
  },
  {
    "objectID": "course-overview.html",
    "href": "course-overview.html",
    "title": "MAR 536: Biological Statistics II",
    "section": "",
    "text": "Statistical analysis of ecological data. This course provides guided learning in advanced statistical analysis, as applied to ecological research and other fields of marine science. Advanced concepts in probability, statistical model building, hypothesis testing, inference, estimation and prediction, including analyses of example data sets and problems. Students will be required to learn and present topics to the class that are relevant to their graduate research and complete a class project. Course materials will be presented using the statistical programming language R; a computer lab focused on introductory and intermediate R programming will be held for the first half of the semester."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MAR 536: Biological Statistics II",
    "section": "",
    "text": "Click here to download a PDF copy of the syllabus.\n(last updated 2023-02-04)"
  },
  {
    "objectID": "index.html#course-schedule",
    "href": "index.html#course-schedule",
    "title": "MAR 536: Biological Statistics II",
    "section": "Course Schedule",
    "text": "Course Schedule\nThis page will contain an outline of the topics, content, and assignments for the semester. Note that this schedule will be updated as the semester progresses.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWeek\n\n\n\n\nDate\n\n\n\n\nTopic\n\n\n\n\nPrepare\n\n\n\n\nSlides\n\n\n\n\nAE\n\n\n\n\nLab\n\n\n\n\nHW\n\n\n\n\nExam\n\n\n\n\nProject\n\n\n\n\n\n\n\n\n1\n\n\n\n\nTue, Jan 17\n\n\n\n\nIntroduction\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Jan 18\n\n\n\n\nLab 1 -Intro to R/RStudio\n\n\n\n\n\n\n\n\n📋\n\n\n\n\n💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Jan 19\n\n\n\n\nProbability review\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\n\n\n\n\nTue, Jan 24\n\n\n\n\nData exploration, checking\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Jan 25\n\n\n\n\nDue: Lab 1\n\n\n\n\n\n\n\n\n\n\n\n\n✍️\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Jan 25\n\n\n\n\nLab 2 - Visualizing data\n\n\n\n\n\n\n\n\n📋\n\n\n\n\n💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Jan 26\n\n\n\n\nLinear regression review\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Jan 26\n\n\n\n\nDue: Project topic\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n📂\n\n\n\n\n\n\n3\n\n\n\n\nTue, Jan 31\n\n\n\n\nLab 3 - Probability & linear modeling\n\n\n\n\n\n\n\n\n📋\n\n\n\n\n💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Feb 01\n\n\n\n\nDue: Lab 2\n\n\n\n\n\n\n\n\n\n\n\n\n✍️\n\n\n\n\n\n\n\n\n\n\n\n\nWed,\n\n\nFeb 01\n\n\n\n\nLinear modeling application\n\n\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Feb 02\n\n\n\n\nLikelihood\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4\n\n\n\n\nTue, Feb 07\n\n\n\n\nGeneralized Linear Models\n\n\n\n\n📖\n\n\n\n\n🖥️ 💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Feb 08\n\n\n\n\nDue: Lab 3\n\n\n\n\n\n\n\n\n\n\n\n\n✍️\n\n\n\n\n\n\n\n\n\n\n\n\nWed,\n\n\nFeb 08\n\n\n\n\nLab 4 - Data wrangling & model summaries\n\n\n\n\n\n\n\n\n📋\n\n\n\n\n💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Feb 09\n\n\n\n\nGLMs II (logistic regression)\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Feb 09\n\n\n\n\nDue: Project description\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n📂\n\n\n\n\n\n\n5\n\n\n\n\nTue, Feb 14\n\n\n\n\nResampling methods, cross-validation\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Feb 15\n\n\n\n\nDue: Lab 4\n\n\n\n\n\n\n\n\n\n\n\n\n✍️\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Feb 15\n\n\n\n\nLab 5 - Simulation\n\n\n\n\n\n\n\n\n📋\n\n\n\n\n💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Feb 16\n\n\n\n\nNon-linear models, splines\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n6\n\n\n\n\nTue, Feb 21\n\n\n\n\nNo class - Monday schedule\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Feb 22\n\n\n\n\nDue: Lab 5\n\n\n\n\n\n\n\n\n\n\n\n\n✍️\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Feb 22\n\n\n\n\nLab 6 - Iteration\n\n\n\n\n\n\n\n\n📋\n\n\n\n\n💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Feb 23\n\n\n\n\nGAMs\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n7\n\n\n\n\nTue, Feb 28\n\n\n\n\nDue: Data Exploration Report\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n📂\n\n\n\n\n\n\n\n\nTue, Feb 28\n\n\n\n\nMatrix Algebra review\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTue, Feb 28\n\n\n\n\nMidterm distributed\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n✅\n\n\n\n\n\n\n\n\n\n\nWed, Mar 01\n\n\n\n\nDue: Lab 6\n\n\n\n\n\n\n\n\n\n\n\n\n✍️\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Mar 01\n\n\n\n\nLab 7 - Functions\n\n\n\n\n\n\n\n\n📋\n\n\n\n\n💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Mar 02\n\n\n\n\nPrincipal Components Analysis\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSPRING\n\n\n\n\nBREAK\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n8\n\n\n\n\nTue, Mar 14\n\n\n\n\nLinear mixed effects model\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Mar 15\n\n\n\n\nDue: Lab 7\n\n\n\n\n\n\n\n\n\n\n\n\n✍️\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Mar 15\n\n\n\n\nLab 8\n\n\n\n\n\n\n\n\n📋\n\n\n\n\n💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Mar 16\n\n\n\n\nMore mixed effects\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Mar 16\n\n\n\n\nDue: Midterm\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n✅\n\n\n\n\n\n\n\n\n9\n\n\n\n\nTue, Mar 21\n\n\n\n\nZero-inflated models\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Mar 22\n\n\n\n\nDue: Lab 8\n\n\n\n\n\n\n\n\n\n\n\n\n✍️\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Mar 22\n\n\n\n\nUMASS IMS SYMPOSIUM\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Mar 23\n\n\n\n\nSpatial GLMMs\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n10\n\n\n\n\nTue, Mar 28\n\n\n\n\nClassification / Linear Discriminant Analysis\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Mar 29\n\n\n\n\nLab 9\n\n\n\n\n\n\n\n\n📋\n\n\n\n\n💻\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Mar 30\n\n\n\n\nTrees\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n11\n\n\n\n\nTue, Apr 04\n\n\n\n\nOrdination methods\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Apr 05\n\n\n\n\nDue: Lab 9\n\n\n\n\n\n\n\n\n\n\n\n\n✍️\n\n\n\n\n\n\n\n\n\n\n\n\nWed, Apr 05\n\n\n\n\nCluster analysis\n\n\n\n\n📖\n\n\n\n\n🖥️\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThu, Apr 06\n\n\n\n\nStudent presentations\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n📂\n\n\n\n\n\n\n12\n\n\n\n\nTue, Apr 11\n\n\n\n\nStudent presentations\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n📂\n\n\n\n\n\n\n\n\nWed, Apr 12\n\n\n\n\nStudent presentations\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n📂\n\n\n\n\n\n\n\n\nThu, Apr 13\n\n\n\n\nCourse Review\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTue, Apr 25\n\n\n\n\nDue: Project Report\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n📂"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "1 + 1\n\n[1] 2"
  },
  {
    "objectID": "lectures/lec-02.html",
    "href": "lectures/lec-02.html",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "",
    "text": "1/17: Introduction, Statistical Rethinking\n1/18: Lab 1\n1/19: Probability review"
  },
  {
    "objectID": "lectures/lec-02.html#objectives",
    "href": "lectures/lec-02.html#objectives",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Objectives",
    "text": "Objectives\n\nReview probability laws\nReview definitions of expected value and variance of random variables\nPresent common probability distributions"
  },
  {
    "objectID": "lectures/lec-02.html#why-does-variability-matter",
    "href": "lectures/lec-02.html#why-does-variability-matter",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Why does variability matter?",
    "text": "Why does variability matter?\nVariability affects any ecological system.\nNoise affects ecological data in two ways:\n- measurement error\n- process noise\nMeasurement error is variability in our measurements.\n- leads to large confidence intervals and low power\nProcess noise (process error), variability in the system.\n- demographic stochasticity\n- environmental stochasticity\nWe are interested in understanding patterns in our data.\n- use probability to describe relationships between processes and data.\nOften assume that our data is generated by some stochastic process whose expected value is a function of covariates we are interested in."
  },
  {
    "objectID": "lectures/lec-02.html#basic-probability-theory",
    "href": "lectures/lec-02.html#basic-probability-theory",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Basic probability theory",
    "text": "Basic probability theory\nThe is the set of all possible outcomes that could occur.\ne.g. for a regular six-sided die \\[ s\\{1,2,3,4,5,6\\} \\]\nProbability of an event \\(A\\) is the frequency with which that event occurs.\ne.g. \\[ P(1) = 1/6 \\]"
  },
  {
    "objectID": "lectures/lec-02.html#laws-of-probability",
    "href": "lectures/lec-02.html#laws-of-probability",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Laws of Probability",
    "text": "Laws of Probability\n\nLaw of total probability\nThe probabilities of all possible outcomes of an observation or experiment add to 1.0 \\[P(\\mbox{heads})+P(\\mbox{tails})=1.0\\]\nProbability of \\(A\\) \\(B\\), or \\(P(A \\cup B)\\)\n\n\\[P(A \\cup B) = P(A) + P(B) - P(A \\cap B).\\]\nMutually exclusive vs. independent events\n\n\ntwo mutually exlusive events cannot be independent\nmutually exclusive \\(\\implies P(A \\cap B) = 0\\)\nindependence \\(\\implies P(A \\cap B) = P(A) \\cdot P(B) \\neq 0\\)"
  },
  {
    "objectID": "lectures/lec-02.html#laws-of-probability-1",
    "href": "lectures/lec-02.html#laws-of-probability-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Laws of Probability",
    "text": "Laws of Probability\n\nGeneral multiplication rule\n\n\\[P(A_1 \\cap A_2 \\cap \\dots \\cap A_n) = P(A_1) \\cdot P(A_2|A_1) \\cdot P(A_3|A_1,A_2) \\dots\\]\n\nConditional probability\n\n\\(P(A|B)\\), is the probability that \\(A\\) happens if we know or assume \\(B\\) happens.\n\\[P(A|B) = \\frac{P(A \\cap B)}{P(B)}\\]"
  },
  {
    "objectID": "lectures/lec-02.html#conditional-probability-leads-to-bayes-rule",
    "href": "lectures/lec-02.html#conditional-probability-leads-to-bayes-rule",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Conditional probability leads to Bayes’ rule",
    "text": "Conditional probability leads to Bayes’ rule\n\\[P(A|B) = \\frac{P(A \\cap B)}{P(B)}\\]\n\n\\[P(A \\cap B) = P(B \\cap A) = P(B|A) \\cdot P(A)\\]\n\\[P(A|B) = \\frac{P(B|A) \\cdot P(A)}{P(B)}\\]\nThis is mostly termed with \\(A\\) being the model (hypothesis) and \\(B\\) being the data.\ni.e. what is the probability of a hypothesis given the data.\n\\[P(H|D) = \\frac{P(D|H) \\cdot P(H)}{P(D)}\\]\nwith \\(P(D) = \\sum{P(D|H) \\cdot P(H)}\\)"
  },
  {
    "objectID": "lectures/lec-02.html#random-variables",
    "href": "lectures/lec-02.html#random-variables",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Random Variables",
    "text": "Random Variables\nA random variable is a numerical valued function defined over a sample space.\nThe probability distribution describes how the frequency of occurrence varies across the sample space.\nFor discrete variables, characterized by \\(f(x)\\),\n- the probability distribution function (discrete variables) \\[f(x) = Prob(X=x)\\]\n(for continuous variables, \\(f(x)\\) is the probability density function)\nBoth types of variables are also described by the cumulative distribution function, \\(F(x)\\)\n\n\\[F(x) = P(X \\le x)\\]"
  },
  {
    "objectID": "lectures/lec-02.html#expected-value-of-random-variable-x",
    "href": "lectures/lec-02.html#expected-value-of-random-variable-x",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Expected Value of Random Variable \\(X\\)",
    "text": "Expected Value of Random Variable \\(X\\)\nDiscrete random variables \\[\\mu = E(X) = \\displaystyle\\sum_{i=0}^{\\infty} x_i P(X=x_i)\\]\nContinuous random variables \\[\\mu = E(X) = \\int_{-\\infty}^{\\infty} x f(x) dx\\]"
  },
  {
    "objectID": "lectures/lec-02.html#variance-of-a-random-variable-x-ex-mu2",
    "href": "lectures/lec-02.html#variance-of-a-random-variable-x-ex-mu2",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Variance of a Random Variable \\(X\\), \\(E[(X-\\mu)^2]\\)",
    "text": "Variance of a Random Variable \\(X\\), \\(E[(X-\\mu)^2]\\)\nDiscrete random variables \\[Var(X) = \\displaystyle\\sum_{i=0}^{\\infty}\\left(x_i-E(x_i)\\right)^2 P(X=x_i)\\] Continuous random variables \\[Var(X) = \\int_{-\\infty}^{\\infty} (x_i-E(x_i))^2f(x)dx\\]\nIn general \\[Var(X) = E(X^2) - (E(X))^2 = E((X-\\mu)^2)\\]\nVariances are additive.\n\n\\[Var(X\\pm Y) = Var(X) + Var(Y) \\pm 2Cov(X,Y)\\]\nThe standard deviation of a distribution is \\(\\sqrt{Var}\\)\nThe coefficient of variation (CV) is \\(\\sqrt{Var}/\\mu\\)"
  },
  {
    "objectID": "lectures/lec-02.html#summary-of-probability-distributions",
    "href": "lectures/lec-02.html#summary-of-probability-distributions",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Summary of probability distributions",
    "text": "Summary of probability distributions"
  },
  {
    "objectID": "lectures/lec-02.html#binomial",
    "href": "lectures/lec-02.html#binomial",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Binomial",
    "text": "Binomial\nDescribes the number of successes from a fixed number of trials.\nTwo possible outcomes on each trial, success or failure.\nProbability of success is the same in each trial.\nRange: discrete, \\(0 \\le x \\le N\\)\nDistribution: \\[\\binom{N}{x} p^x (1-p)^{N-x}\\]\nR: dbinom pbinom qbinom rbinom\nParameters:\n- \\(p\\) [real, 0-1], probability of success [prob]\n- \\(N\\) [positive integer], number of trials [size]\nMean: \\(Np\\)\nVariance: \\(Np(1-p)\\)\nCV: \\(sqrt{(1-p)/(Np)}\\)\nConjugate prior: Beta"
  },
  {
    "objectID": "lectures/lec-02.html#binomial-1",
    "href": "lectures/lec-02.html#binomial-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Binomial",
    "text": "Binomial"
  },
  {
    "objectID": "lectures/lec-02.html#multinomial",
    "href": "lectures/lec-02.html#multinomial",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Multinomial",
    "text": "Multinomial\nExtension of binomial trials to three or more possible outcomes.\n\\(X = (X_1,X_2,\\dots,X_k)\\)\nRange: discrete, \\(0 \\le x_i \\le N\\)\nDistribution: \\[P(X_1=x_1,X_2=x_2,\\dots,X_k=x_k) = \\binom{N}{x_1,x_2,\\dots,x_k} \\displaystyle\\prod_{i=1}^{k} p_{i}^{x_i}\\]\nR: dbinom pbinom qbinom rbinom\nParameters:\n- \\(p_i\\) [real, 0-1], \\(\\displaystyle\\sum_{i=1}^{k}p_i=1\\)\n- \\(N\\) [positive integer], number of samples\n\\(E(X_i)=Np_i\\)\n\\(Var(X_i)=Np_i(1-p_i)\\)\n\\(Cov(X_i,X_j) = -Np_ip_j\\) , \\(i \\ne j\\)"
  },
  {
    "objectID": "lectures/lec-02.html#poisson",
    "href": "lectures/lec-02.html#poisson",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Poisson",
    "text": "Poisson\nDescribes events which occur randomly and independently in time.\nLimit of a binomial distribution in which:\n\\(N \\to \\infty, p \\to 0\\) while \\(Np=\\mu\\) is fixed.\nDistribution of “rare events” (i.e., \\(p \\to 0\\)).\nRange: discrete (\\(0 \\le x\\))\nDistribution: \\[\\frac{e^{-\\lambda} \\lambda^n}{n!} \\textbf{or} \\frac{e^{-r t} (rt)^n}{n!}\\]\nR: dpois, ppois, qpois, rpois\nParameters: \\(\\lambda\\) (real, positive), expected number per sample [lambda] or \\(r\\) (real, positive), expected number per unit effort, area, time, etc. ()\nMean: \\(\\lambda\\) ( \\(rt\\))\nVariance: \\(\\lambda\\) ( \\(rt\\))\nCV : \\(1/\\sqrt{\\lambda}\\) ( \\(1/\\sqrt{rt}\\))\nConjugate prior: Gamma"
  },
  {
    "objectID": "lectures/lec-02.html#poisson-1",
    "href": "lectures/lec-02.html#poisson-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Poisson",
    "text": "Poisson"
  },
  {
    "objectID": "lectures/lec-02.html#negative-binomial",
    "href": "lectures/lec-02.html#negative-binomial",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Negative Binomial",
    "text": "Negative Binomial\nFor binomial trials, the number of failures before \\(n\\) successes.\nIn ecology, most often used because it is discrete like the Poisson but the variance can be greater than the mean (overdispersed).\nRange: discrete, \\(x \\ge 0\\)\nDistribution:\n\n\\[P(X=x) = \\frac{(n+x-1)!}{(n-1!) x!} p^n (1-p)^x\\] \\[\\textbf{or } \\frac{\\Gamma(k+x)}{\\Gamma(k) x!} (k/(k+\\mu))^k (\\mu/(k+\\mu))^x\\]\nParameters:\n\\(p\\) (\\(0<p<1\\)) probability per trial [prob]\n\\(\\mu\\) (real, positive) expected number of counts [mu]\n\\(n\\) (positive integer) number of successes awaited [size]\n\\(k\\) (real, positive), overdispersion parameter [size]\n(= shape parameter of underlying heterogeneity)"
  },
  {
    "objectID": "lectures/lec-02.html#negative-binomial-1",
    "href": "lectures/lec-02.html#negative-binomial-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Negative Binomial",
    "text": "Negative Binomial\nR: dnbinom, pnbinom, qnbinom, rnbinom\nMean: \\(\\mu=n(1-p)/p\\)\nVariance: \\(\\mu + \\mu^2/k= n(1-p)/p^2\\)\nCV: \\(\\sqrt{\\frac{(1+\\mu/k)}{\\mu}} = 1/\\sqrt{n(1-p)}\\)\nConjugate prior: No simple conjugate prior (Bradlow et al. 2002)\nTo use the ‘ecology’ parameterization in R you must name mu explicitly.\nThe negative binomial is also the result of a Poisson sampling process where \\(\\lambda\\) is Gamma-distributed."
  },
  {
    "objectID": "lectures/lec-02.html#negative-binomial-mu-2-all-cases",
    "href": "lectures/lec-02.html#negative-binomial-mu-2-all-cases",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Negative Binomial (\\(\\mu = 2\\) all cases)",
    "text": "Negative Binomial (\\(\\mu = 2\\) all cases)"
  },
  {
    "objectID": "lectures/lec-02.html#continuous-probability-distributions",
    "href": "lectures/lec-02.html#continuous-probability-distributions",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Continuous Probability Distributions",
    "text": "Continuous Probability Distributions"
  },
  {
    "objectID": "lectures/lec-02.html#uniform-distribution",
    "href": "lectures/lec-02.html#uniform-distribution",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Uniform distribution",
    "text": "Uniform distribution\nConstant probability across a range with limits \\(a\\) and \\(b\\)\nStandard uniform, \\(U(0,1)\\), frequently used as building block.\nRange: \\(a \\le x \\le b\\)\nDistribution: \\(1/(b-a)\\)\nR: dunif, punif, qunif, runif\nParameters: minimum (\\(a\\)) and maximum (\\(b\\)) limits (real)\n[min, max]\nMean: \\((a+b)/2\\)\nVariance: \\((b-a)^2/12\\)\nCV: \\((b-a)/((a+b) \\sqrt{3})\\)"
  },
  {
    "objectID": "lectures/lec-02.html#uniform-distribution-1",
    "href": "lectures/lec-02.html#uniform-distribution-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Uniform distribution",
    "text": "Uniform distribution"
  },
  {
    "objectID": "lectures/lec-02.html#normal-distribution",
    "href": "lectures/lec-02.html#normal-distribution",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Normal Distribution",
    "text": "Normal Distribution\nArises from adding things together.\nSum of a large number of independent samples from the same distribution is approximately normal.\nLimit of many distributions (binomial, Poisson, negative binomial, Gamma).\nRange: all real values\nDistribution: \\(\\frac{1}{\\sqrt{2 \\pi} \\sigma} \\exp\\left(-\\frac{(x-\\mu)^2}{2 \\sigma^2}\\right)\\)\nR: dnorm, pnorm, qnorm, rnorm\nParameters:\n- \\(\\mu\\) (real), mean [mean]\n- \\(\\sigma\\) (real, positive), standard deviation [sd]\nMean: \\(\\mu\\)\nVariance: \\(\\sigma^2\\)\nCV: \\(\\sigma/\\mu\\)\nConjugate prior: Normal (\\(\\mu\\)); Gamma (\\(1/\\sigma^2\\))"
  },
  {
    "objectID": "lectures/lec-02.html#normal-distribution-1",
    "href": "lectures/lec-02.html#normal-distribution-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Normal distribution",
    "text": "Normal distribution"
  },
  {
    "objectID": "lectures/lec-02.html#gamma",
    "href": "lectures/lec-02.html#gamma",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Gamma",
    "text": "Gamma\nDistribution of waiting times until a certain number of events occurs.\nContinuous counterpart to the negative binomial.\nGamma is very useful. Continuous positive variable with large variance and (possible) skew.\nRange: positive real values\nR: dgamma, pgamma, qgamma, rgamma\nDistribution: \\(\\frac{1}{s^a \\Gamma(a)} x^{a-1} e^{-x/s}\\)\nParameters:\n\\(s\\) (real, positive), scale: length per event [scale]\n\\(r\\) (real, positive), rate = \\(1/s\\); rate at which events occur [rate]\n\\(a\\) (real, positive), shape: number of events [shape]\nMean: \\(as\\) or \\(a/r\\)\nVariance: \\(as^2\\) or \\(a/r^2\\)\nCV: \\(1/\\sqrt{a}\\)"
  },
  {
    "objectID": "lectures/lec-02.html#gamma-1",
    "href": "lectures/lec-02.html#gamma-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Gamma",
    "text": "Gamma"
  },
  {
    "objectID": "lectures/lec-02.html#beta",
    "href": "lectures/lec-02.html#beta",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Beta",
    "text": "Beta\nContinuous distribution related to the binomial.\nDistribution of probability of success in a binomial trial with \\(a-1\\) successes and \\(b-1\\) failures.\nVery useful in modeling probabilities or proportions.\nRange: real, 0 to 1\nR: dbeta, pbeta, qbeta, rbeta\nDensity: s\\(\\frac{\\Gamma(a+b)}{\\Gamma(a)\\Gamma(b)} x^{a-1}(1-x)^{b-1}\\)\nParameters:\n- \\(a\\) (real, positive), shape 1: number of successes +1 [shape1]\n- \\(b\\) (real, positive), shape 2: number of failures +1 [shape2]\nMean: \\(a/(a+b)\\)\nMode: \\((a-1)/(a+b-2)\\)\nVariance: \\(ab/((a+b)^2)(a+b+1)\\)\nCV: \\(\\sqrt{(b/a)/(a+b+1)}\\)"
  },
  {
    "objectID": "lectures/lec-02.html#beta-1",
    "href": "lectures/lec-02.html#beta-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Beta",
    "text": "Beta"
  },
  {
    "objectID": "lectures/lec-02.html#lognormal",
    "href": "lectures/lec-02.html#lognormal",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Lognormal",
    "text": "Lognormal\nNot a continuous analogue or limit of some discrete distribution.\nJustification: as for normal, but for product of many iid variables.\nUsed in many situations where Gamma also fits, continuous, positive distribution with long tail or variance > mean.\nRange: positive real values\nR: dlnorm, plnorm, qlnorm, rlnorm\nDensity: \\(\\frac{1}{\\sqrt{2 \\pi} \\sigma x} e^{-(\\log x - \\mu)^2/(2 \\sigma^2)}\\)\nParameters:\n- \\(\\mu\\) (real): mean of the logarithm [meanlog]\n- \\(\\sigma\\) (real): standard deviation of the logarithm [sdlog]\nMean: \\(\\exp(\\mu+\\sigma^2/2)\\)\nVariance: \\(\\exp(2 \\mu + \\sigma^2) (\\exp(\\sigma^2)-1)\\)\nCV: \\(\\sqrt{\\exp(\\sigma^2)-1}\\) (\\(\\approx \\sigma\\) when \\(\\sigma<1/2\\))"
  },
  {
    "objectID": "lectures/lec-02.html#lognormal-1",
    "href": "lectures/lec-02.html#lognormal-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Lognormal",
    "text": "Lognormal"
  },
  {
    "objectID": "lectures/lec-02.html#relationships-among-distributions",
    "href": "lectures/lec-02.html#relationships-among-distributions",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Relationships among distributions",
    "text": "Relationships among distributions"
  },
  {
    "objectID": "lectures/lec-02.html#other-common-distributions",
    "href": "lectures/lec-02.html#other-common-distributions",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Other common distributions",
    "text": "Other common distributions\nDiscrete\n- Geometric (negative binomial with \\(k=1\\))\n- Beta-binomial (binomial but with \\(p\\) being beta distributed)\n- Hypergeometric (useful for sampling without replacement, finite population)\n- Multivariate hypergeometric (similar to the multinomial)\nContinuous\n- Exponential (distribution of waiting times for a single event)\n- Pareto (quantity whose log is exponentially distributed, power laws!)\n- Chi square (distribution of a sum of squared standard normals)\n- Student’s t (ratio of a standard normal and the square root of a scaled chi square)\n- F (ratio of two scaled chi-squares)\n- Dirichlet (generalization of beta, for a vector that must sum to 1)\n- Wishart (generalization of gamma, for a symmetric non-negative definite matrix)"
  },
  {
    "objectID": "lectures/lec-02.html#delta-method",
    "href": "lectures/lec-02.html#delta-method",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Delta Method",
    "text": "Delta Method\nCalculating expected values and variances of (nonlinear) functions of continuous (differentiable) random variables using Taylor series expansion."
  },
  {
    "objectID": "lectures/lec-02.html#delta-method-1",
    "href": "lectures/lec-02.html#delta-method-1",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Delta Method",
    "text": "Delta Method\nCalculating expected values and variances of (nonlinear) functions of continuous (differentiable) random variables using Taylor series expansion.\nLet \\(x_i\\) be a random variable with mean \\(\\mu_i(i=1,\\dots,n)\\). Given some function \\(g(x_1,x_2,\\dots,x_n)\\), say, \\(g\\binom{x}{\\sim}\\), then\n\n\\(E\\left(g\\binom{x}{\\sim}\\right) \\doteq g\\binom{\\mu}{\\sim} + \\frac{1}{2}\\displaystyle\\sum_{i=1}^{n}Var(X_i)\\left(\\frac{\\partial_{g}^{2}}{\\partial x_{i}^{2}}\\right)_{|\\mu}+\\displaystyle\\sum_{i<j}\\sum Cov(x_i,x_j)\\left(\\frac{\\partial_{g}^{2}}{\\partial x_{i} \\partial x_{j}}\\right)_{|\\mu}\\)\n\n\n\n\\(Var\\left(g\\binom{x}{\\sim}\\right) \\doteq \\displaystyle\\sum_{i=1}^{n}Var(x_i)\\left(\\frac{\\partial_{g}}{\\partial x_{i}}\\right)_{|\\mu}^{2}+ 2 \\displaystyle\\sum_{i<j}\\sum Cov(x_i,x_j)\\left(\\frac{\\partial g}{\\partial x_{i}}\\right)_{|\\mu} \\left(\\frac{\\partial g}{\\partial x_{j}}\\right)_{|\\mu}\\)\n\\(Cov\\left[g\\binom{x}{\\sim},h\\binom{x}{\\sim}\\right] = \\displaystyle\\sum_{i}\\sum_{j} Cov(x_i,x_j)\\left(\\frac{\\partial g}{\\partial x_{i}}\\right)_{|\\mu} \\left(\\frac{\\partial g}{\\partial x_{j}}\\right)_{|\\mu}\\)\n\n\\(|\\mu\\) denotes evaluation of derivative at the values of \\(\\mu\\)."
  },
  {
    "objectID": "lectures/lec-02.html#next-time",
    "href": "lectures/lec-02.html#next-time",
    "title": "Bio Stats II : Lecture 2, Probability",
    "section": "Next Time…",
    "text": "Next Time…\n1/24: Data exploration, checking\n1/25: Lab 2\n1/26: Linear regression review"
  },
  {
    "objectID": "lectures/lec-05.html",
    "href": "lectures/lec-05.html",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "",
    "text": "1/31: Lab 3, linear modeling\n2/01: linear models, cod catch rates\n2/02: Likelihood"
  },
  {
    "objectID": "lectures/lec-05.html#objectives",
    "href": "lectures/lec-05.html#objectives",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Objectives",
    "text": "Objectives\n\nRevisit probability\n\nPresent Likelihood\n\nStatistical inference based on maximum likelihood"
  },
  {
    "objectID": "lectures/lec-05.html#probability",
    "href": "lectures/lec-05.html#probability",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Probability",
    "text": "Probability\nPreviously: probability & common probability distributions\nDicsussed these in terms of PDFs, \\(f(x) = P(X=x)\\)\n\nProbability distribution function (discrete)\nProbability density function (continuous)\n\nPDFs are a function of parameters.\nWe are frequently interested in estimating the values for parameters."
  },
  {
    "objectID": "lectures/lec-05.html#example-poisson-lambda-3",
    "href": "lectures/lec-05.html#example-poisson-lambda-3",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Example: Poisson \\(\\lambda = 3\\)",
    "text": "Example: Poisson \\(\\lambda = 3\\)\n\\[P(X=x) = \\frac{e^{-\\lambda} \\lambda^x}{x!}\\]\n\n\n\n\n\nOften used for count data"
  },
  {
    "objectID": "lectures/lec-05.html#methods-of-estimation",
    "href": "lectures/lec-05.html#methods-of-estimation",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Methods of estimation",
    "text": "Methods of estimation\n\nMethod of Moments\nLeast Squares\nMaximum Likelihood\n\nOther techniques:\nminimum chi-square, minimum mean-square error estimators, finite sampling theory, and Bayes procedures.\nMethod of Moments: equate sample results with their expected values under a sampling model.\nExpected value(s) in turn is a function of the parameter(s) of interest in estimating."
  },
  {
    "objectID": "lectures/lec-05.html#likelihood-function",
    "href": "lectures/lec-05.html#likelihood-function",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Likelihood function",
    "text": "Likelihood function\nCommon problem:\nGiven some data, and a model of interest, find the one PDF among all the probability densities that the model prescribes, that is most likely to have produced the data.\ninverse problem\ni.e. Try to find values for parameters such that the model for \\(P(X)\\) yields numbers that are as close to the data as possible.\nWe choose parameter estimates to maximize the likelihood function.\nIn linear regression problem, least squares approach is a special case of maximum likelihood.\nMinimize distance between model and data.\ne.g. sum of squares in linear regression problem."
  },
  {
    "objectID": "lectures/lec-05.html#likelihood-function-1",
    "href": "lectures/lec-05.html#likelihood-function-1",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Likelihood function",
    "text": "Likelihood function\nDefine the likelihood function by reversing roles of data vector and the parameter vector.\n\\[\\mathcal{L}(\\boldsymbol{\\theta} ; \\bf{y}) = f(\\bf{y}|\\boldsymbol{\\theta}_i) \\]\nLikelihood functions is defined as the pdf of some given data over the alternative values for the parameters.\nSometimes referred to as: likelihood of a parameter given the data (because we know the data)."
  },
  {
    "objectID": "lectures/lec-05.html#example-likelihood-function-for-poisson",
    "href": "lectures/lec-05.html#example-likelihood-function-for-poisson",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Example: Likelihood function for poisson",
    "text": "Example: Likelihood function for poisson\nCounting river herring at Jenny Grist Mill, Plymouth MA.\nWe observe at the fish ladder for 1 hour and count 3 herring.\n\n(J.S. Conn)"
  },
  {
    "objectID": "lectures/lec-05.html#example-likelihood-function-for-poisson-1",
    "href": "lectures/lec-05.html#example-likelihood-function-for-poisson-1",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Example: Likelihood function for poisson",
    "text": "Example: Likelihood function for poisson\nTo define the likelihood function we evaluate \\(P(X=3|\\lambda)\\) for all values of \\(\\lambda\\)."
  },
  {
    "objectID": "lectures/lec-05.html#maximum-likelihood-estimation",
    "href": "lectures/lec-05.html#maximum-likelihood-estimation",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Maximum likelihood estimation",
    "text": "Maximum likelihood estimation\nWhat is the arrival rate of herring per hour?\nWe find the value of the parameter \\(\\lambda\\) that maximizes the likelihood function."
  },
  {
    "objectID": "lectures/lec-05.html#maximum-likelihood-estimation-1",
    "href": "lectures/lec-05.html#maximum-likelihood-estimation-1",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Maximum likelihood estimation",
    "text": "Maximum likelihood estimation\nMaximum of a function \\(f(x)\\)?\n- 1st derivative is equal to 0\n- Function is convex around maximum (2nd derivative is negative)\nWe often work with the log-likelihood (\\(\\mathrm{ln}\\mathcal{L}\\)).\nProcedure:\n- Differentiate log-likelihood with respect to the parameters,\n- Set 1st derivative equal to zero,\n- Solve for the parameters to find the MLEs."
  },
  {
    "objectID": "lectures/lec-05.html#maximum-likelihood-estimation-poisson",
    "href": "lectures/lec-05.html#maximum-likelihood-estimation-poisson",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Maximum likelihood estimation: Poisson",
    "text": "Maximum likelihood estimation: Poisson\n\\(\\mathcal{L}(\\lambda ; y) = \\frac{\\mathrm{e}^{-\\lambda} \\lambda^y}{y!}\\)\n\\(\\mathrm{ln}(\\mathcal{L}(\\lambda ; y)) =\\)\n\\(\\frac{\\mathrm{dln}\\mathcal{L}}{\\mathrm{d}\\lambda} =\\)"
  },
  {
    "objectID": "lectures/lec-05.html#maximum-likelihood-estimation-poisson-1",
    "href": "lectures/lec-05.html#maximum-likelihood-estimation-poisson-1",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Maximum likelihood estimation: Poisson",
    "text": "Maximum likelihood estimation: Poisson\n\\(\\mathcal{L}(\\lambda ; y) = \\frac{\\mathrm{e}^{-\\lambda} \\lambda^y}{y!}\\)\n\\(\\mathrm{ln}(\\mathcal{L}(\\lambda ; y)) = -\\lambda + y \\mathrm{ln}\\lambda - \\mathrm{ln}(y!)\\)\n\\(\\frac{\\mathrm{dln}\\mathcal{L}}{\\mathrm{d}\\lambda} =\\)"
  },
  {
    "objectID": "lectures/lec-05.html#maximum-likelihood-estimation-poisson-2",
    "href": "lectures/lec-05.html#maximum-likelihood-estimation-poisson-2",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Maximum likelihood estimation: Poisson",
    "text": "Maximum likelihood estimation: Poisson\n\\(\\mathcal{L}(\\lambda ; y) = \\frac{\\mathrm{e}^{-\\lambda} \\lambda^y}{y!}\\)\n\\(\\mathrm{ln}(\\mathcal{L}(\\lambda ; y)) = -\\lambda + y \\mathrm{ln}\\lambda - \\mathrm{ln}(y!)\\)\n\\(\\frac{\\mathrm{dln}\\mathcal{L}}{\\mathrm{d}\\lambda} = -1 + \\frac{y}{\\lambda}\\)"
  },
  {
    "objectID": "lectures/lec-05.html#maximum-likelihood-estimation-2",
    "href": "lectures/lec-05.html#maximum-likelihood-estimation-2",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Maximum likelihood estimation",
    "text": "Maximum likelihood estimation\nOur example for poisson:\nSet \\(\\frac{\\mathrm{dln}\\mathcal{L}}{\\mathrm{d}\\lambda} = 0\\), and solve for \\(\\lambda\\) with \\(y=3\\).\n\\(0 = -1 + \\frac{y}{\\lambda}\\)\nMLE for \\(\\lambda = 3\\)"
  },
  {
    "objectID": "lectures/lec-05.html#maximum-likelihood-estimation-3",
    "href": "lectures/lec-05.html#maximum-likelihood-estimation-3",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Maximum likelihood estimation",
    "text": "Maximum likelihood estimation\nOur example for poisson:\nSet \\(\\frac{\\mathrm{dln}\\mathcal{L}}{\\mathrm{d}\\lambda} = 0\\), and solve for \\(\\lambda\\) with \\(y=3\\).\nMLE for \\(\\lambda = 3\\).\nSay we had \\(n\\) independent hourly observations of herring arrival:\nRecall for independent events:\n\\[P(A_1 \\cap A_2 \\cap \\dots \\cap A_n) = P(A_1) \\cdot P(A_2) \\cdot P(A_3) \\dots\\]\n\\[\\mathcal{L}(\\lambda ; \\bold{y}) = \\displaystyle\\prod_{i=1}^{n}\\frac{\\mathrm{e}^{-\\lambda} \\lambda^{y_i}}{y_i!}\\]\n\\[\\mathrm{ln}(\\mathcal{L}(\\lambda ; \\bold{y})) = - n \\lambda + \\mathrm{ln}\\lambda \\sum_{i=1}^{n} y  - \\sum_{i=1}^{n} \\mathrm{ln}(y!)\\]"
  },
  {
    "objectID": "lectures/lec-05.html#maximum-likelihood-estimation-4",
    "href": "lectures/lec-05.html#maximum-likelihood-estimation-4",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Maximum likelihood estimation",
    "text": "Maximum likelihood estimation\nPrinciple developed by R.A. Fisher (1920s)\nMLE estimates need not exist nor be unique.\nThe likelihood equation represents a necessary condition for the existence of an MLE estimate.\nNot usually possible to obtain analytic form solutions for the MLE estimates.\nParticularly when the model involves many parameters and PDF is highly non-linear.\nIn which case:\nMLE estimate sought numerically using nonlinear optimization algorithms."
  },
  {
    "objectID": "lectures/lec-05.html#estimating-variance-for-your-parameters",
    "href": "lectures/lec-05.html#estimating-variance-for-your-parameters",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Estimating variance for your parameters",
    "text": "Estimating variance for your parameters\nFisher showed that the negative inverse of the 2nd partial derivative of the log-likelihood function (the negative inverse of the Hessian), evaluated at the MLE, is the MLE of the variance of the parameter.\n\\[Var(\\hat{\\theta}) =  \\left[ - \\left( \\frac{\\partial^2\\mathrm{ln}L(\\theta;\\bold{y})}{\\partial\\theta^2}\\right)\\right]_{\\theta=\\hat{\\theta}}^{-1}\\]\nReturning to our herring example with 1 observation of 3 fish in an hour:\n\\[Var(\\hat{\\lambda}) =  \\left[ - \\left( \\frac{-y}{\\lambda^2}\\right)\\right]_{\\lambda=\\hat{\\lambda}}^{-1} = \\left[ - \\left( \\frac{-3}{3^2}\\right)\\right]^{-1} = 3\\]\nSo with only 1 observation, our variance is pretty high.\n(indeed, the same as the variance of the Poisson process!)"
  },
  {
    "objectID": "lectures/lec-05.html#relationship-to-least-squares-estimation",
    "href": "lectures/lec-05.html#relationship-to-least-squares-estimation",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Relationship to least squares estimation",
    "text": "Relationship to least squares estimation\nLeast squares assumptions:\n\n\\(y_i\\)’s are pair-wise uncorrelated\nvariance constant, \\(\\sigma^2\\)\nExpected value of \\(y_i\\), \\(E[y_i] = \\beta_0 + \\beta_1 x_i\\)\n\nNo statistical or distributional assumptions required for parameter estimates.\nMaximum Likelihood technique of least squares assumptions:\n\n\\(y_i\\)’s follow the model \\(y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i\\)\n\\(\\epsilon_i \\sim N(0,\\sigma^2)\\)\n\\(\\sigma^2\\) known or unknown parameter"
  },
  {
    "objectID": "lectures/lec-05.html#regression-example-normal-likelihood",
    "href": "lectures/lec-05.html#regression-example-normal-likelihood",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Regression example, normal Likelihood",
    "text": "Regression example, normal Likelihood\n\\[\n\\begin{aligned}\n\\mathcal{L}(\\bf{y}|\\beta_0,\\beta_1,\\sigma^2,\\bf{x}) &= \\displaystyle\\prod_{i=1}^{n}\\frac{1}{\\sqrt{2 \\pi} \\sigma} \\mathrm{e}^{-\\frac{1}{2 \\sigma^2}(y_i-(\\beta_0+\\beta_1 x_i))^2} \\\\\n&= \\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma}\\right)^n \\mathrm{e}^{-\\frac{1}{2 \\sigma^2}\\displaystyle\\sum_{i=1}^{n}(y_i-(\\beta_0+\\beta_1 x_i))^2}\n\\end{aligned}\n\\]\n\\[\\mathrm{ln}\\mathcal{L} = n \\mathrm{ln}\\left(\\frac{1}{\\sqrt{2 \\pi} \\sigma}\\right) -\\frac{1}{2 \\sigma^2}\\displaystyle\\sum_{i=1}^{n}(y_i-(\\beta_0+\\beta_1 x_i))^2 \\]\n\\[\\frac{\\mathrm{d ln}L}{\\mathrm{d\\beta_0}} = -\\frac{1}{\\sigma^2} \\displaystyle\\sum_{i=1}^{n}(y_i-(\\beta_0+\\beta_1 x_i))\\]\n\\[\\frac{\\mathrm{d ln}L}{\\mathrm{d\\beta_1}} = -\\frac{1}{\\sigma^2} \\displaystyle\\sum_{i=1}^{n}(y_i-(\\beta_0+\\beta_1 x_i))x_i\\]"
  },
  {
    "objectID": "lectures/lec-05.html#regression-example-normal-likelihood-1",
    "href": "lectures/lec-05.html#regression-example-normal-likelihood-1",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Regression example, normal Likelihood",
    "text": "Regression example, normal Likelihood\n\\[\\frac{\\mathrm{d ln}L}{\\mathrm{d\\beta_0}} = -\\frac{1}{\\sigma^2} \\displaystyle\\sum_{i=1}^{n}(y_i-(\\beta_0+\\beta_1 x_i))\\]\n\\[\\frac{\\mathrm{d ln}L}{\\mathrm{d\\beta_1}} = -\\frac{1}{\\sigma^2} \\displaystyle\\sum_{i=1}^{n}(y_i-(\\beta_0+\\beta_1 x_i))x_i\\]\nLet \\(\\bar{X}=\\sum{x_i}/n\\), \\(\\bar{Y}=\\sum{x_i}/n\\), \\(\\overline{X^2}=\\sum{x_i^2}/n\\), \\(\\overline{XY}=\\sum{x_i y_i}/n\\)\nThen\n\\(\\beta_0 + \\beta_1 \\bar{X} = \\bar{Y}\\) and \\(\\beta_0 \\bar{X} + \\beta_1 \\overline{X^2} = \\overline{XY}\\)\nSolving for \\(\\beta_1\\) & \\(\\beta_0\\) gives\n\\(\\beta_1 = \\frac{\\overline{XY} - \\bar{X}\\bar{Y}}{\\overline{X^2}-\\bar{X}^2}\\), and \\(\\beta_0 = \\bar{Y} - \\beta_1 \\bar{X}\\)\nwhich are the same as the least square estimates"
  },
  {
    "objectID": "lectures/lec-05.html#maximum-likelihood-and-statistical-testing",
    "href": "lectures/lec-05.html#maximum-likelihood-and-statistical-testing",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Maximum likelihood and statistical testing",
    "text": "Maximum likelihood and statistical testing\nSo far, we calculated the ‘best’ estimate for the parameters (MLEs).\nWe are often also interested in evidence for 1 hypothesis over another.\ni.e. to compare the fits of different models.\nFor nested models, the likelihood ratio gives the weight of evidence for one model over another.\nherring example: How less likely is it that we counted 3 fish when the mean arrival rate is 2?"
  },
  {
    "objectID": "lectures/lec-05.html#likelihood-ratios",
    "href": "lectures/lec-05.html#likelihood-ratios",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Likelihood ratios",
    "text": "Likelihood ratios\nHerring example: How less likely is it that we counted 3 fish when the mean arrival rate is 2?\n\\[\n\\begin{aligned}\n\\Lambda(x) &= \\frac{L(y|\\lambda=2)}{L(y|\\lambda=3)} \\\\\n&= \\frac{P(y=3|\\lambda=2)}{P(y=3|\\lambda=3)} \\\\\n&= \\frac{0.180}{0.224} = 0.805\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "lectures/lec-05.html#likelihood-ratios-1",
    "href": "lectures/lec-05.html#likelihood-ratios-1",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Likelihood ratios",
    "text": "Likelihood ratios\nStatistical testing\nWilks showed that as \\(n \\to \\infty\\), \\(-2 \\mathrm{ln}(\\Lambda)\\) is asymptotically chi-squared distributed (\\(\\chi^2\\)) with degrees of freedom equal to difference in dimensionality between the models.\n\\[\n\\begin{aligned}\n-2 \\mathrm{ln}(\\Lambda) &= -2 (\\mathrm{ln}L(y|\\lambda=2) - \\mathrm{ln}L(y|\\lambda=3)) \\\\\n&= -2 (\\mathrm{ln}(0.180)-\\mathrm{ln}(0.224)) \\\\\n&= 0.433\n\\end{aligned}\n\\]\nCritical value of \\(\\chi^2\\) with 1 d.f. at \\(\\alpha = 0.05\\) is 3.84\n\\(0.433 < 3.84\\) so we would not reject the hypothesis that the data were generated by a poisson with \\(\\lambda\\) of 2, even though it is less likely than the MLE of 3."
  },
  {
    "objectID": "lectures/lec-05.html#likelihood-profiles",
    "href": "lectures/lec-05.html#likelihood-profiles",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Likelihood profiles",
    "text": "Likelihood profiles\nWe can compute a 95% confidence interval for MLEs using the likelihood profile\nAn \\(100-x\\%\\) confidence interval for \\(p\\) parameters is determined by finding the values for the parameter(s) for which:\n\\[-(\\mathrm{ln}L - \\mathrm{ln}L_{MLE}) = \\frac{1}{2} \\chi^2(p,x/100)\\]\nwhere \\(\\mathrm{ln}L_{MLE}\\) is the log-likelihood corresponding to the maximum likelihood estimates.\nIf the number of parameters is \\(>1\\) then we profile the likelihood over a parameter using the MLEs for the other parameters given the profiled values for the parameter of interest.\ni.e. re-fit the model to the data for each of the profiled values for the parameter of interest.\n\n\n\n\n\n\nSignificant at 5% level when \\(-2\\mathrm{ln}\\Lambda > 3.84\\)\ni.e. 95% CI are values for the parameter where the nLL is 1.92 units from the MLE."
  },
  {
    "objectID": "lectures/lec-05.html#properties-of-maximum-likelihood-estimators",
    "href": "lectures/lec-05.html#properties-of-maximum-likelihood-estimators",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Properties of maximum likelihood estimators",
    "text": "Properties of maximum likelihood estimators\n\nFor the estimator of \\(\\theta\\), the\n\n\\[MLE \\sim N \\left( \\theta , \\frac{-1}{E\\left[\\frac{\\delta^2\\mathrm{ln}L}{\\delta\\theta^2}\\right]} \\right)\\]\n\nMLEs are solutions to the equations\n\n\\[\\frac{\\delta\\mathcal{L}(\\theta)}{\\delta\\theta} \\overset{set}{=} 0\\]\nwhich satisfy the relationship\n\\[\\frac{\\delta^2\\mathcal{L}(x|\\theta)}{\\delta^2\\theta} < 0\\]\n\n\nInvariance property of MLE.\nLet \\(\\hat{\\theta}\\) be the MLE of \\(\\theta\\), then the MLE of the function \\(\\tau(\\theta)\\) is \\(\\tau(\\hat{\\theta})\\).\nThe MLE of \\(\\theta\\) is asymptotically a Unique Minimum Variance Unbiased Estimator (UMVUE).\n(asymptotically efficient with minimum variances)\n\n\\[\\sigma_{\\hat{\\theta}}^2 = \\frac{1}{E\\left[\\left(\\frac{\\delta\\mathrm{ln}L}{\\delta\\theta}\\right)^2\\right]} = \\frac{-1}{E\\left[\\frac{\\delta^2\\mathrm{ln}L}{\\delta\\theta^2}\\right]}\\]"
  },
  {
    "objectID": "lectures/lec-05.html#next-time",
    "href": "lectures/lec-05.html#next-time",
    "title": "Bio Stats II : Lecture 5, Likelihood",
    "section": "Next Time…",
    "text": "Next Time…\n2/07: Extending the linear model (GLMs)\n2/08: Lab 4 (data wrangling, model summaries)\n2/09: GLMs 2 (Logistic regression)"
  },
  {
    "objectID": "lectures/lec-03.html#data-exploration-checking",
    "href": "lectures/lec-03.html#data-exploration-checking",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Data exploration, checking",
    "text": "Data exploration, checking\nAcknowledgements: Mine Çetinkaya-Rundel, Amanda Hart, Sara Stoudt"
  },
  {
    "objectID": "lectures/lec-03.html#chapter-4.-data-exploration",
    "href": "lectures/lec-03.html#chapter-4.-data-exploration",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Chapter 4. Data Exploration",
    "text": "Chapter 4. Data Exploration\n\nWhat’s in a data set?\nSummarizing & visualizing data\nOutliers, transformations, standardizations\nFinal thoughts"
  },
  {
    "objectID": "lectures/lec-03.html#dataset-terminology",
    "href": "lectures/lec-03.html#dataset-terminology",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Dataset terminology",
    "text": "Dataset terminology\n\nEach row is an observation\nEach column is a variable\n\n\nstarwars\n\n# A tibble: 87 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…\n 2 C-3PO       167    75 <NA>       gold       yellow         112   none  mascu…\n 3 R2-D2        96    32 <NA>       white, bl… red             33   none  mascu…\n 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…\n 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…\n 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…\n 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…\n 8 R5-D4        97    32 <NA>       white, red red             NA   none  mascu…\n 9 Biggs D…    183    84 black      light      brown           24   male  mascu…\n10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…\n# … with 77 more rows, and 5 more variables: homeworld <chr>, species <chr>,\n#   films <list>, vehicles <list>, starships <list>"
  },
  {
    "objectID": "lectures/lec-03.html#luke-skywalker",
    "href": "lectures/lec-03.html#luke-skywalker",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Luke Skywalker",
    "text": "Luke Skywalker"
  },
  {
    "objectID": "lectures/lec-03.html#whats-in-the-star-wars-data",
    "href": "lectures/lec-03.html#whats-in-the-star-wars-data",
    "title": "Biological Stats 2: Lecture 3",
    "section": "What’s in the Star Wars data?",
    "text": "What’s in the Star Wars data?\nTake a glimpse at the data:\n\nglimpse(starwars)\n\nRows: 87\nColumns: 14\n$ name       <chr> \"Luke Skywalker\", \"C-3PO\", \"R2-D2\", \"Darth Vader\", \"Leia Or…\n$ height     <int> 172, 167, 96, 202, 150, 178, 165, 97, 183, 182, 188, 180, 2…\n$ mass       <dbl> 77.0, 75.0, 32.0, 136.0, 49.0, 120.0, 75.0, 32.0, 84.0, 77.…\n$ hair_color <chr> \"blond\", NA, NA, \"none\", \"brown\", \"brown, grey\", \"brown\", N…\n$ skin_color <chr> \"fair\", \"gold\", \"white, blue\", \"white\", \"light\", \"light\", \"…\n$ eye_color  <chr> \"blue\", \"yellow\", \"red\", \"yellow\", \"brown\", \"blue\", \"blue\",…\n$ birth_year <dbl> 19.0, 112.0, 33.0, 41.9, 19.0, 52.0, 47.0, NA, 24.0, 57.0, …\n$ sex        <chr> \"male\", \"none\", \"none\", \"male\", \"female\", \"male\", \"female\",…\n$ gender     <chr> \"masculine\", \"masculine\", \"masculine\", \"masculine\", \"femini…\n$ homeworld  <chr> \"Tatooine\", \"Tatooine\", \"Naboo\", \"Tatooine\", \"Alderaan\", \"T…\n$ species    <chr> \"Human\", \"Droid\", \"Droid\", \"Human\", \"Human\", \"Human\", \"Huma…\n$ films      <list> <\"The Empire Strikes Back\", \"Revenge of the Sith\", \"Return…\n$ vehicles   <list> <\"Snowspeeder\", \"Imperial Speeder Bike\">, <>, <>, <>, \"Imp…\n$ starships  <list> <\"X-wing\", \"Imperial shuttle\">, <>, <>, \"TIE Advanced x1\",…"
  },
  {
    "objectID": "lectures/lec-03.html#what-is-eda",
    "href": "lectures/lec-03.html#what-is-eda",
    "title": "Biological Stats 2: Lecture 3",
    "section": "What is EDA?",
    "text": "What is EDA?\n\nExploratory data analysis (EDA) is an approach to analysing data sets to summarize its main characteristics\nOften, this is visual – this is what we’ll focus on first\nBut we might also calculate summary statistics and perform data wrangling/manipulation/transformation at (or before) this stage of the analysis"
  },
  {
    "objectID": "lectures/lec-03.html#mass-vs.-height",
    "href": "lectures/lec-03.html#mass-vs.-height",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Mass vs. height",
    "text": "Mass vs. height\nHow would you describe the relationship between mass and height of Starwars characters? What other variables would help us understand data points that don’t follow the overall trend? Who is the not so tall but chonky character?"
  },
  {
    "objectID": "lectures/lec-03.html#jabba",
    "href": "lectures/lec-03.html#jabba",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Jabba!",
    "text": "Jabba!\n\n\nquartz_off_screen \n                2"
  },
  {
    "objectID": "lectures/lec-03.html#basic-questions",
    "href": "lectures/lec-03.html#basic-questions",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Basic questions",
    "text": "Basic questions\n\nWhere are the data centered?\nHow are they spread? Are they symmetric, skewed, multimodal?\nAre there outliers?\nHow are the data distributed?\nAre there relationships among variables? Are relationships linear? Which analyses should be applied?\nAre transformations needed?\nWas the sampling effort approximately the same for each observation or variable?\n\nExpecting >20% of your research time (often more) exploring your data makes analysis easier and more efficient."
  },
  {
    "objectID": "lectures/lec-03.html#always-plot-your-data",
    "href": "lectures/lec-03.html#always-plot-your-data",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Always plot your data!",
    "text": "Always plot your data!\n\nVisualizing your data is key to performing statistical analyses.\n‘Standard’ summaries of data may not reveal patterns.\nYou will often create two types of figures:\n\nThose that help you\nThose that help your audience.\n\n\nExtra Credit:\nThe ‘datasaurus’ is lurking somewhere in this course. Find it and email Gavin with its location and identifying analysis."
  },
  {
    "objectID": "lectures/lec-03.html#data-visualization",
    "href": "lectures/lec-03.html#data-visualization",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Data visualization",
    "text": "Data visualization\n\n“The simple graph has brought more information to the data analyst’s mind than any other device.” — John Tukey\n\n\nData visualization is the creation and study of the visual representation of data\nMany tools for visualizing data – R is one of them\nMany approaches/systems within R for making data visualizations – ggplot2 is one of them, and that’s what we’re going to use."
  },
  {
    "objectID": "lectures/lec-03.html#anscombes-quartet",
    "href": "lectures/lec-03.html#anscombes-quartet",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Anscombe’s quartet",
    "text": "Anscombe’s quartet\n\n\n\n\n\n\n\n   set  x     y\n1    I 10  8.04\n2    I  8  6.95\n3    I 13  7.58\n4    I  9  8.81\n5    I 11  8.33\n6    I 14  9.96\n7    I  6  7.24\n8    I  4  4.26\n9    I 12 10.84\n10   I  7  4.82\n11   I  5  5.68\n12  II 10  9.14\n13  II  8  8.14\n14  II 13  8.74\n15  II  9  8.77\n16  II 11  9.26\n17  II 14  8.10\n18  II  6  6.13\n19  II  4  3.10\n20  II 12  9.13\n21  II  7  7.26\n22  II  5  4.74\n\n\n\n\n\n   set  x     y\n23 III 10  7.46\n24 III  8  6.77\n25 III 13 12.74\n26 III  9  7.11\n27 III 11  7.81\n28 III 14  8.84\n29 III  6  6.08\n30 III  4  5.39\n31 III 12  8.15\n32 III  7  6.42\n33 III  5  5.73\n34  IV  8  6.58\n35  IV  8  5.76\n36  IV  8  7.71\n37  IV  8  8.84\n38  IV  8  8.47\n39  IV  8  7.04\n40  IV  8  5.25\n41  IV 19 12.50\n42  IV  8  5.56\n43  IV  8  7.91\n44  IV  8  6.89"
  },
  {
    "objectID": "lectures/lec-03.html#summarising-anscombes-quartet",
    "href": "lectures/lec-03.html#summarising-anscombes-quartet",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Summarising Anscombe’s quartet",
    "text": "Summarising Anscombe’s quartet\n\nquartet %>%\n  group_by(set) %>%\n  summarise(\n    mean_x = mean(x),\n    mean_y = mean(y),\n    sd_x = sd(x),\n    sd_y = sd(y),\n    r = cor(x, y)\n  )\n\n# A tibble: 4 × 6\n  set   mean_x mean_y  sd_x  sd_y     r\n  <fct>  <dbl>  <dbl> <dbl> <dbl> <dbl>\n1 I          9   7.50  3.32  2.03 0.816\n2 II         9   7.50  3.32  2.03 0.816\n3 III        9   7.5   3.32  2.03 0.816\n4 IV         9   7.50  3.32  2.03 0.817"
  },
  {
    "objectID": "lectures/lec-03.html#visualizing-anscombes-quartet",
    "href": "lectures/lec-03.html#visualizing-anscombes-quartet",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Visualizing Anscombe’s quartet",
    "text": "Visualizing Anscombe’s quartet"
  },
  {
    "objectID": "lectures/lec-03.html#data-palmer-penguins",
    "href": "lectures/lec-03.html#data-palmer-penguins",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Data: Palmer Penguins",
    "text": "Data: Palmer Penguins\nMeasurements for penguin species, on islands in Palmer Archipelago, size (flipper length, body mass, bill dimensions), and sex. Horst et al. 2022. R Journal\n\n\n\n\n\n\n\n\n\nlibrary(palmerpenguins)\nglimpse(penguins)\n\nRows: 344\nColumns: 8\n$ species           <fct> Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…\n$ island            <fct> Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…\n$ bill_length_mm    <dbl> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …\n$ bill_depth_mm     <dbl> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …\n$ flipper_length_mm <int> 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…\n$ body_mass_g       <int> 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …\n$ sex               <fct> male, female, female, NA, female, male, female, male…\n$ year              <int> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…"
  },
  {
    "objectID": "lectures/lec-03.html#palmer-penguins",
    "href": "lectures/lec-03.html#palmer-penguins",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Palmer Penguins",
    "text": "Palmer Penguins\n\nPlotCode\n\n\n\n\n\n\n\n\n\n\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm, y = bill_length_mm,\n                     colour = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\",\n       subtitle = \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\",\n       x = \"Bill depth (mm)\", y = \"Bill length (mm)\",\n       colour = \"Species\") +\n  scale_color_viridis_d()"
  },
  {
    "objectID": "lectures/lec-03.html#faceting-small-multiples",
    "href": "lectures/lec-03.html#faceting-small-multiples",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Faceting (small multiples)",
    "text": "Faceting (small multiples)\n\nSmaller plots that display different subsets of the data\nUseful for exploring conditional relationships and large data"
  },
  {
    "objectID": "lectures/lec-03.html#various-ways-to-facet",
    "href": "lectures/lec-03.html#various-ways-to-facet",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Various ways to facet",
    "text": "Various ways to facet\nHow you facet and organize plots can strengthen (& weaken) the storytelling.\nThink about the comparisons you are trying to make or message your plot is intending to convey and choose visualizations that help understanding.\nLikely you will want to try different views, particularly when exploring the data initially."
  },
  {
    "objectID": "lectures/lec-03.html#facet-and-color",
    "href": "lectures/lec-03.html#facet-and-color",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Facet and color",
    "text": "Facet and color\n\nPlotCode\n\n\n\n\n\n\n\n\n\n\nggplot(\n  penguins,\n  aes(x = bill_depth_mm,\n      y = bill_length_mm,\n      color = species)) + #<<\n  geom_point() +\n  facet_grid(island ~ year) +\n  scale_color_viridis_d() #<<"
  },
  {
    "objectID": "lectures/lec-03.html#number-of-variables-involved",
    "href": "lectures/lec-03.html#number-of-variables-involved",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Number of variables involved",
    "text": "Number of variables involved\n\nUnivariate data analysis - distribution of single variable\nBivariate data analysis - relationship between two variables\nMultivariate data analysis - relationship between many variables at once, often focusing on the relationship between two while conditioning for others"
  },
  {
    "objectID": "lectures/lec-03.html#types-of-variables",
    "href": "lectures/lec-03.html#types-of-variables",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Types of variables",
    "text": "Types of variables\n\nNumerical variables can be classified as continuous or discrete based on whether or not the variable can take on an infinite number of values or only non-negative whole numbers, respectively.\nIf the variable is categorical, we can determine if it is ordinal based on whether or not the levels have a natural ordering."
  },
  {
    "objectID": "lectures/lec-03.html#group-exercise",
    "href": "lectures/lec-03.html#group-exercise",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Group exercise",
    "text": "Group exercise\nPlot Description Practice\nWith your group’s plot, discuss and answer the following questions:\n\nWhat type of graph is it?\nWhat is being plotted?\nHow would you describe the distribution or trend of the data?\nWhat question is the plot trying to answer?\nDo you think the plot is successful in answering that question? Why or why not?"
  },
  {
    "objectID": "lectures/lec-03.html#data-lending-club",
    "href": "lectures/lec-03.html#data-lending-club",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Data: Lending Club",
    "text": "Data: Lending Club\n\n\n\nThousands of loans made through the Lending Club, which is a platform that allows individuals to lend to other individuals\nNot all loans are created equal – ease of getting a loan depends on (apparent) ability to pay back the loan\nData includes loans made, these are not loan applications"
  },
  {
    "objectID": "lectures/lec-03.html#take-a-peek-at-data",
    "href": "lectures/lec-03.html#take-a-peek-at-data",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Take a peek at data",
    "text": "Take a peek at data\n\nlibrary(openintro)\nglimpse(loans_full_schema)\n\nRows: 10,000\nColumns: 55\n$ emp_title                        <chr> \"global config engineer \", \"warehouse…\n$ emp_length                       <dbl> 3, 10, 3, 1, 10, NA, 10, 10, 10, 3, 1…\n$ state                            <fct> NJ, HI, WI, PA, CA, KY, MI, AZ, NV, I…\n$ homeownership                    <fct> MORTGAGE, RENT, RENT, RENT, RENT, OWN…\n$ annual_income                    <dbl> 90000, 40000, 40000, 30000, 35000, 34…\n$ verified_income                  <fct> Verified, Not Verified, Source Verifi…\n$ debt_to_income                   <dbl> 18.01, 5.04, 21.15, 10.16, 57.96, 6.4…\n$ annual_income_joint              <dbl> NA, NA, NA, NA, 57000, NA, 155000, NA…\n$ verification_income_joint        <fct> , , , , Verified, , Not Verified, , ,…\n$ debt_to_income_joint             <dbl> NA, NA, NA, NA, 37.66, NA, 13.12, NA,…\n$ delinq_2y                        <int> 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0…\n$ months_since_last_delinq         <int> 38, NA, 28, NA, NA, 3, NA, 19, 18, NA…\n$ earliest_credit_line             <dbl> 2001, 1996, 2006, 2007, 2008, 1990, 2…\n$ inquiries_last_12m               <int> 6, 1, 4, 0, 7, 6, 1, 1, 3, 0, 4, 4, 8…\n$ total_credit_lines               <int> 28, 30, 31, 4, 22, 32, 12, 30, 35, 9,…\n$ open_credit_lines                <int> 10, 14, 10, 4, 16, 12, 10, 15, 21, 6,…\n$ total_credit_limit               <int> 70795, 28800, 24193, 25400, 69839, 42…\n$ total_credit_utilized            <int> 38767, 4321, 16000, 4997, 52722, 3898…\n$ num_collections_last_12m         <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ num_historical_failed_to_pay     <int> 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0…\n$ months_since_90d_late            <int> 38, NA, 28, NA, NA, 60, NA, 71, 18, N…\n$ current_accounts_delinq          <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ total_collection_amount_ever     <int> 1250, 0, 432, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ current_installment_accounts     <int> 2, 0, 1, 1, 1, 0, 2, 2, 6, 1, 2, 1, 2…\n$ accounts_opened_24m              <int> 5, 11, 13, 1, 6, 2, 1, 4, 10, 5, 6, 7…\n$ months_since_last_credit_inquiry <int> 5, 8, 7, 15, 4, 5, 9, 7, 4, 17, 3, 4,…\n$ num_satisfactory_accounts        <int> 10, 14, 10, 4, 16, 12, 10, 15, 21, 6,…\n$ num_accounts_120d_past_due       <int> 0, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, …\n$ num_accounts_30d_past_due        <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ num_active_debit_accounts        <int> 2, 3, 3, 2, 10, 1, 3, 5, 11, 3, 2, 2,…\n$ total_debit_limit                <int> 11100, 16500, 4300, 19400, 32700, 272…\n$ num_total_cc_accounts            <int> 14, 24, 14, 3, 20, 27, 8, 16, 19, 7, …\n$ num_open_cc_accounts             <int> 8, 14, 8, 3, 15, 12, 7, 12, 14, 5, 8,…\n$ num_cc_carrying_balance          <int> 6, 4, 6, 2, 13, 5, 6, 10, 14, 3, 5, 3…\n$ num_mort_accounts                <int> 1, 0, 0, 0, 0, 3, 2, 7, 2, 0, 2, 3, 3…\n$ account_never_delinq_percent     <dbl> 92.9, 100.0, 93.5, 100.0, 100.0, 78.1…\n$ tax_liens                        <int> 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ public_record_bankrupt           <int> 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0…\n$ loan_purpose                     <fct> moving, debt_consolidation, other, de…\n$ application_type                 <fct> individual, individual, individual, i…\n$ loan_amount                      <int> 28000, 5000, 2000, 21600, 23000, 5000…\n$ term                             <dbl> 60, 36, 36, 36, 36, 36, 60, 60, 36, 3…\n$ interest_rate                    <dbl> 14.07, 12.61, 17.09, 6.72, 14.07, 6.7…\n$ installment                      <dbl> 652.53, 167.54, 71.40, 664.19, 786.87…\n$ grade                            <ord> C, C, D, A, C, A, C, B, C, A, C, B, C…\n$ sub_grade                        <fct> C3, C1, D1, A3, C3, A3, C2, B5, C2, A…\n$ issue_month                      <fct> Mar-2018, Feb-2018, Feb-2018, Jan-201…\n$ loan_status                      <fct> Current, Current, Current, Current, C…\n$ initial_listing_status           <fct> whole, whole, fractional, whole, whol…\n$ disbursement_method              <fct> Cash, Cash, Cash, Cash, Cash, Cash, C…\n$ balance                          <dbl> 27015.86, 4651.37, 1824.63, 18853.26,…\n$ paid_total                       <dbl> 1999.330, 499.120, 281.800, 3312.890,…\n$ paid_principal                   <dbl> 984.14, 348.63, 175.37, 2746.74, 1569…\n$ paid_interest                    <dbl> 1015.19, 150.49, 106.43, 566.15, 754.…\n$ paid_late_fees                   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…"
  },
  {
    "objectID": "lectures/lec-03.html#variable-types",
    "href": "lectures/lec-03.html#variable-types",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Variable types",
    "text": "Variable types\n\n\n\nvariable\ntype\n\n\n\n\nloan_amount\nnumerical, continuous\n\n\ninterest_rate\nnumerical, continuous\n\n\nterm\nnumerical, discrete\n\n\ngrade\ncategorical, ordinal\n\n\nstate\ncategorical, not ordinal\n\n\nannual_income\nnumerical, continuous\n\n\nhomeownership\ncategorical, not ordinal\n\n\ndebt_to_income\nnumerical, continuous"
  },
  {
    "objectID": "lectures/lec-03.html#describing-shapes-of-numerical-distributions",
    "href": "lectures/lec-03.html#describing-shapes-of-numerical-distributions",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Describing shapes of numerical distributions",
    "text": "Describing shapes of numerical distributions\n\nshape:\n\nskewness: right-skewed, left-skewed, symmetric (skew is to the side of the longer tail)\nmodality: unimodal, bimodal, multimodal, uniform\n\ncenter: mean (mean), median (median), mode (not always useful)\nspread: range (range), standard deviation (sd), inter-quartile range (IQR)\nunusual observations"
  },
  {
    "objectID": "lectures/lec-03.html#histogram",
    "href": "lectures/lec-03.html#histogram",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Histogram",
    "text": "Histogram\n\nggplot(loans, aes(x = loan_amount)) +\n  geom_histogram()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`."
  },
  {
    "objectID": "lectures/lec-03.html#histograms-and-binwidth",
    "href": "lectures/lec-03.html#histograms-and-binwidth",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Histograms and binwidth",
    "text": "Histograms and binwidth\nbinwidth = 1000\n\nggplot(loans, aes(x = loan_amount)) +\n  geom_histogram(binwidth = 1000)"
  },
  {
    "objectID": "lectures/lec-03.html#histograms-and-binwidth-1",
    "href": "lectures/lec-03.html#histograms-and-binwidth-1",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Histograms and binwidth",
    "text": "Histograms and binwidth\nbinwidth = 5000\n\nggplot(loans, aes(x = loan_amount)) +\n  geom_histogram(binwidth = 5000)"
  },
  {
    "objectID": "lectures/lec-03.html#histograms-and-binwidth-2",
    "href": "lectures/lec-03.html#histograms-and-binwidth-2",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Histograms and binwidth",
    "text": "Histograms and binwidth\nbinwidth = 20000\n\nggplot(loans, aes(x = loan_amount)) +\n  geom_histogram(binwidth = 20000)"
  },
  {
    "objectID": "lectures/lec-03.html#customizing-histograms",
    "href": "lectures/lec-03.html#customizing-histograms",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Customizing histograms",
    "text": "Customizing histograms\nFill with a categorical variable\n\nPlotCode\n\n\n\n\n\n\n\n\n\n\nggplot(loans, aes(x = loan_amount,\n                  fill = homeownership)) +\n  geom_histogram(binwidth = 5000,\n                 alpha = 0.5) +\n  labs(\n    x = \"Loan amount ($)\",\n    y = \"Frequency\",\n    title = \"Amounts of Lending Club loans\"\n  )"
  },
  {
    "objectID": "lectures/lec-03.html#facet-with-a-categorical-variable",
    "href": "lectures/lec-03.html#facet-with-a-categorical-variable",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Facet with a categorical variable",
    "text": "Facet with a categorical variable\n\nPlotCode"
  },
  {
    "objectID": "lectures/lec-03.html#box-plot",
    "href": "lectures/lec-03.html#box-plot",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Box plot",
    "text": "Box plot\n\nggplot(loans, aes(x = interest_rate)) +\n  geom_boxplot()"
  },
  {
    "objectID": "lectures/lec-03.html#box-plot-and-outliers",
    "href": "lectures/lec-03.html#box-plot-and-outliers",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Box plot and outliers",
    "text": "Box plot and outliers\n\nggplot(loans, aes(x = annual_income)) +\n  geom_boxplot()"
  },
  {
    "objectID": "lectures/lec-03.html#adding-a-categorical-variable",
    "href": "lectures/lec-03.html#adding-a-categorical-variable",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Adding a categorical variable",
    "text": "Adding a categorical variable\n\nPlotCode\n\n\n\n\n\n\n\n\n\n\nggplot(loans, aes(x = interest_rate,\n                  y = grade)) + #<<\n  geom_boxplot() +\n  labs(\n    x = \"Interest rate (%)\",\n    y = \"Grade\",\n    title = \"Interest rates of Lending Club loans\",\n    subtitle = \"by grade of loan\" #<<\n  )"
  },
  {
    "objectID": "lectures/lec-03.html#scatterplot",
    "href": "lectures/lec-03.html#scatterplot",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Scatterplot",
    "text": "Scatterplot\n\nggplot(loans, aes(x = debt_to_income, y = interest_rate)) +\n  geom_point()"
  },
  {
    "objectID": "lectures/lec-03.html#hex-plot",
    "href": "lectures/lec-03.html#hex-plot",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Hex plot",
    "text": "Hex plot\n\nggplot(loans %>% filter(debt_to_income < 100),\n       aes(x = debt_to_income, y = interest_rate)) +\n  geom_hex()"
  },
  {
    "objectID": "lectures/lec-03.html#contour-plot",
    "href": "lectures/lec-03.html#contour-plot",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Contour plot",
    "text": "Contour plot\n\nv <- ggplot(faithfuld, aes(waiting, eruptions, z = density))\nv + geom_contour()"
  },
  {
    "objectID": "lectures/lec-03.html#bar-plot",
    "href": "lectures/lec-03.html#bar-plot",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Bar plot",
    "text": "Bar plot\n\nggplot(loans, aes(x = homeownership)) +\n  geom_bar()"
  },
  {
    "objectID": "lectures/lec-03.html#segmented-bar-plot",
    "href": "lectures/lec-03.html#segmented-bar-plot",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Segmented bar plot",
    "text": "Segmented bar plot\n\nggplot(loans, aes(x = homeownership,\n                  fill = grade)) + #<<\n  geom_bar()"
  },
  {
    "objectID": "lectures/lec-03.html#segmented-bar-plot-1",
    "href": "lectures/lec-03.html#segmented-bar-plot-1",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Segmented bar plot",
    "text": "Segmented bar plot\n\nggplot(loans, aes(x = homeownership, fill = grade)) +\n  geom_bar(position = \"fill\") #<<"
  },
  {
    "objectID": "lectures/lec-03.html#customizing-bar-plots",
    "href": "lectures/lec-03.html#customizing-bar-plots",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Customizing bar plots",
    "text": "Customizing bar plots"
  },
  {
    "objectID": "lectures/lec-03.html#customizing-bar-plots-1",
    "href": "lectures/lec-03.html#customizing-bar-plots-1",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Customizing bar plots",
    "text": "Customizing bar plots"
  },
  {
    "objectID": "lectures/lec-03.html#customizing-bar-plots-2",
    "href": "lectures/lec-03.html#customizing-bar-plots-2",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Customizing bar plots",
    "text": "Customizing bar plots"
  },
  {
    "objectID": "lectures/lec-03.html#relationships-between-numerical-and-categorical-variables",
    "href": "lectures/lec-03.html#relationships-between-numerical-and-categorical-variables",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Relationships between numerical and categorical variables",
    "text": "Relationships between numerical and categorical variables\nAlready talked about…\n\nColouring and faceting histograms and density plots\nSide-by-side box plots"
  },
  {
    "objectID": "lectures/lec-03.html#violin-plots",
    "href": "lectures/lec-03.html#violin-plots",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Violin plots",
    "text": "Violin plots\n\nggplot(loans, aes(x = homeownership, y = loan_amount)) +\n  geom_violin()"
  },
  {
    "objectID": "lectures/lec-03.html#ridge-plots",
    "href": "lectures/lec-03.html#ridge-plots",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Ridge plots",
    "text": "Ridge plots\n\nlibrary(ggridges)\nggplot(loans, aes(x = loan_amount, y = grade, fill = grade, color = grade)) +\n  geom_density_ridges(alpha = 0.5)"
  },
  {
    "objectID": "lectures/lec-03.html#raincloud-plots",
    "href": "lectures/lec-03.html#raincloud-plots",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Raincloud plots",
    "text": "Raincloud plots\n\nPlotCode\n\n\n\n\n\n\n\n\n\n\nlibrary(ggdist)\nlibrary(gghalves)\nggplot(penguins, aes(species, bill_length_mm)) +\n  ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) +\n  geom_boxplot(width = .1, outlier.shape = NA) +\n  gghalves::geom_half_point(side = \"l\", range_scale = .4, alpha = .5) +\n  coord_flip()"
  },
  {
    "objectID": "lectures/lec-03.html#qq-plots",
    "href": "lectures/lec-03.html#qq-plots",
    "title": "Biological Stats 2: Lecture 3",
    "section": "QQ-plots",
    "text": "QQ-plots\nDetermines if data conform to a theoretical distribution."
  },
  {
    "objectID": "lectures/lec-03.html#pair-plots",
    "href": "lectures/lec-03.html#pair-plots",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Pair plots",
    "text": "Pair plots\n\nScatterplot for each pair of variables.\nMeasures of correlation\n\n\nlibrary(GGally)\nggpairs(penguins, columns=3:6)"
  },
  {
    "objectID": "lectures/lec-03.html#über-pair-plot",
    "href": "lectures/lec-03.html#über-pair-plot",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Über Pair plot",
    "text": "Über Pair plot"
  },
  {
    "objectID": "lectures/lec-03.html#visualizing-spatial-data",
    "href": "lectures/lec-03.html#visualizing-spatial-data",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Visualizing spatial data",
    "text": "Visualizing spatial data\nMaps are extremely useful (and intuitive) ways of exploring spatial relationships among variables in our data.\n\n\n\n\n (Eric Anderson)"
  },
  {
    "objectID": "lectures/lec-03.html#transformation",
    "href": "lectures/lec-03.html#transformation",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Transformation",
    "text": "Transformation\n\nOutliers, non-normality, heteroscedasticity and nonlinearity are the most common reasons for transformation.\nRemoving outliers is an option (with sensitivity analysis)\nAll response and explanatory variables can be transformed differently.\nChoice of transformation depends on analytical design:\n\nGLS, GLM, GAM Poisson can handle outliers\nGAM and iterative least squares can handle nonlinearity"
  },
  {
    "objectID": "lectures/lec-03.html#nonlinearity",
    "href": "lectures/lec-03.html#nonlinearity",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Nonlinearity",
    "text": "Nonlinearity\n\nIf scatterplot indicates nonlinear patterns, consider transforming one or both variables.\nMany possible transformations, with lots of guidance on how to proceed with these.\nGF advice: Consider the theoretical basis for transformations and think about appropriate methods before trying to ‘force’ linearity to apply cookbooks."
  },
  {
    "objectID": "lectures/lec-03.html#standardizations",
    "href": "lectures/lec-03.html#standardizations",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Standardizations",
    "text": "Standardizations\n\nIf variables for comparison are on different scales, conversion to a common scale may be an option.\nSome analyses (e.g., correlation, PCA) are self- standardized.\n\n\n\nCentering (standard ‘location’):\nScaling1 (standard ‘spread’):\n\n\nNB: sometimes called ‘normalizing’, but does not mean making your data normally distributed. GF prefers ‘standardizing’ or ‘scaling’ but you will see normalizing a lot."
  },
  {
    "objectID": "lectures/lec-03.html#standardizations-1",
    "href": "lectures/lec-03.html#standardizations-1",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Standardizations",
    "text": "Standardizations"
  },
  {
    "objectID": "lectures/lec-03.html#standardizations-2",
    "href": "lectures/lec-03.html#standardizations-2",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Standardizations",
    "text": "Standardizations"
  },
  {
    "objectID": "lectures/lec-03.html#standardizations-3",
    "href": "lectures/lec-03.html#standardizations-3",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Standardizations",
    "text": "Standardizations"
  },
  {
    "objectID": "lectures/lec-03.html#exploring-relationships",
    "href": "lectures/lec-03.html#exploring-relationships",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Exploring relationships",
    "text": "Exploring relationships\n‘Even if you don’t see it, it might still be there.’\nPlot your data as many ways as you can, particularly with respect to other variables in the dataset.\n\nThis may change your understanding of patterns in the data\nSimpson’s paradox"
  },
  {
    "objectID": "lectures/lec-03.html#simpsons-paradox",
    "href": "lectures/lec-03.html#simpsons-paradox",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Simpson’s paradox",
    "text": "Simpson’s paradox\n\nSimpson’s paradox illustrates the effect that omission of an explanatory variable can have on the measure of association between another explanatory variable and a response variable\nThe inclusion of a third variable in the analysis can change the apparent relationship between the other two variables"
  },
  {
    "objectID": "lectures/lec-03.html#simpsons-paradox-1",
    "href": "lectures/lec-03.html#simpsons-paradox-1",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Simpson’s paradox",
    "text": "Simpson’s paradox"
  },
  {
    "objectID": "lectures/lec-03.html#simpsons-paradox-2",
    "href": "lectures/lec-03.html#simpsons-paradox-2",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Simpson’s paradox",
    "text": "Simpson’s paradox"
  },
  {
    "objectID": "lectures/lec-03.html#simpsons-paradox-3",
    "href": "lectures/lec-03.html#simpsons-paradox-3",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Simpson’s paradox",
    "text": "Simpson’s paradox"
  },
  {
    "objectID": "lectures/lec-03.html#simpsons-paradox-4",
    "href": "lectures/lec-03.html#simpsons-paradox-4",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Simpson’s paradox",
    "text": "Simpson’s paradox"
  },
  {
    "objectID": "lectures/lec-03.html#summary",
    "href": "lectures/lec-03.html#summary",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Summary",
    "text": "Summary\nTake a peep at your data!\nPlot the data, then plot it a different way, and again…\n\nReasons for data transformation:\n\nReduce effect of outliers\nImprove linearity between variables\nMake error structure closer to normal\nStabilize relationship between mean and variance"
  },
  {
    "objectID": "lectures/lec-03.html#summary-1",
    "href": "lectures/lec-03.html#summary-1",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Summary",
    "text": "Summary\nGeneral approach:\n\nApply all explorations to raw data\nIf explanatory data have outliers, then transform\nApply analytical technique and explore residuals\nIf residuals have outliers, heterogeneity or patterns, then transform\nChoose the best transformation by trial & error, automatic selection or rules of thumb (e.g., sqrt for counts, arcsin for proportions, log for multiplicative relationships)"
  },
  {
    "objectID": "lectures/lec-03.html#supplemental-reading",
    "href": "lectures/lec-03.html#supplemental-reading",
    "title": "Biological Stats 2: Lecture 3",
    "section": "Supplemental Reading",
    "text": "Supplemental Reading\nIntroduction to Modern Statistics Chap 4-6\nR for Data Science, Chap 3\nCommunicating with Data, Chap 3-4\n\n\n\ngavinfay.github.io/mar536-biolstats2-s23"
  },
  {
    "objectID": "lectures/lec-06b.html",
    "href": "lectures/lec-06b.html",
    "title": "poisson glm in R",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──\n\n\n✔ ggplot2 3.3.6      ✔ purrr   0.3.4 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.0      ✔ stringr 1.4.0 \n✔ readr   2.1.2      ✔ forcats 0.5.1 \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\nlibrary(broom)"
  },
  {
    "objectID": "lectures/lec-06b.html#setup-1",
    "href": "lectures/lec-06b.html#setup-1",
    "title": "poisson glm in R",
    "section": "setup",
    "text": "setup\n\n#first read in the data & create richness variable\nRIKZ <- read_table(file = \"../data/RIKZ.txt\")\n\n\n── Column specification ────────────────────────────────────────────────────────\ncols(\n  .default = col_double()\n)\nℹ Use `spec()` for the full column specifications.\n\nRIKZ <- RIKZ |> \n  mutate(Richness = rowSums(RIKZ[,2:76]>0)) |>\n  select(Richness, 77:89)"
  },
  {
    "objectID": "lectures/lec-06b.html#generalized-linear-modeling",
    "href": "lectures/lec-06b.html#generalized-linear-modeling",
    "title": "poisson glm in R",
    "section": "Generalized linear modeling",
    "text": "Generalized linear modeling\nRecall from lecture: \\[\\eta = \\beta_1 x_1 + \\beta_2 x_2 + \\dots + \\beta_p x_p\\] \\[f_Y(y;\\mu,\\varphi) = \\exp\\left[\\frac{A}{\\varphi}{y\\lambda(\\mu)-\\gamma(\\lambda(\\mu))}+\\tau(y,\\varphi)\\right]\\] \\[\\mu = m(\\eta) \\text{,    } \\eta = m^{-1}(\\mu)=l(\\mu)\\]\nThe combination of a response distribution, a link function and other information needed to carry out the modeling exercise is called the family of the generalized linear model."
  },
  {
    "objectID": "lectures/lec-06b.html#the-glm-function",
    "href": "lectures/lec-06b.html#the-glm-function",
    "title": "poisson glm in R",
    "section": "The glm() function",
    "text": "The glm() function\nThe R function to fit a generalized linear model is glm() which uses the form:\nfitted.model <- glm(formula, family=family.generator, data=data.frame)\nOnly new piece is the call to ‘family.generator’\nAlthough complex, its use is fairly simple.\nWhere there is a choice of link, link can be supplied with the family name as a parameter.\nSimple (inefficient) use: The following are equivalent.\n\nRIKZ_lm1 <- lm(Richness ~ NAP, data = RIKZ)\nRIKZ_glm1 <- glm(Richness ~ NAP, family = gaussian, \n                 data = RIKZ)\n\nMost of the extraction functions that can be applied to lm() can also be used with glm()."
  },
  {
    "objectID": "lectures/lec-06b.html#the-glm-function-1",
    "href": "lectures/lec-06b.html#the-glm-function-1",
    "title": "poisson glm in R",
    "section": "The glm() function",
    "text": "The glm() function\n\ntidy(RIKZ_lm1)\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)     6.69     0.658     10.2  5.25e-13\n2 NAP            -2.87     0.631     -4.55 4.42e- 5\ntidy(RIKZ_glm1)\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)     6.69     0.658     10.2  5.25e-13\n2 NAP            -2.87     0.631     -4.55 4.42e- 5"
  },
  {
    "objectID": "lectures/lec-06b.html#poisson-regression",
    "href": "lectures/lec-06b.html#poisson-regression",
    "title": "poisson glm in R",
    "section": "Poisson regression",
    "text": "Poisson regression\n\\[P(X=x) = \\frac{e^{-\\mu} \\mu^x}{x!} \\text{,   } \\mu_i = e^{\\alpha+\\beta_1 x_{1,i} + \\dots + \\beta_j x_{j,i}}\\]"
  },
  {
    "objectID": "lectures/lec-06b.html#rikz-example",
    "href": "lectures/lec-06b.html#rikz-example",
    "title": "poisson glm in R",
    "section": "RIKZ example",
    "text": "RIKZ example\n\n#fit the poisson regression model\nRIKZ_poisson <- glm(Richness ~ NAP, data = RIKZ, \n                    family = poisson)\n\nNote that the default link for the poisson is log so we don’t have to specify here (see ?family)."
  },
  {
    "objectID": "lectures/lec-06b.html#summaryrikz_poisson",
    "href": "lectures/lec-06b.html#summaryrikz_poisson",
    "title": "poisson glm in R",
    "section": "summary(RIKZ_poisson)",
    "text": "summary(RIKZ_poisson)\n\n\nCall:\nglm(formula = Richness ~ NAP, family = poisson, data = RIKZ)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.2029  -1.2432  -0.9199   0.3943   4.3256  \n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  1.79100    0.06329  28.297  < 2e-16 ***\nNAP         -0.55597    0.07163  -7.762 8.39e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 179.75  on 44  degrees of freedom\nResidual deviance: 113.18  on 43  degrees of freedom\nAIC: 259.18\n\nNumber of Fisher Scoring iterations: 5"
  },
  {
    "objectID": "lectures/lec-06b.html#broomaugment",
    "href": "lectures/lec-06b.html#broomaugment",
    "title": "poisson glm in R",
    "section": "broom::augment()",
    "text": "broom::augment()\nAs with lm(), the augment() function can be used to obtain the predictions from a fitted model object, and for a new data frame.\n\nnewobject <- augment(oldobject, newdata, \n                     type.predict = c(\"link\",\"response\",\"terms\"),\n                     se_fit = TRUE)\n\nNote: default for type.predict is on the scale of the linear predictors. Set to \"response\" to obtain predictions on the scale of the response variable."
  },
  {
    "objectID": "lectures/lec-06b.html#observed-and-fitted-values-for-poisson-rikz",
    "href": "lectures/lec-06b.html#observed-and-fitted-values-for-poisson-rikz",
    "title": "poisson glm in R",
    "section": "Observed and fitted values for Poisson RIKZ",
    "text": "Observed and fitted values for Poisson RIKZ\n\n#create new values for beach height\nnew_data <- tibble(NAP = seq(-1.5,2.5,length.out=100))\n#predict values for response based on new salinity\nRIKZ_pois_pred <- augment(RIKZ_poisson,\n                    newdata = new_data, \n                    type.predict = \"response\",\n                    se_fit = \"TRUE\")\n#plot\nggplot(RIKZ, aes(x=NAP, y= Richness)) +\n         geom_point() +\n         geom_line(data = RIKZ_pois_pred,\n                   aes(x=NAP, y = .fitted),\n                   col = \"blue\") +\n         labs(y = \"Richness\", x = \"NAP\") +\n         ylim(0,25) + xlim(-1.5,2.5)"
  },
  {
    "objectID": "lectures/lec-06b.html#fitting-the-glm-in-the-ggplot-call",
    "href": "lectures/lec-06b.html#fitting-the-glm-in-the-ggplot-call",
    "title": "poisson glm in R",
    "section": "fitting the GLM in the ggplot call",
    "text": "fitting the GLM in the ggplot call\n\nggplot(RIKZ,aes(NAP,Richness)) +\n  geom_point() +\n  geom_smooth(method = \"glm\", \n    method.args = list(family = poisson), se = TRUE)            \n`geom_smooth()` using formula 'y ~ x'"
  },
  {
    "objectID": "lectures/lec-06b.html#quasi-poisson",
    "href": "lectures/lec-06b.html#quasi-poisson",
    "title": "poisson glm in R",
    "section": "Quasi-Poisson",
    "text": "Quasi-Poisson\n\nRIKZ_quasip_1 <- glm(Richness ~ NAP, \n                     family = quasipoisson,\n                     data = RIKZ)\nsummary(RIKZ_quasip_1)\n\nCall:\nglm(formula = Richness ~ NAP, family = quasipoisson, data = RIKZ)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.2029  -1.2432  -0.9199   0.3943   4.3256  \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   1.7910     0.1104  16.218  < 2e-16 ***\nNAP          -0.5560     0.1250  -4.448 6.02e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for quasipoisson family taken to be 3.044178)\n\n    Null deviance: 179.75  on 44  degrees of freedom\nResidual deviance: 113.18  on 43  degrees of freedom\nAIC: NA\n\nNumber of Fisher Scoring iterations: 5"
  },
  {
    "objectID": "lectures/lec-06b.html#full-poisson-model",
    "href": "lectures/lec-06b.html#full-poisson-model",
    "title": "poisson glm in R",
    "section": "Full Poisson Model",
    "text": "Full Poisson Model\n\nRIKZ_pois_full <- glm(Richness ~ NAP + factor(week) +\n                      factor(exposure),\n                      data = RIKZ,\n                      family = poisson)\nsummary(RIKZ_pois_full)\n\nCall:\nglm(formula = Richness ~ NAP + factor(week) + factor(exposure), \n    family = poisson, data = RIKZ)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.8946  -0.4821  -0.2555   0.3425   2.6203  \n\nCoefficients:\n                   Estimate Std. Error z value Pr(>|z|)    \n(Intercept)         2.53136    0.12866  19.675   <2e-16 ***\nNAP                -0.48950    0.07449  -6.571    5e-11 ***\nfactor(week)2      -0.75723    0.35132  -2.155   0.0311 *  \nfactor(week)3      -0.50717    0.21148  -2.398   0.0165 *  \nfactor(week)4       0.12361    0.22617   0.547   0.5847    \nfactor(exposure)10 -0.42602    0.19022  -2.240   0.0251 *  \nfactor(exposure)11 -0.65481    0.33446  -1.958   0.0503 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 179.75  on 44  degrees of freedom\nResidual deviance:  47.80  on 38  degrees of freedom\nAIC: 203.8\n\nNumber of Fisher Scoring iterations: 5"
  },
  {
    "objectID": "lectures/lec-06b.html#drop-exposure",
    "href": "lectures/lec-06b.html#drop-exposure",
    "title": "poisson glm in R",
    "section": "Drop Exposure?",
    "text": "Drop Exposure?\n\ndrop1(RIKZ_pois_full, test = \"Chisq\")\nSingle term deletions\n\nModel:\nRichness ~ NAP + factor(week) + factor(exposure)\n                 Df Deviance    AIC    LRT  Pr(>Chi)    \n<none>                47.800 203.80                     \nNAP               1   93.460 247.46 45.660 1.407e-11 ***\nfactor(week)      3   58.372 208.37 10.572   0.01428 *  \nfactor(exposure)  2   53.466 205.46  5.666   0.05885 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "project-description.html",
    "href": "project-description.html",
    "title": "Project description",
    "section": "",
    "text": "Students are encouraged to discuss their project ideas with Gavin to identify scope. Note that the project does not have to be related to your graduate research, but many students in previous semesters have found that this is beneficial in developing the basis for their thesis (or a particular chapter). Gavin also has a list of potential student project ideas. Regardless, try to view the project as an analysis that is potentially publishable.\nDeliverables include:\n\n1-2 sentence project topic idea due Jan 26 (1% of course grade).\nBrief (1-2 page) project description including a statement of the problem, proposed statistical method, and supplemental reference(s) is due Feb 09 (4% of course grade).\nData exploration report containing data summaries and visualizations of the dataset to be used in the project, including observations of implications of data structure for the analyses to be conducted. Due Feb 28. (10% of course grade).\nStudent project presentation with chapter assignment or supplemental reading on the statistical method used in the project. A 10-minute lecture on the method, and demonstration of the method using the project data set. Presentations will be graded based on the instructors’ evaluation of accuracy, clarity, and comprehensiveness. Feedback from other students will also be considered in evaluation of presentations (20% of course grade).\nProject report (due Apr 25). A written description of the methods and results of the project in the form of a draft scientific manuscript (Introduction, Methods, Results, Discussion). (20% of course grade).\n\nData set ideas\nIf you are stuck for a dataset, then there are many open data sets in the ecological and environmental sciences that are published online. Some of these may provide some inspiration for an analysis.\n\nNOAA Data Explorer\nDOI Data Explorer\nEcological Data Wiki\nDataDryad\nZenodo\nLibguide on ecological datasets from Central Michigan University Library"
  },
  {
    "objectID": "course-syllabus.html",
    "href": "course-syllabus.html",
    "title": "Syllabus",
    "section": "",
    "text": "Click here to download a PDF copy of the syllabus. (last updated 2023-02-04)"
  },
  {
    "objectID": "course-syllabus.html#course-info",
    "href": "course-syllabus.html#course-info",
    "title": "Syllabus",
    "section": "Course info",
    "text": "Course info\nInstructor: Gavin Fay, Associate Professor, Fisheries Oceanography\nLab teaching assistant: Lucy McGinnis, MS student, Fisheries Oceanography\nStudent Hours:\n\nGavin: By appointment (via Office365 Bookings)\nLucy: Thu 1-3, SMAST-E 245\n\n\n\n\n\nDay\nTime\nLocation\n\n\n\n\nLectures\nTue & Thu\n10:30 am - 11:30 am\nSMAST-East 102 + 103\n\n\nLabs\nWed\n10:30 am - 12:00 pm\nSMAST-East 102 + 103"
  },
  {
    "objectID": "course-syllabus.html#course-description",
    "href": "course-syllabus.html#course-description",
    "title": "Syllabus",
    "section": "Course Description",
    "text": "Course Description\nStatistical analysis of ecological data. This course provides guided learning in advanced statistical analysis, as applied to ecological research and other fields of marine science. Advanced concepts in probability, statistical model building, hypothesis testing, inference, estimation and prediction, including analyses of example data sets and problems. Students will be required to learn and present topics to the class that are relevant to their graduate research and complete a class project. Course materials will be presented using the statistical programming language R; a computer lab focused on introductory and intermediate R programming will be held for the first half of the semester.\n\nCourse Objectives\n\nSelf-learning in advanced quantitative concepts and methods\nFamiliarity with advanced statistical methods\nExperience communicating advanced quantitative topics\nExperience in statistical programming\n\n\n\nCOVID-19\nWe are in the middle of a global pandemic and things are not normal. I want you to succeed in this course and will do what I can to help support your being able to meet our learning objectives. Please communicate with me if there are additional things I can do to help support you. I will not ask you to disclose information related to your reasons for such requests outside of what is needed to provide possible solutions.\n\n\nCode of Conduct\nThis class follows the Fay Lab Code of Conduct, which applies to all class spaces, including classrooms, Zoom calls, class GoogleDocs or other materials, and student hours. You can also read my lab’s lab culture and philosophy, which underpins my approach to teaching and collaboration.\n\n\nCommunication\nAll lecture notes, assignment instructions, an up-to-date schedule, and other course materials may be found on this course website.\nI will regularly send course announcements via email. Make sure to check one or the other of these regularly. If an announcement is sent Monday through Thursday, I will assume that you have read the announcement by the next day. If an announcement is sent on a Friday or over the weekend, I will assume that you have read it by Monday.\n\n\nWhere to get help\n\nIf you have a question during lecture or lab, feel free to ask it! There are likely other students with the same question, so by asking you will create a learning opportunity for everyone.\nWe are here to help you be successful in the course. You are encouraged to attend student hours (sometimes called ‘office hours’) to ask questions about the course content and assignments. Many questions are most effectively answered as you discuss them with others, so these times are a valuable resource. Please use them!\nIf you email me (Gavin), please include “MAR 536” in the subject line. Barring extenuating circumstances, I will respond to MAR 536 emails within 48 hours Monday - Friday. Response time may be slower for emails sent Friday evening - Sunday.\n\n\n\nPrerequisites\nStudents should have taken an introductory graduate statistics course (e.g. MAR 535 Biological Statistics I or equivalent), or seek permission from the instructor."
  },
  {
    "objectID": "course-syllabus.html#evaluation-procedures",
    "href": "course-syllabus.html#evaluation-procedures",
    "title": "Syllabus",
    "section": "Evaluation procedures",
    "text": "Evaluation procedures\n\nAn advanced statistical analysis of data relevant to the student’s graduate research topic, including a detailed report and oral presentation (55% of course grade). Elements include:\n\n\n\n1-2 sentence project topic idea due Jan 26 (1% of course grade).\nBrief (1-2 page) description of the topic including a statement of the problem, proposed statistical method, and supplemental reference(s) is due Feb 09 (4% of course grade).\nData exploration report containing data summaries and visualizations of the dataset to be used in the project, including observations of implications of data structure for the analyses to be conducted. Due Feb 28. (10% of course grade).\nStudent project presentation with chapter assignment or supplemental reading on the statistical method used in the project. A 10-minute lecture on the method, and demonstration of the method using the project dataset. Presentations will be graded based on the instructors’ evaluation of accuracy, clarity, and comprehensiveness. Feedback from other students will also be considered in evaluation of presentations (20% of course grade).\nProject report (due Apr 25). A written description of the methods and results of the project in the form of a draft scientific manuscript (Introduction, Methods, Results, Discussion). (20% of course grade).\n\n\n\nMid-term examination on statistical concepts and literacy (20% of course grade). Take home exam. Exam distributed Feb 28. Due Mar 16.\nParticipation in class discussions (5% of course grade). Attendance at all lectures and labs is the best way to understand topics and assignments, but is not required for evaluation.\nComputer lab exercises (20% of course grade). Completion of short laboratory exercises using R. Lab exercises are due before lab session the following week. Individual weekly exercises will not be assigned numeric grades, assessment of the R lab component will take the form of i) completion of the exercises and ii) two self-reflection statements in the middle and at the end of the course asking students to assess their learning in R and ability to use these tools to address data-related and scientific questions. Additionally, the instructor and teaching assistant will provide general and specific feedback on R lab components and coding.\nExtra credit: An additional 1% towards the total course grade can be obtained by students contributing to the #TidyTuesday, a public weekly data project in R from the R4DS online learning community (https://github.com/rfordatascience/tidytuesday). To obtain course credit, students should send Gavin Fay and Lucy McGinnis an email containing a visualization of analysis of one Tidy Tuesday data set, and a link to a repository containing code that reproduces the analysis and visualization (sharing of work with the #RStats community via Twitter or Mastodon is encouraged but not required for course credit)."
  },
  {
    "objectID": "course-syllabus.html#class-policies",
    "href": "course-syllabus.html#class-policies",
    "title": "Syllabus",
    "section": "Class Policies",
    "text": "Class Policies\n\nGrades will be reduced for all unexcused late submissions of assignments, with a 10% reduction for each day after the deadline. Requests for extended deadlines will be considered up to one day before the deadline. Unexcused assignments submitted later than three days after the deadline will not be graded.\nFailure to complete any of the requirements for evaluation will result in a score of zero for missing components. At the student’s request, and no more than 48 hours after the final exam or class, an incomplete grade may be given only in exceptional circumstances at the discretion of the instructor. The student must be passing the course at the time of the request or be sufficiently close to passing that the instructor believes that upon completion of the work, the student will pass the course. If the work is not completed within one year of recording the I, the grade will become an F(I).\nThis 4-credit class involves four hours per week of in-class work and an average of eight hours per week of out-of-class work is expected.\nAssignment submissions should be made via a myCourses website. Students are responsible for all official correspondence sent to their umassd.edu e-mail address.\nThis course, including student participation, will be recorded on video by the instructor and will be available to students in the course for viewing remotely and after each session. As the Zoom recordings will contain student work, please do not share videos beyond the course attendees without the explicit permission of the instructor. Other course materials will be publicly available online.\nIf you have read this far, please use google search to find a picture or gif of an animal that best reflects your opinion of statistics, and send it to Gavin Fay attached to an email with the subject line “Here is a statistical opinion”, worth an extra 5 points on the midterm.\nUniversity policy on academic dishonesty, including plagiarism, applies (see: https://www.umassd.edu/studentaffairs/studenthandbook/academic-regulations-and-procedures/).\nAvailable academic support services are available at: www.umassd.edu/nfi/teaching-and-advising/course-syllabus/sample-disability-statement\nSMAST Code of Conduct and Diversity statement: https://www.umassd.edu/media/umassdartmouth/smast/lab-pdf-files/SMAST-Code-of-Conduct-and-Diversity-Statement.pdf\n\nA full description of Academic Policies associated with this and other UMass Dartmouth courses can be found at: https://www.umassd.edu/provost/resourcesforfaculty/syllabus-language/"
  },
  {
    "objectID": "course-syllabus.html#computing",
    "href": "course-syllabus.html#computing",
    "title": "Syllabus",
    "section": "Computing",
    "text": "Computing\n\nRequired Hardware:\nClass will take place in a SMAST-East classroom; individual laptop computers will be required to complete in-class and in-lab exercises and coursework. Pair programming approaches are encouraged during class sessions. Please contact the instructor if the computing requirement creates difficulty for your participation in the course; SMAST laptops may be able to be made available for in-class use. The university library also has laptops available for students to borrow.\n\n\nRequired Software:\nR (free download at http://r-project.org, students should also install Rstudio, an integrated development environment for R, free download at https://posit.co/download/rstudio-desktop/). I will walk through installation and use of this software during our first lab session. It is recommended to update your version of both R and RStudio for the course (I will be using R version 4.2.2). Web browser access to R sessions will also be provided through a cloud-based instance of RStudio via posit.cloud.\nWhile there is no official textbook for the course, we will be assigning readings from the following textbooks.\n\nR for Data Science by Garret Grolemund and Hadley Wickham\nIntroduction to Modern Statistics by Mine Çetinkaya-Rundel and Johanna Hardin\nTidy modeling with R by Max Kuhn and Julia Silge\nBeyond Multiple Linear Regression by Paul Roback and Julie Legler\n\n\n\nCourse Materials\nMaterials will be distributed through a dedicated course website and RStudio Cloud project. All lectures and labs will be recorded using Zoom."
  },
  {
    "objectID": "course-syllabus.html#remote-participation",
    "href": "course-syllabus.html#remote-participation",
    "title": "Syllabus",
    "section": "Remote participation",
    "text": "Remote participation\nTo facilitate off-campus attendance and engagement in the course, as well as ensuring the course is available and accessible, class sessions will be broadcast via Zoom in addition to in-person meetings."
  },
  {
    "objectID": "course-syllabus.html#textbooks",
    "href": "course-syllabus.html#textbooks",
    "title": "Syllabus",
    "section": "Textbooks",
    "text": "Textbooks\nI will draw from several sources. The primary text we will use is:\nZuur, A.F., Ieno, E.N. and Smith, G.M. (2007). Analysing Ecological Data. Springer. 700p. Series: Statistics for Biology and Health. (available free ebook available through the UMass Amherst library system, or hard copy ~$100 online).\nSupport website for book (http://highstat.com/index.php/analysing-ecological-data)\nThe form for students to request access to UMass Amherst ebook collection is available at: https://www.umass.edu/it/accounts/courtesy-accounts-non-employees-non-students-nens\n\nSupplementary Texts\n(all either available online or GF will provide access to appropriate sections):\nBolker, B.M. 2008. Ecological Models and Data in R. Princeton University Press. (http://ms.mcmaster.ca/~bolker/emdbook/index.html, http://emdbolker.wikidot.com/)\nIsmay, C. and Kim, A.Y., 2019. Statistical Inference via Data Science: A ModernDive into R and the Tidyverse. CRC Press.\nJames, G., Wittem, D., Hastie, T., and Tibshirani, R. (2014). An Introduction to Statistical Learning With Applications in R. Springer. (ebook available online)\nSupport website for book (http://www-bcf.usc.edu/\\~gareth/ISL/)\nMcElreath, R., 2018. Statistical rethinking: A Bayesian course with examples in R and Stan. Chapman and Hall/CRC.\nWickham, H. and Grolemund, G., 2016. R for data science. O’Reilly. (http://r4ds.had.co.nz/)"
  },
  {
    "objectID": "course-syllabus.html#title-ix-statement",
    "href": "course-syllabus.html#title-ix-statement",
    "title": "Syllabus",
    "section": "Title IX statement",
    "text": "Title IX statement\nThe purpose of a university is to disseminate information, as well as to explore a universe of ideas, to encourage diverse perspectives and robust expression, and to foster the development of critical and analytical thinking skills. In many classes, including this one, students and faculty examine and analyze challenging and controversial topics.\nIf a topic covered in this class triggers post-traumatic stress or other emotional distress, please discuss the matter with the professor or seek out confidential resources available from the Counseling Center, http://www.umassd.edu/counselling/, 508-999-8648 or -8650, or the Victim Advocate in the Center for Women, Gender and Sexuality, http://www.umassd.edu/sexualviolence/, 508-910-4584. In an emergency contact the Department of Public Safety at 508-999-9191 24 hrs./day.\nUMass Dartmouth, following national guidance from the Office of Civil Rights, requires that faculty follow UMass Dartmouth policy as a “mandated reporter” of any disclosure of sexual harassment, abuse, and/or violence shared with the faculty member in person and/or via email. These disclosures include but are not limited to reports of sexual assault, relational abuse, relational/domestic violence, and stalking. While faculty are often able to help students locate appropriate channels of assistance on campus, disclosure by the student to the faculty member requires that the faculty member inform the University’s Title IX Coordinator in the Office of Diversity, Equity and Inclusion at 508-999-8008 to help ensure that the student’s safety and welfare is being addressed, even if the student requests that the disclosure not be shared.\nFor confidential counseling support and assistance, please go to http://www.umassd.edu/sexualviolence/"
  },
  {
    "objectID": "course-syllabus.html#important-dates",
    "href": "course-syllabus.html#important-dates",
    "title": "Syllabus",
    "section": "Important dates",
    "text": "Important dates\n\nJanuary 17: Classes begin\nJanuary 24: Drop/add ends\nMarch 6-10: Spring break, no classes are held\n\nClick here for the full UMass Dartmouth academic calendar."
  },
  {
    "objectID": "class-data.html",
    "href": "class-data.html",
    "title": "Course Data Sets",
    "section": "",
    "text": "A folder with all our class data sets from labs and lecture examples can be found here."
  }
]