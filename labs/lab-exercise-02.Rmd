---
output:
  pdf_document:
    highlight: default
    toc: no
  geometry: margin=1in
  html_document:
    toc: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
```

#### MAR536: Biological Statistics II

## R Laboratory Exercise 2

January 25, 2023

Open a new R markdown file. Save it. (name it lastname_lab2.Rmd or something similar)\
At the top of the script, add comments with your name and lab 2.
Work in pairs or individually. Submit your Rmd and any other files via myCourses before lab next week.

## Lab exercise 1/3  (Laengelmavesi + penguins) {.smaller}

Read in the data in the 'data' sheet of `Laengelmavesi2.xlsx` and:  

1. Display the number of observations for each species of fish. 
(_hint: the function `count()` will tell you how many rows_)    
2. Find the overall mean lengths, weights, and heights of fish in the data.  
3. Find the range of the lengths of Perch.  
4. Calculate the mean length for each species.  
5. _bonus_ With the Pike data, create a new factor for small and large based on the weights.   
6. Use the `ggpairs()` function in `library(GGally)` to create a pairs plot for the palmer penguins data. What are five things you learn about the data and the penguins from this view of the data? 


```{=html}
<!-- -->
```
## Lab exercise 2/3: Gapminder data

1. Use the `gapminder` data to replicate as close as possible this graph. (Try out different 'themes' with `+ theme_XXXX()`)  

```{r prompt=TRUE,comment='',collapse=TRUE,echo=FALSE,out.width="80%"}
library(gapminder)
gapdata <- gapminder %>% 
  filter(year >= 1990 & year <= 2007) %>% 
  group_by(continent)
ggplot(gapdata, aes(x = gdpPercap/1000,
                    y = lifeExp,
                    size = pop/1000000,
                    color = continent)) +
  geom_point(alpha = 0.5) +
  labs(title = "Life Expectancy varies with GDP",
         subtitle = "1990 - 2007",
          x = "GDP per capita ($1000s)",
          y = "Life expectancy (yrs)",
         caption = "Plot created by 'your name here'",
       fill = "Population (m)",
       color = "Continent") +
  theme_minimal() 
  #scale_color_gradient() +
  #facet_wrap(~continent)

```

2. _bonus_ plot time series of life expectancy by continent and country. (You can use `geom_line()` to link points)

------------------------------------------------------------------------

## Lab exercise 3/3  (Laengelmavesi revisited)

Use the data in `Laengelmavesi2.xlsx` to create the following graphs. Make sure to add axis labels and plot titles.    

1. Create boxplots and histograms of the length distributions for each species.  
2. Plot all the weights vs the lengths. Include enough information that the data for each species can be identified.  
3. Plot the mean weight of each species as a function of the mean length, with the species names and mean heights also indicated on the plot.  
4. Create one plot of the heights as a function of the lengths. Add a line separating fish with height greater than 20cm.  
5. _bonus_ Add to your plot from step (2) the mean weight and length  for each species.
